<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Platform</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        :root {
            --primary: #7c3aed;
            --secondary: #8b5cf6;
            --accent: #10b981;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
            --text: #ffffff;
            --bg: #0f172a;
            --card: #1e293b;
            --border: #334155;
            --sidebar: #111827;
        }

        [data-theme="light"] {
            --primary: #6366f1;
            --secondary: #4f46e5;
            --accent: #0ea5e9;
            --text: #1e293b;
            --bg: #f8fafc;
            --card: #ffffff;
            --border: #e2e8f0;
            --sidebar: #f1f5f9;
        }

        [data-theme="purple"] {
            --primary: #8b5cf6;
            --secondary: #7c3aed;
            --accent: #a78bfa;
            --text: #f8fafc;
            --bg: #1e1b4b;
            --card: #312e81;
            --border: #4f46e5;
            --sidebar: #2e1065;
        }

        body {
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* –°–Ω–µ–∂–∏–Ω–∫–∏ */
        .snowflake {
            position: fixed;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            animation: fall linear infinite;
            filter: blur(1px);
            opacity: 0.8;
        }

        @keyframes fall {
            0% {
                transform: translateY(-10px) rotate(0deg);
                opacity: 0.8;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* –õ–æ–≥–∏–Ω —ç–∫—Ä–∞–Ω */
        .login-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }

        .login-container {
            background: var(--card);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 500px;
            width: 100%;
            border: 2px solid var(--border);
        }

        .user-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            margin: 10px;
            border-radius: 12px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 180px;
            font-weight: 600;
        }

        .user-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .user-btn.selected {
            background: var(--accent);
            box-shadow: 0 0 0 3px var(--accent);
        }

        .user-btn.occupied {
            background: var(--danger);
            opacity: 0.7;
        }

        .login-btn {
            background: linear-gradient(135deg, var(--success) 0%, var(--accent) 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            margin-top: 30px;
            border-radius: 12px;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(34, 197, 94, 0.4);
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å */
        .main-app {
            display: none;
            min-height: 100vh;
        }

        .header {
            background: var(--card);
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: white;
        }

        .balance {
            background: var(--accent);
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: bold;
            color: white;
        }

        /* –ù–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ */
        .notifications {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
            max-width: 300px;
        }

        .notification {
            background: var(--card);
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            animation: slideIn 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notification-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .notification-btn {
            padding: 5px 15px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
        }

        .notification-btn.accept {
            background: var(--success);
            color: white;
        }

        .notification-btn.decline {
            background: var(--danger);
            color: white;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 15px 20px;
            background: var(--sidebar);
        }

        .tab {
            background: var(--card);
            border: none;
            color: var(--text);
            padding: 14px 28px;
            border-radius: 12px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tab:hover {
            background: var(--primary);
            transform: translateY(-2px);
        }

        .tab.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4);
        }

        .page {
            display: none;
            padding: 25px;
            min-height: calc(100vh - 160px);
        }

        .page.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –û–±–ª–∞–∫–æ */
        .cloud-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 25px;
        }

        .file {
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 25px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .file:hover {
            border-color: var(--primary);
            transform: translateY(-8px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        }

        .file-icon {
            font-size: 48px;
            margin-bottom: 15px;
            text-align: center;
        }

        .file-name {
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 18px;
            text-align: center;
        }

        .file-size {
            opacity: 0.7;
            font-size: 14px;
            text-align: center;
        }

        .delete-file {
            position: absolute;
            top: 12px;
            right: 12px;
            background: var(--danger);
            color: white;
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* –ò–≥—Ä—ã */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
        }

        .game-card {
            background: var(--card);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .game-card:hover {
            border-color: var(--primary);
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        .game-icon {
            font-size: 56px;
            margin-bottom: 20px;
        }

        .game-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .game-desc {
            opacity: 0.8;
            margin-top: 10px;
            font-size: 15px;
            line-height: 1.5;
        }

        /* –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ */
        .translator-container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .lang-selector {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .lang-box {
            flex: 1;
            min-width: 250px;
        }

        select {
            width: 100%;
            background: var(--bg);
            border: 2px solid var(--border);
            color: var(--text);
            padding: 15px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .swap-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s ease;
            min-width: 50px;
        }

        .swap-btn:hover {
            background: var(--secondary);
            transform: rotate(180deg);
        }

        .voice-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .voice-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .voice-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(124, 58, 237, 0.3);
        }

        .translation-box {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .translation-box {
                grid-template-columns: 1fr;
            }
        }

        textarea {
            width: 100%;
            min-height: 180px;
            background: var(--bg);
            border: 2px solid var(--border);
            color: var(--text);
            padding: 20px;
            border-radius: 15px;
            font-size: 16px;
            resize: vertical;
            line-height: 1.6;
        }

        /* –ß–∞—Å—ã –º–∏—Ä–∞ */
        .clocks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
        }

        .clock {
            background: var(--card);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }

        .clock:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .clock-city {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--accent);
        }

        .clock-time {
            font-size: 40px;
            font-weight: 700;
            margin-bottom: 10px;
            font-family: 'Courier New', monospace;
        }

        .clock-date {
            opacity: 0.8;
            font-size: 16px;
        }

        /* –ß–∞—Ç */
        .chat-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 25px;
            height: 650px;
        }

        @media (max-width: 1024px) {
            .chat-container {
                grid-template-columns: 1fr;
                height: auto;
            }
        }

        .chat-users {
            background: var(--card);
            border-radius: 20px;
            padding: 25px;
            overflow-y: auto;
            border: 2px solid var(--border);
        }

        .chat-user {
            background: var(--bg);
            padding: 18px;
            border-radius: 12px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chat-user:hover {
            background: var(--primary);
            transform: translateX(5px);
        }

        .chat-user.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border: 2px solid var(--accent);
            color: white;
        }

        .chat-messages {
            background: var(--card);
            border-radius: 20px;
            padding: 25px;
            display: flex;
            flex-direction: column;
            border: 2px solid var(--border);
        }

        .messages-list {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 25px;
            padding-right: 15px;
        }

        .message {
            background: var(--bg);
            padding: 18px;
            border-radius: 18px;
            margin-bottom: 18px;
            max-width: 75%;
            word-wrap: break-word;
        }

        .message.sent {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            margin-left: auto;
            color: white;
        }

        .chat-input {
            display: flex;
            gap: 15px;
        }

        .chat-input input {
            flex: 1;
            background: var(--bg);
            border: 2px solid var(--border);
            color: var(--text);
            padding: 18px;
            border-radius: 15px;
            font-size: 16px;
        }

        .chat-send {
            background: linear-gradient(135deg, var(--success) 0%, var(--accent) 100%);
            color: white;
            border: none;
            width: 60px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s ease;
        }

        .chat-send:hover {
            transform: scale(1.05);
        }

        /* –ö–∞—Ä—Ç—ã */
        .map-container {
            height: 600px;
            background: var(--card);
            border-radius: 20px;
            overflow: hidden;
            border: 2px solid var(--border);
            position: relative;
        }

        .map-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 10;
        }

        .map-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .map-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--card);
            border-radius: 25px;
            padding: 35px;
            max-width: 900px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid var(--border);
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .close-btn {
            background: var(--danger);
            color: white;
            border: none;
            width: 42px;
            height: 42px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            transform: rotate(90deg);
        }

        /* Talking Tom 2 - –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è */
        .tom-game {
            text-align: center;
        }

        .tom-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .tom-pet {
            width: 250px;
            height: 250px;
            background: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
            border-radius: 50%;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .tom-pet:hover {
            transform: scale(1.08);
            box-shadow: 0 15px 35px rgba(76, 201, 240, 0.3);
        }

        .tom-eye {
            position: absolute;
            width: 30px;
            height: 40px;
            background: white;
            border-radius: 50%;
            top: 80px;
        }

        .tom-eye.left {
            left: 70px;
        }

        .tom-eye.right {
            right: 70px;
        }

        .tom-mouth {
            position: absolute;
            width: 60px;
            height: 30px;
            background: #ff6b6b;
            border-radius: 50%;
            bottom: 70px;
        }

        .tom-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 40px 0;
        }

        .tom-stat {
            background: var(--bg);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid var(--border);
        }

        .tom-stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-top: 10px;
            color: var(--accent);
        }

        /* –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å Tom */
        .tom-inventory {
            margin-top: 40px;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .inventory-item {
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .inventory-item:hover {
            border-color: var(--primary);
            transform: scale(1.05);
        }

        /* –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ */
        .tic-tac-toe-game {
            text-align: center;
        }

        .tic-modes {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px 0;
        }

        .mode-btn {
            background: var(--bg);
            border: 2px solid var(--border);
            color: var(--text);
            padding: 15px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .mode-btn:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
        }

        .mode-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .tic-board {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 10px;
            margin: 30px auto;
            width: fit-content;
        }

        .tic-cell {
            background: var(--bg);
            border: 3px solid var(--border);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 56px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tic-cell:hover {
            background: var(--primary);
            border-color: var(--accent);
            transform: scale(1.05);
        }

        .tic-cell.x {
            color: #ef4444;
        }

        .tic-cell.o {
            color: #3b82f6;
        }

        /* –ö–ª–∏–∫–µ—Ä - –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω */
        .clicker-game {
            text-align: center;
        }

        .clicker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background: var(--bg);
            padding: 20px;
            border-radius: 15px;
        }

        .clicker-stats {
            display: flex;
            gap: 30px;
        }

        .stat-box {
            text-align: center;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--accent);
        }

        .clicker-main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 40px 0;
        }

        @media (max-width: 768px) {
            .clicker-main {
                grid-template-columns: 1fr;
            }
        }

        .clicker-button {
            background: linear-gradient(135deg, var(--warning) 0%, #f59e0b 100%);
            border: none;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            font-size: 32px;
            font-weight: 800;
            color: white;
            cursor: pointer;
            transition: all 0.1s ease;
            box-shadow: 0 20px 40px rgba(245, 158, 11, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }

        .clicker-button:active {
            transform: scale(0.95);
            box-shadow: 0 10px 20px rgba(245, 158, 11, 0.4);
        }

        .upgrades-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .upgrade-card {
            background: var(--bg);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .upgrade-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .upgrade-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }

        .upgrade-icon {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .upgrade-price {
            color: var(--success);
            font-weight: 700;
            font-size: 18px;
            margin-top: 15px;
        }

        /* –ú–∞–≥–∞–∑–∏–Ω –∫–ª–∏–∫–µ—Ä–∞ */
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .shop-item {
            background: var(--bg);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .shop-item:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .shop-item-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .egg-animation {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* CS 1.6 —Å—Ç–∏–ª—å */
        .cs-game {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 3000;
        }

        #cs-canvas {
            width: 100%;
            height: 100%;
        }

        .cs-hud {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
            color: white;
            font-family: 'Arial', sans-serif;
        }

        .cs-hud-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            font-weight: bold;
        }

        .cs-weapons {
            position: absolute;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
        }

        .cs-weapon {
            background: rgba(0,0,0,0.7);
            border: 2px solid #666;
            padding: 10px 20px;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cs-weapon:hover, .cs-weapon.active {
            border-color: #4cc9f0;
            background: rgba(76, 201, 240, 0.2);
        }

        .cs-exit {
            position: absolute;
            bottom: 30px;
            right: 30px;
            background: rgba(239, 68, 68, 0.8);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
        }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .setting-card {
            background: var(--bg);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--border);
        }

        .theme-selector {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .theme-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            color: white;
            font-weight: 600;
            min-width: 120px;
            transition: all 0.3s ease;
        }

        .theme-btn:hover {
            transform: translateY(-3px);
        }

        .theme-dark {
            background: #0f172a;
        }

        .theme-light {
            background: #f8fafc;
            color: #0f172a;
        }

        .theme-purple {
            background: #1e1b4b;
        }

        .theme-btn.active {
            box-shadow: 0 0 0 3px var(--accent);
        }

        .toggle-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--card);
            border-radius: 12px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #334155;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* –ß–∞—Ç-–±–æ—Ç */
        .chat-bot {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .chat-bot-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(124, 58, 237, 0.4);
            transition: all 0.3s ease;
        }

        .chat-bot-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 30px rgba(124, 58, 237, 0.6);
        }

        .chat-bot-modal {
            display: none;
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 350px;
            max-height: 500px;
            background: var(--card);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            z-index: 1001;
            border: 2px solid var(--border);
            overflow: hidden;
        }

        .chat-bot-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            padding: 20px;
            color: white;
            font-weight: 700;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-bot-messages {
            height: 350px;
            overflow-y: auto;
            padding: 20px;
        }

        .bot-message {
            background: var(--bg);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 15px;
            max-width: 80%;
        }

        .bot-message.user {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            margin-left: auto;
        }

        .chat-bot-input {
            display: flex;
            padding: 20px;
            border-top: 2px solid var(--border);
        }

        .chat-bot-input input {
            flex: 1;
            background: var(--bg);
            border: 2px solid var(--border);
            color: var(--text);
            padding: 15px;
            border-radius: 12px;
            font-size: 16px;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }
            
            .nav {
                padding: 10px;
                overflow-x: scroll;
            }
            
            .tab {
                padding: 12px 20px;
                font-size: 14px;
            }
            
            .chat-container {
                grid-template-columns: 1fr;
                height: auto;
            }
            
            .tom-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .clocks-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .clocks-grid {
                grid-template-columns: 1fr;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .tom-stats {
                grid-template-columns: 1fr;
            }
            
            .tic-board {
                grid-template-columns: repeat(3, 80px);
                grid-template-rows: repeat(3, 80px);
            }
            
            .chat-bot-modal {
                width: 90%;
                right: 5%;
                bottom: 80px;
            }
        }
    </style>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –ª–æ–≥–∏–Ω–∞ -->
    <div class="login-screen">
        <div class="login-container">
            <h1 style="font-size: 36px; margin-bottom: 30px; color: white; font-weight: 800;">üéÆ Game Platform</h1>
            <p style="margin-bottom: 40px; opacity: 0.9; color: white; font-size: 18px;">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –≤—Ö–æ–¥–∞</p>
            
            <div id="user-list" style="display: flex; flex-wrap: wrap; justify-content: center; margin: 30px 0; gap: 15px;">
                <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
            
            <button class="login-btn" onclick="login()">
                <span style="margin-right: 10px;">üöÄ</span> –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
            </button>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div class="main-app">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <div class="user-info">
                <div class="user-avatar" id="current-avatar">N</div>
                <div>
                    <div style="font-weight: 800; font-size: 20px;" id="current-username">–ù–∏–∫–∏—Ç–∞</div>
                    <div class="balance" id="balance">$1000</div>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px;">
                <button class="voice-btn" onclick="openSettings()" style="background: var(--warning);">
                    <span style="margin-right: 8px;">‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
                <button class="voice-btn" onclick="exitApp()" style="background: var(--danger);">
                    <span style="margin-right: 8px;">üö™</span> –í—ã—Ö–æ–¥
                </button>
            </div>
        </div>
        
        <!-- –ù–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
        <div class="notifications" id="notifications"></div>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="nav">
            <button class="tab active" data-page="cloud">
                <span>‚òÅÔ∏è</span> –û–±–ª–∞–∫–æ
            </button>
            <button class="tab" data-page="games">
                <span>üéÆ</span> –ò–≥—Ä—ã
            </button>
            <button class="tab" data-page="translator">
                <span>üî§</span> –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫
            </button>
            <button class="tab" data-page="clocks">
                <span>üïê</span> –ß–∞—Å—ã –º–∏—Ä–∞
            </button>
            <button class="tab" data-page="chat">
                <span>üí¨</span> –ß–∞—Ç
            </button>
            <button class="tab" data-page="maps">
                <span>üó∫Ô∏è</span> –ö–∞—Ä—Ç—ã
            </button>
        </nav>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
        <main>
            <!-- –û–±–ª–∞–∫–æ -->
            <section id="cloud" class="page active">
                <div class="cloud-header">
                    <h2 style="font-size: 32px; font-weight: 800;">‚òÅÔ∏è –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ</h2>
                    <button class="voice-btn" onclick="addFile()">
                        <span style="margin-right: 10px;">+</span> –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª
                    </button>
                </div>
                <div class="files-grid" id="files-grid">
                    <!-- –§–∞–π–ª—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </section>
            
            <!-- –ò–≥—Ä—ã -->
            <section id="games" class="page">
                <h2 style="font-size: 32px; margin-bottom: 30px; font-weight: 800;">üéÆ –ò–≥—Ä—ã</h2>
                <div class="games-grid">
                    <div class="game-card" onclick="startCS()">
                        <div class="game-icon">üî´</div>
                        <div class="game-title">Counter-Strike 1.6</div>
                        <div class="game-desc">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —à—É—Ç–µ—Ä —Å –±–æ—Ç–∞–º–∏ –∏ –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–æ–º</div>
                    </div>
                    
                    <div class="game-card" onclick="startTalkingTom()">
                        <div class="game-icon">üò∫</div>
                        <div class="game-title">My Talking Tom 2</div>
                        <div class="game-desc">–ó–∞–±–æ—Ç—å—Å—è –æ –ø–∏—Ç–æ–º—Ü–µ, –∫–µ–π—Å—ã, –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
                    </div>
                    
                    <div class="game-card" onclick="startTicTacToe()">
                        <div class="game-icon">‚ùå‚≠ï</div>
                        <div class="game-title">–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</div>
                        <div class="game-desc">–ò–≥—Ä–∞–π —Å –±–æ—Ç–æ–º –∏–ª–∏ –≤—ã–∑—ã–≤–∞–π –¥—Ä—É–∑–µ–π –Ω–∞ –¥—É—ç–ª—å</div>
                    </div>
                    
                    <div class="game-card" onclick="startClicker()">
                        <div class="game-icon">üí∞</div>
                        <div class="game-title">–ö–ª–∏–∫–µ—Ä Pro</div>
                        <div class="game-desc">–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π, –ø–æ–∫—É–ø–∞–π —è–π—Ü–∞, –≤—ã—Ä–∞—â–∏–≤–∞–π –ø–∏—Ç–æ–º—Ü–µ–≤</div>
                    </div>
                </div>
            </section>
            
            <!-- –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ -->
            <section id="translator" class="page">
                <div class="translator-container">
                    <h2 style="font-size: 32px; margin-bottom: 35px; font-weight: 800; text-align: center;">üî§ –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫</h2>
                    
                    <div class="lang-selector">
                        <div class="lang-box">
                            <select id="lang-from">
                                <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                                <option value="en">üá∫üá∏ –ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                                <option value="es">üá™üá∏ –ò—Å–ø–∞–Ω—Å–∫–∏–π</option>
                                <option value="de">üá©üá™ –ù–µ–º–µ—Ü–∫–∏–π</option>
                                <option value="fr">üá´üá∑ –§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π</option>
                                <option value="zh">üá®üá≥ –ö–∏—Ç–∞–π—Å–∫–∏–π</option>
                                <option value="ja">üáØüáµ –Ø–ø–æ–Ω—Å–∫–∏–π</option>
                                <option value="ko">üá∞üá∑ –ö–æ—Ä–µ–π—Å–∫–∏–π</option>
                                <option value="ar">üá∏üá¶ –ê—Ä–∞–±—Å–∫–∏–π</option>
                            </select>
                        </div>
                        
                        <button class="swap-btn" onclick="swapLanguages()">‚áÑ</button>
                        
                        <div class="lang-box">
                            <select id="lang-to">
                                <option value="en">üá∫üá∏ –ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                                <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                                <option value="es">üá™üá∏ –ò—Å–ø–∞–Ω—Å–∫–∏–π</option>
                                <option value="de">üá©üá™ –ù–µ–º–µ—Ü–∫–∏–π</option>
                                <option value="fr">üá´üá∑ –§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π</option>
                                <option value="zh">üá®üá≥ –ö–∏—Ç–∞–π—Å–∫–∏–π</option>
                                <option value="ja">üáØüáµ –Ø–ø–æ–Ω—Å–∫–∏–π</option>
                                <option value="ko">üá∞üá∑ –ö–æ—Ä–µ–π—Å–∫–∏–π</option>
                                <option value="ar">üá∏üá¶ –ê—Ä–∞–±—Å–∫–∏–π</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="voice-controls">
                        <button class="voice-btn" onclick="startVoiceInput()">
                            <span>üé§</span> –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥
                        </button>
                        <button class="voice-btn" onclick="speakTranslation()">
                            <span>üîä</span> –û–∑–≤—É—á–∏—Ç—å
                        </button>
                        <button class="voice-btn" onclick="clearTranslation()" style="background: var(--danger);">
                            <span>üóëÔ∏è</span> –û—á–∏—Å—Ç–∏—Ç—å
                        </button>
                    </div>
                    
                    <div class="translation-box">
                        <div>
                            <h3 style="margin-bottom: 15px; font-weight: 700;">–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç</h3>
                            <textarea id="input-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞..." oninput="translateText()"></textarea>
                            <div style="margin-top: 10px; opacity: 0.7; font-size: 14px;">
                                <span id="char-count">0</span> —Å–∏–º–≤–æ–ª–æ–≤
                            </div>
                        </div>
                        
                        <div>
                            <h3 style="margin-bottom: 15px; font-weight: 700;">–ü–µ—Ä–µ–≤–æ–¥</h3>
                            <textarea id="output-text" placeholder="–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–≤–æ–¥–∞..." readonly></textarea>
                            <div style="margin-top: 10px; display: flex; gap: 10px;">
                                <button class="voice-btn" onclick="copyTranslation()" style="padding: 8px 15px; font-size: 14px;">
                                    üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- –ß–∞—Å—ã –º–∏—Ä–∞ -->
            <section id="clocks" class="page">
                <h2 style="font-size: 32px; margin-bottom: 30px; font-weight: 800;">üïê –ß–∞—Å—ã –º–∏—Ä–∞</h2>
                <div class="clocks-grid" id="clocks-grid">
                    <!-- –ß–∞—Å—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </section>
            
            <!-- –ß–∞—Ç -->
            <section id="chat" class="page">
                <div class="chat-container">
                    <div class="chat-users">
                        <h3 style="margin-bottom: 20px; font-size: 22px; font-weight: 800;">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                        <div class="chat-list" id="chat-users">
                            <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        </div>
                        <div style="opacity: 0.7; font-size: 14px; text-align: center; margin-top: 25px; padding: 15px; background: var(--bg); border-radius: 10px;">
                            üí° –î–ª—è –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ö—Ä–∞—Å–Ω—ã–µ - –æ—Ñ–ª–∞–π–Ω, –∑–µ–ª–µ–Ω—ã–µ - –æ–Ω–ª–∞–π–Ω.
                        </div>
                    </div>
                    
                    <div class="chat-messages">
                        <h3 id="chat-title" style="margin-bottom: 25px; font-size: 24px; font-weight: 800;">üí¨ –û–±—â–∏–π —á–∞—Ç</h3>
                        <div class="messages-list" id="messages-list">
                            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        </div>
                        <div class="chat-input">
                            <input type="text" id="chat-message" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ... (Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏)">
                            <button class="chat-send" onclick="sendMessage()">‚û§</button>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- –ö–∞—Ä—Ç—ã -->
            <section id="maps" class="page">
                <h2 style="font-size: 32px; margin-bottom: 30px; font-weight: 800;">üó∫Ô∏è –ö–∞—Ä—Ç—ã</h2>
                <div class="map-container" id="map-container">
                    <!-- –ö–∞—Ä—Ç–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ JS -->
                </div>
            </section>
        </main>
    </div>

    <!-- –ß–∞—Ç-–±–æ—Ç -->
    <div class="chat-bot">
        <button class="chat-bot-btn" onclick="toggleChatBot()">ü§ñ</button>
        <div class="chat-bot-modal" id="chat-bot-modal">
            <div class="chat-bot-header">
                <span>ü§ñ –ü–æ–º–æ—â–Ω–∏–∫</span>
                <button class="close-btn" onclick="toggleChatBot()" style="width: 30px; height: 30px; font-size: 18px;">√ó</button>
            </div>
            <div class="chat-bot-messages" id="chat-bot-messages">
                <div class="bot-message">
                    <div style="font-weight: 700; margin-bottom: 5px;">ü§ñ –ü–æ–º–æ—â–Ω–∏–∫:</div>
                    <div>–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –ø–æ–º–æ—â–Ω–∏–∫. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?</div>
                </div>
            </div>
            <div class="chat-bot-input">
                <input type="text" id="bot-input" placeholder="–°–ø—Ä–æ—Å–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å..." onkeypress="if(event.key === 'Enter') sendBotMessage()">
                <button class="chat-send" onclick="sendBotMessage()" style="width: 50px; margin-left: 10px;">‚û§</button>
            </div>
        </div>
    </div>

    <!-- CS 1.6 -->
    <div class="cs-game" id="cs-game">
        <canvas id="cs-canvas"></canvas>
        <div class="cs-hud">
            <div class="cs-hud-item">
                <span>‚ù§Ô∏è</span>
                <span id="cs-health">100</span>
            </div>
            <div class="cs-hud-item">
                <span>üí∞</span>
                <span id="cs-money">$800</span>
            </div>
            <div class="cs-hud-item">
                <span>üéØ</span>
                <span id="cs-kills">0 —É–±–∏–π—Å—Ç–≤</span>
            </div>
            <div class="cs-hud-item">
                <span>üî´</span>
                <span id="cs-ammo">30/90</span>
            </div>
        </div>
        <div class="cs-weapons">
            <button class="cs-weapon" onclick="selectWeapon('ak47')">üî´ AK-47</button>
            <button class="cs-weapon" onclick="selectWeapon('awp')">üéØ AWP</button>
            <button class="cs-weapon" onclick="selectWeapon('m4a1')">üî´ M4A1</button>
            <button class="cs-weapon" onclick="selectWeapon('deagle')">üî´ Deagle</button>
        </div>
        <button class="cs-exit" onclick="exitCS()">üö™ –í—ã—Ö–æ–¥</button>
    </div>

    <!-- My Talking Tom 2 -->
    <div id="talking-tom-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 28px; font-weight: 800;">üò∫ My Talking Tom 2</h2>
                <button class="close-btn" onclick="closeModal('talking-tom-modal')">√ó</button>
            </div>
            
            <div class="tom-game">
                <div class="tom-container">
                    <div class="tom-pet" onclick="petTom()" id="tom-pet">
                        <div class="tom-eye left"></div>
                        <div class="tom-eye right"></div>
                        <div class="tom-mouth"></div>
                    </div>
                </div>
                
                <div class="tom-stats">
                    <div class="tom-stat">
                        <div style="font-weight: 700;">üòä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</div>
                        <div class="tom-stat-value" id="tom-happiness">100%</div>
                    </div>
                    <div class="tom-stat">
                        <div style="font-weight: 700;">üçñ –ì–æ–ª–æ–¥</div>
                        <div class="tom-stat-value" id="tom-hunger">100%</div>
                    </div>
                    <div class="tom-stat">
                        <div style="font-weight: 700;">üí∞ –î–µ–Ω—å–≥–∏</div>
                        <div class="tom-stat-value" id="tom-money">$100</div>
                    </div>
                    <div class="tom-stat">
                        <div style="font-weight: 700;">üéÅ –ö–µ–π—Å—ã</div>
                        <div class="tom-stat-value" id="tom-cases">0</div>
                    </div>
                </div>
                
                <div style="margin: 30px 0; display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                    <button class="voice-btn" onclick="feedTom()">
                        <span style="margin-right: 8px;">üçñ</span> –ü–æ–∫–æ—Ä–º–∏—Ç—å ($10)
                    </button>
                    <button class="voice-btn" onclick="playWithTom()" style="background: var(--secondary);">
                        <span style="margin-right: 8px;">üéÆ</span> –ü–æ–∏–≥—Ä–∞—Ç—å
                    </button>
                    <button class="voice-btn" onclick="buyTomCase()" style="background: var(--accent);">
                        <span style="margin-right: 8px;">üéÅ</span> –ö—É–ø–∏—Ç—å –∫–µ–π—Å ($50)
                    </button>
                    <button class="voice-btn" onclick="openTomCase()" style="background: var(--warning);">
                        <span style="margin-right: 8px;">üéØ</span> –û—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å
                    </button>
                </div>
                
                <div class="tom-inventory">
                    <h3 style="margin-bottom: 20px; font-size: 22px; font-weight: 700;">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h3>
                    <div class="inventory-grid" id="tom-inventory">
                        <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ -->
    <div id="tic-tac-toe-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 28px; font-weight: 800;">‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h2>
                <button class="close-btn" onclick="closeModal('tic-tac-toe-modal')">√ó</button>
            </div>
            
            <div class="tic-tac-toe-game">
                <div class="tic-modes">
                    <button class="mode-btn active" onclick="setTicMode('bot')">ü§ñ –ü—Ä–æ—Ç–∏–≤ –±–æ—Ç–∞</button>
                    <button class="mode-btn" onclick="setTicMode('friend')">üë• –í—ã–∑–≤–∞—Ç—å –¥—Ä—É–≥–∞</button>
                </div>
                
                <div id="friend-selector" style="display: none; margin: 20px 0; text-align: center;">
                    <select id="friend-select" style="background: var(--card); border: 2px solid var(--primary); color: var(--text); padding: 10px; border-radius: 10px; width: 250px; font-size: 16px;">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–∞</option>
                        <!-- –î—Ä—É–∑—å—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                    </select>
                    <button class="voice-btn" onclick="challengeFriend()" style="margin-left: 15px; padding: 10px 20px;">üéØ –í—ã–∑–≤–∞—Ç—å –Ω–∞ –¥—É—ç–ª—å</button>
                </div>
                
                <div style="text-align: center; margin: 20px 0;">
                    <div id="tic-player" style="font-size: 20px; font-weight: 700; margin-bottom: 10px;">–ò–≥—Ä–æ–∫: –ù–∏–∫–∏—Ç–∞ (‚ùå)</div>
                    <div id="tic-opponent" style="opacity: 0.8;">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫: –ë–æ—Ç (‚≠ï)</div>
                </div>
                
                <div class="tic-board" id="tic-board"></div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <div id="tic-status" style="margin-bottom: 20px; font-size: 22px; font-weight: 700; color: var(--accent);">–•–æ–¥: ‚ùå</div>
                    <div style="display: flex; justify-content: center; gap: 15px;">
                        <button class="voice-btn" onclick="resetTicTacToe()">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                        <button class="voice-btn" onclick="closeModal('tic-tac-toe-modal')" style="background: var(--danger);">üö™ –í—ã–π—Ç–∏</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö–ª–∏–∫–µ—Ä Pro -->
    <div id="clicker-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 28px; font-weight: 800;">üí∞ –ö–ª–∏–∫–µ—Ä Pro</h2>
                <button class="close-btn" onclick="closeModal('clicker-modal')">√ó</button>
            </div>
            
            <div class="clicker-game">
                <div class="clicker-header">
                    <div>
                        <div style="font-size: 14px; opacity: 0.8;">–ë–∞–ª–∞–Ω—Å</div>
                        <div class="stat-value" id="clicker-money">$0</div>
                    </div>
                    <div class="clicker-stats">
                        <div class="stat-box">
                            <div style="font-size: 14px; opacity: 0.8;">–ö–ª–∏–∫</div>
                            <div class="stat-value" id="clicker-per-click">$1</div>
                        </div>
                        <div class="stat-box">
                            <div style="font-size: 14px; opacity: 0.8;">–ê–≤—Ç–æ</div>
                            <div class="stat-value" id="clicker-auto">$0/—Å–µ–∫</div>
                        </div>
                        <div class="stat-box">
                            <div style="font-size: 14px; opacity: 0.8;">–ú–Ω–æ–∂–∏—Ç–µ–ª—å</div>
                            <div class="stat-value" id="clicker-multiplier">1.0x</div>
                        </div>
                    </div>
                </div>
                
                <div class="clicker-main">
                    <div style="text-align: center;">
                        <h3 style="margin-bottom: 20px; font-size: 22px;">–ö–ª–∏–∫–∞–π!</h3>
                        <button class="clicker-button" onclick="clickMoney()" id="clicker-button">
                            –ö–õ–ò–ö!
                        </button>
                        <div style="margin-top: 20px; opacity: 0.8;">–ù–∞–∂–º–∏ –¥–ª—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–Ω–µ–≥</div>
                    </div>
                    
                    <div>
                        <h3 style="margin-bottom: 20px; font-size: 22px;">–ë—É—Å—Ç</h3>
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            <button class="voice-btn" onclick="activateBoost('2x')" style="background: linear-gradient(135deg, #f59e0b 0%, #f97316 100%);">
                                <span>‚ö°</span> 2x –Ω–∞ 30 —Å–µ–∫ ($500)
                            </button>
                            <button class="voice-btn" onclick="activateBoost('5x')" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
                                <span>üöÄ</span> 5x –Ω–∞ 20 —Å–µ–∫ ($2000)
                            </button>
                            <button class="voice-btn" onclick="activateBoost('10x')" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                                <span>üí•</span> 10x –Ω–∞ 10 —Å–µ–∫ ($5000)
                            </button>
                        </div>
                    </div>
                </div>
                
                <div style="margin: 40px 0;">
                    <h3 style="margin-bottom: 25px; font-size: 24px; text-align: center;">–£–ª—É—á—à–µ–Ω–∏—è</h3>
                    <div class="upgrades-grid">
                        <div class="upgrade-card" onclick="buyUpgrade('click')">
                            <div class="upgrade-icon">üí™</div>
                            <div style="font-weight: 700; margin-bottom: 10px; font-size: 18px;">–°–∏–ª–∞ –∫–ª–∏–∫–∞</div>
                            <div style="opacity: 0.8; margin-bottom: 15px;">+$1 –∑–∞ –∫–ª–∏–∫</div>
                            <div class="upgrade-price" id="click-price">–¶–µ–Ω–∞: $10</div>
                        </div>
                        
                        <div class="upgrade-card" onclick="buyUpgrade('auto')">
                            <div class="upgrade-icon">‚ö°</div>
                            <div style="font-weight: 700; margin-bottom: 10px; font-size: 18px;">–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</div>
                            <div style="opacity: 0.8; margin-bottom: 15px;">+$0.5/—Å–µ–∫</div>
                            <div class="upgrade-price" id="auto-price">–¶–µ–Ω–∞: $100</div>
                        </div>
                        
                        <div class="upgrade-card" onclick="buyUpgrade('multiplier')">
                            <div class="upgrade-icon">üöÄ</div>
                            <div style="font-weight: 700; margin-bottom: 10px; font-size: 18px;">–ú–Ω–æ–∂–∏—Ç–µ–ª—å</div>
                            <div style="opacity: 0.8; margin-bottom: 15px;">√ó1.2 –∫–æ –≤—Å–µ–º—É</div>
                            <div class="upgrade-price" id="multiplier-price">–¶–µ–Ω–∞: $1000</div>
                        </div>
                        
                        <div class="upgrade-card" onclick="buyRebirth()">
                            <div class="upgrade-icon">üîÑ</div>
                            <div style="font-weight: 700; margin-bottom: 10px; font-size: 18px;">–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ</div>
                            <div style="opacity: 0.8; margin-bottom: 15px;">+0.5x –º–Ω–æ–∂–∏—Ç–µ–ª—å</div>
                            <div class="upgrade-price" id="rebirth-price">–¶–µ–Ω–∞: $10000</div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; text-align: center;">
                    <div id="rebirth-count" style="margin-bottom: 15px; font-size: 18px; font-weight: 700;">–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–π: 0</div>
                    <div style="display: flex; justify-content: center; gap: 20px; margin-bottom: 30px;">
                        <button class="voice-btn" onclick="openShop()" style="background: var(--warning);">
                            <span style="margin-right: 10px;">üõí</span> –ú–∞–≥–∞–∑–∏–Ω —è–∏—Ü
                        </button>
                        <button class="voice-btn" onclick="openPets()" style="background: var(--accent);">
                            <span style="margin-right: 10px;">üêæ</span> –ú–æ–∏ –ø–∏—Ç–æ–º—Ü—ã
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–∞–≥–∞–∑–∏–Ω —è–∏—Ü -->
    <div id="shop-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 28px; font-weight: 800;">üõí –ú–∞–≥–∞–∑–∏–Ω —è–∏—Ü</h2>
                <button class="close-btn" onclick="closeModal('shop-modal')">√ó</button>
            </div>
            
            <div style="margin: 30px 0;">
                <div class="shop-grid">
                    <div class="shop-item egg-animation" onclick="buyEgg('common')">
                        <div class="shop-item-icon">ü•ö</div>
                        <div style="font-weight: 800; margin-bottom: 10px; font-size: 20px;">–û–±—ã—á–Ω–æ–µ —è–π—Ü–æ</div>
                        <div style="opacity: 0.8; margin-bottom: 15px; font-size: 14px;">70% –æ–±—ã—á–Ω—ã–π –ø–∏—Ç–æ–º–µ—Ü<br>25% —Ä–µ–¥–∫–∏–π<br>5% —ç–ø–∏—á–µ—Å–∫–∏–π</div>
                        <div style="color: var(--success); font-weight: 800; font-size: 20px;">$100</div>
                    </div>
                    
                    <div class="shop-item egg-animation" onclick="buyEgg('rare')" style="border-color: #3b82f6;">
                        <div class="shop-item-icon">üîµ</div>
                        <div style="font-weight: 800; margin-bottom: 10px; font-size: 20px;">–†–µ–¥–∫–æ–µ —è–π—Ü–æ</div>
                        <div style="opacity: 0.8; margin-bottom: 15px; font-size: 14px;">50% —Ä–µ–¥–∫–∏–π –ø–∏—Ç–æ–º–µ—Ü<br>40% —ç–ø–∏—á–µ—Å–∫–∏–π<br>10% –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π</div>
                        <div style="color: #3b82f6; font-weight: 800; font-size: 20px;">$500</div>
                    </div>
                    
                    <div class="shop-item egg-animation" onclick="buyEgg('epic')" style="border-color: #8b5cf6;">
                        <div class="shop-item-icon">üü£</div>
                        <div style="font-weight: 800; margin-bottom: 10px; font-size: 20px;">–≠–ø–∏—á–µ—Å–∫–æ–µ —è–π—Ü–æ</div>
                        <div style="opacity: 0.8; margin-bottom: 15px; font-size: 14px;">70% —ç–ø–∏—á–µ—Å–∫–∏–π –ø–∏—Ç–æ–º–µ—Ü<br>25% –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π<br>5% –º–∏—Ñ–∏—á–µ—Å–∫–∏–π</div>
                        <div style="color: #8b5cf6; font-weight: 800; font-size: 20px;">$2000</div>
                    </div>
                    
                    <div class="shop-item egg-animation" onclick="buyEgg('legendary')" style="border-color: #f59e0b;">
                        <div class="shop-item-icon">‚≠ê</div>
                        <div style="font-weight: 800; margin-bottom: 10px; font-size: 20px;">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ —è–π—Ü–æ</div>
                        <div style="opacity: 0.8; margin-bottom: 15px; font-size: 14px;">90% –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –ø–∏—Ç–æ–º–µ—Ü<br>10% –º–∏—Ñ–∏—á–µ—Å–∫–∏–π</div>
                        <div style="color: #f59e0b; font-weight: 800; font-size: 20px;">$5000</div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 40px;">
                    <button class="voice-btn" onclick="openEggs()" style="background: var(--accent); padding: 15px 30px;">
                        <span style="margin-right: 10px;">üéÅ</span> –ú–æ–∏ —è–π—Ü–∞
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 28px; font-weight: 800;">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <button class="close-btn" onclick="closeModal('settings-modal')">√ó</button>
            </div>
            
            <div class="settings-grid">
                <div class="setting-card">
                    <h3 style="margin-bottom: 20px; font-size: 22px;">üé® –¢–µ–º–∞</h3>
                    <div class="theme-selector">
                        <button class="theme-btn theme-dark active" onclick="setTheme('dark')">–¢—ë–º–Ω–∞—è</button>
                        <button class="theme-btn theme-light" onclick="setTheme('light')">–°–≤–µ—Ç–ª–∞—è</button>
                        <button class="theme-btn theme-purple" onclick="setTheme('purple')">–§–∏–æ–ª–µ—Ç–æ–≤–∞—è</button>
                    </div>
                </div>
                
                <div class="setting-card">
                    <h3 style="margin-bottom: 20px; font-size: 22px;">‚ùÑÔ∏è –°–Ω–µ–≥</h3>
                    <div class="toggle-group">
                        <span>–í–∫–ª—é—á–∏—Ç—å —Å–Ω–µ–∂–∏–Ω–∫–∏</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="snow-toggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div style="opacity: 0.7; font-size: 14px; margin-top: 15px;">
                        –°–Ω–µ–∂–∏–Ω–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ç—ë–º–Ω–æ–π –∏ —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–π —Ç–µ–º–µ. –î–ª—è —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞.
                    </div>
                </div>
                
                <div class="setting-card">
                    <h3 style="margin-bottom: 20px; font-size: 22px;">üíæ –î–∞–Ω–Ω—ã–µ</h3>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <button class="voice-btn" onclick="exportData()" style="width: 100%; justify-content: center;">
                            <span style="margin-right: 10px;">üì§</span> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                        </button>
                        <button class="voice-btn" onclick="importData()" style="width: 100%; justify-content: center; background: var(--secondary);">
                            <span style="margin-right: 10px;">üì•</span> –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                        </button>
                        <button class="voice-btn" onclick="clearData()" style="width: 100%; justify-content: center; background: var(--danger);">
                            <span style="margin-right: 10px;">üóëÔ∏è</span> –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
// ====================
// –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
// ====================
const USERS = ["–ù–∏–∫–∏—Ç–∞", "–ê–ª–µ–Ω–∞", "–°–∞—à–∞", "–ê–ª–∏—Å–∞", "–ì–æ—Å—Ç—å"];
let currentUser = null;
let appData = JSON.parse(localStorage.getItem('platform_data')) || {
    users: {},
    online: {},
    settings: { theme: 'dark', snow: true },
    chat: [],
    cloud: [],
    notifications: []
};

// Three.js –¥–ª—è CS 1.6
let csScene, csCamera, csRenderer, csPlayer, csBots = [];
let csHealth = 100, csMoney = 800, csKills = 0, csAmmo = 30;
let currentWeapon = 'ak47';

// –ö–ª–∏–∫–µ—Ä Pro
let clickerMoney = 0;
let clickerClickPower = 1;
let clickerAutoClicker = 0;
let clickerMultiplier = 1;
let rebirths = 0;
let pets = [];
let eggs = [];
let activeBoost = null;

// Talking Tom 2
let tomHappiness = 100;
let tomHunger = 100;
let tomMoney = 100;
let tomCases = 0;
let tomInventory = [];

// –ß–∞—Ç
let currentChat = 'general';
let chatMessages = {
    general: [],
    '–ù–∏–∫–∏—Ç–∞': [],
    '–ê–ª–µ–Ω–∞': [],
    '–°–∞—à–∞': [],
    '–ê–ª–∏—Å–∞': [],
    '–ì–æ—Å—Ç—å': []
};

// –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
let notifications = [];

// –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫
let translationCache = {};

// ====================
// –ù–ê–í–ò–ì–ê–¶–ò–Ø
// ====================
function setupNavigation() {
    const tabs = document.querySelectorAll('.tab');
    const pages = document.querySelectorAll('.page');
    
    tabs.forEach(tab => {
        tab.addEventListener('click', function() {
            tabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            pages.forEach(page => page.classList.remove('active'));
            
            const pageId = this.getAttribute('data-page');
            document.getElementById(pageId).classList.add('active');
            
            // –û—Å–æ–±—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
            if (pageId === 'maps') loadMap();
        });
    });
}

// ====================
// –°–ù–ï–ñ–ò–ù–ö–ò
// ====================
function createSnowflakes() {
    if (appData.settings.theme === 'light' || !appData.settings.snow) return;
    
    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Å–Ω–µ–∂–∏–Ω–∫–∏
    document.querySelectorAll('.snowflake').forEach(s => s.remove());
    
    for (let i = 0; i < 80; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        
        const size = Math.random() * 15 + 5;
        snowflake.style.width = `${size}px`;
        snowflake.style.height = `${size}px`;
        snowflake.style.left = `${Math.random() * 100}vw`;
        snowflake.style.opacity = Math.random() * 0.6 + 0.2;
        snowflake.style.animationDuration = `${Math.random() * 20 + 10}s`;
        snowflake.style.animationDelay = `${Math.random() * 5}s`;
        
        document.body.appendChild(snowflake);
        
        setTimeout(() => {
            if (snowflake.parentNode) {
                snowflake.parentNode.removeChild(snowflake);
            }
        }, 30000);
    }
    
    setTimeout(createSnowflakes, 15000);
}

// ====================
// –í–´–ë–û–† –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
// ====================
function initUserSelection() {
    const userList = document.getElementById('user-list');
    userList.innerHTML = '';
    
    USERS.forEach(username => {
        const isOccupied = appData.online && appData.online[username];
        const btn = document.createElement('button');
        btn.className = `user-btn ${isOccupied ? 'occupied' : ''}`;
        btn.innerHTML = `${username} ${isOccupied ? ' (üü¢)' : ''}`;
        btn.onclick = () => selectUser(username, isOccupied);
        userList.appendChild(btn);
    });
}

function selectUser(username, isOccupied) {
    if (isOccupied) {
        alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "${username}" —É–∂–µ –≤ –∏–≥—Ä–µ!`);
        return;
    }
    
    document.querySelectorAll('.user-btn').forEach(btn => btn.classList.remove('selected'));
    event.target.classList.add('selected');
    currentUser = username;
}

function login() {
    if (!currentUser) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!');
        return;
    }
    
    if (appData.online && appData.online[currentUser]) {
        alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "${currentUser}" —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É!`);
        initUserSelection();
        return;
    }
    
    // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ –Ω–µ—Ç
    if (!appData.users[currentUser]) {
        appData.users[currentUser] = {
            balance: 1000,
            createdAt: Date.now(),
            games: {
                cs: { kills: 0, deaths: 0, money: 800 },
                tic: { wins: 0, losses: 0 },
                clicker: { 
                    money: 0, 
                    rebirths: 0,
                    pets: [],
                    eggs: [],
                    upgrades: { click: 1, auto: 0, multiplier: 1 }
                },
                tom: {
                    happiness: 100,
                    hunger: 100,
                    money: 100,
                    cases: 0,
                    inventory: []
                }
            }
        };
    }
    
    // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –æ–Ω–ª–∞–π–Ω
    appData.online[currentUser] = Date.now();
    saveData();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    initApp();
}

function initApp() {
    document.querySelector('.login-screen').style.display = 'none';
    document.querySelector('.main-app').style.display = 'block';
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
    setupNavigation();
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É
    setTheme(appData.settings.theme);
    
    // –°–Ω–µ–∂–∏–Ω–∫–∏
    if (appData.settings.snow) {
        setTimeout(createSnowflakes, 1000);
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    updateUserInfo();
    loadCloudFiles();
    initWorldClocks();
    loadChat();
    loadNotifications();
    initChatBot();
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    setupEventListeners();
}

function updateUserInfo() {
    const userData = appData.users[currentUser];
    const firstLetter = currentUser.charAt(0).toUpperCase();
    
    document.getElementById('current-avatar').textContent = firstLetter;
    document.getElementById('current-username').textContent = currentUser;
    document.getElementById('balance').textContent = `$${userData.balance || 1000}`;
}

function exitApp() {
    if (confirm('–í—ã–π—Ç–∏ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã?')) {
        // –£–¥–∞–ª—è–µ–º –∏–∑ –æ–Ω–ª–∞–π–Ω
        if (appData.online && appData.online[currentUser]) {
            delete appData.online[currentUser];
            saveData();
        }
        window.close();
    }
}

// ====================
// –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø
// ====================
function loadNotifications() {
    const container = document.getElementById('notifications');
    const userNotifications = appData.notifications.filter(n => n.to === currentUser);
    
    container.innerHTML = '';
    
    userNotifications.forEach((notification, index) => {
        const div = document.createElement('div');
        div.className = 'notification';
        div.innerHTML = `
            <div>
                <div style="font-weight: 700; margin-bottom: 5px;">${notification.title}</div>
                <div>${notification.message}</div>
                ${notification.type === 'challenge' ? `
                    <div class="notification-buttons">
                        <button class="notification-btn accept" onclick="acceptChallenge(${index})">–ü—Ä–∏–Ω—è—Ç—å</button>
                        <button class="notification-btn decline" onclick="declineChallenge(${index})">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                    </div>
                ` : ''}
            </div>
            <button onclick="closeNotification(${index})" style="background: none; border: none; color: var(--text); cursor: pointer; font-size: 20px;">√ó</button>
        `;
        container.appendChild(div);
    });
}

function addNotification(to, title, message, type = 'info') {
    appData.notifications.push({
        to,
        title,
        message,
        type,
        timestamp: Date.now()
    });
    saveData();
    loadNotifications();
}

function closeNotification(index) {
    appData.notifications.splice(index, 1);
    saveData();
    loadNotifications();
}

function acceptChallenge(index) {
    const notification = appData.notifications[index];
    addNotification(notification.from, '–í—ã–∑–æ–≤ –ø—Ä–∏–Ω—è—Ç!', `${currentUser} –ø—Ä–∏–Ω—è–ª –≤–∞—à –≤—ã–∑–æ–≤!`, 'info');
    closeNotification(index);
    alert(`–í—ã –ø—Ä–∏–Ω—è–ª–∏ –≤—ã–∑–æ–≤ –æ—Ç ${notification.from}!`);
}

function declineChallenge(index) {
    const notification = appData.notifications[index];
    addNotification(notification.from, '–í—ã–∑–æ–≤ –æ—Ç–∫–ª–æ–Ω–µ–Ω', `${currentUser} –æ—Ç–∫–ª–æ–Ω–∏–ª –≤–∞—à –≤—ã–∑–æ–≤`, 'info');
    closeNotification(index);
}

// ====================
// –û–ë–õ–ê–ö–û
// ====================
function loadCloudFiles() {
    const grid = document.getElementById('files-grid');
    const files = appData.cloud || [];
    
    if (files.length === 0) {
        grid.innerHTML = `
            <div style="grid-column: 1/-1; text-align: center; padding: 60px; opacity: 0.7; background: var(--card); border-radius: 20px; border: 2px dashed var(--border);">
                <div style="font-size: 64px; margin-bottom: 20px;">‚òÅÔ∏è</div>
                <div style="font-size: 20px; margin-bottom: 15px; font-weight: 700;">–§–∞–π–ª–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</div>
                <div style="opacity: 0.8;">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π —Ñ–∞–π–ª!</div>
            </div>
        `;
        return;
    }
    
    grid.innerHTML = files.map((file, index) => `
        <div class="file">
            <button class="delete-file" onclick="deleteFile(${index})">√ó</button>
            <div class="file-icon">${getFileIcon(file.type)}</div>
            <div class="file-name">${file.name}</div>
            <div class="file-size">${file.size}</div>
        </div>
    `).join('');
}

function getFileIcon(type) {
    const icons = {
        'photo': 'üì∑',
        'video': 'üé¨',
        'audio': 'üéµ',
        'document': 'üìÑ',
        'archive': 'üì¶',
        'code': 'üíª',
        'pdf': 'üìï',
        'file': 'üìÑ'
    };
    return icons[type] || 'üìÑ';
}

function addFile() {
    const name = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞:');
    if (!name) return;
    
    const types = ['photo', 'video', 'audio', 'document', 'archive', 'code', 'pdf'];
    const type = prompt(`–í–≤–µ–¥–∏—Ç–µ —Ç–∏–ø (${types.join(', ')}):`) || 'file';
    const size = `${Math.floor(Math.random() * 5000) + 100} KB`;
    
    appData.cloud.push({ 
        name, 
        type: types.includes(type) ? type : 'file', 
        size, 
        date: new Date().toLocaleString(),
        owner: currentUser
    });
    saveData();
    loadCloudFiles();
}

function deleteFile(index) {
    if (confirm('–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª?')) {
        appData.cloud.splice(index, 1);
        saveData();
        loadCloudFiles();
    }
}

// ====================
// –ò–ì–†–´
// ====================
// Counter-Strike 1.6
function startCS() {
    document.getElementById('cs-game').style.display = 'block';
    initCS();
}

function initCS() {
    const canvas = document.getElementById('cs-canvas');
    
    // –°—Ü–µ–Ω–∞
    csScene = new THREE.Scene();
    csScene.background = new THREE.Color(0x1a1a1a);
    
    // –ö–∞–º–µ—Ä–∞
    csCamera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
    csCamera.position.set(0, 5, 10);
    
    // –†–µ–Ω–¥–µ—Ä–µ—Ä
    csRenderer = new THREE.WebGLRenderer({ canvas, antialias: true });
    csRenderer.setSize(canvas.clientWidth, canvas.clientHeight);
    csRenderer.shadowMap.enabled = true;
    
    // –û—Å–≤–µ—â–µ–Ω–∏–µ
    const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
    csScene.add(ambientLight);
    
    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
    directionalLight.position.set(10, 20, 10);
    directionalLight.castShadow = true;
    csScene.add(directionalLight);
    
    // –¢–µ–∫—Å—Ç—É—Ä—ã –ø–æ–ª–∞
    const floorGeometry = new THREE.PlaneGeometry(100, 100);
    const floorMaterial = new THREE.MeshPhongMaterial({ color: 0x333333 });
    const floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.rotation.x = -Math.PI / 2;
    floor.receiveShadow = true;
    csScene.add(floor);
    
    // –°—Ç–µ–Ω—ã
    const wallMaterial = new THREE.MeshPhongMaterial({ color: 0x666666 });
    
    // –°—Ç–µ–Ω–∞ 1
    const wall1 = new THREE.Mesh(
        new THREE.BoxGeometry(80, 10, 2),
        wallMaterial
    );
    wall1.position.set(0, 5, -40);
    wall1.castShadow = true;
    csScene.add(wall1);
    
    // –°—Ç–µ–Ω–∞ 2
    const wall2 = new THREE.Mesh(
        new THREE.BoxGeometry(2, 10, 80),
        wallMaterial
    );
    wall2.position.set(-40, 5, 0);
    wall2.castShadow = true;
    csScene.add(wall2);
    
    // –°—Ç–µ–Ω–∞ 3
    const wall3 = new THREE.Mesh(
        new THREE.BoxGeometry(2, 10, 80),
        wallMaterial
    );
    wall3.position.set(40, 5, 0);
    wall3.castShadow = true;
    csScene.add(wall3);
    
    // –ò–≥—Ä–æ–∫ (CT –º–æ–¥–µ–ª—å)
    createPlayer();
    
    // –ë–æ—Ç—ã (T –º–æ–¥–µ–ª—å)
    createBots();
    
    // –û—Ä—É–∂–∏–µ –Ω–∞ –∑–µ–º–ª–µ
    createWeapons();
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    setupCSControls();
    
    // –ê–Ω–∏–º–∞—Ü–∏—è
    animateCS();
}

function createPlayer() {
    // –ì–æ–ª–æ–≤–∞
    const headGeometry = new THREE.SphereGeometry(0.5, 16, 16);
    const headMaterial = new THREE.MeshPhongMaterial({ color: 0x4CAF50 }); // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è CT
    const head = new THREE.Mesh(headGeometry, headMaterial);
    head.position.y = 5.5;
    
    // –¢–µ–ª–æ
    const bodyGeometry = new THREE.BoxGeometry(1, 2, 1);
    const bodyMaterial = new THREE.MeshPhongMaterial({ color: 0x4CAF50 });
    const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
    body.position.y = 4;
    
    csPlayer = new THREE.Group();
    csPlayer.add(head);
    csPlayer.add(body);
    csPlayer.position.set(0, 0, 20);
    csPlayer.castShadow = true;
    
    csScene.add(csPlayer);
}

function createBots() {
    const botColors = [0xFF5252, 0xFF4081, 0xE040FB]; // –ö—Ä–∞—Å–Ω—ã–µ –¥–ª—è T
    
    for (let i = 0; i < 5; i++) {
        const botGroup = new THREE.Group();
        
        // –ì–æ–ª–æ–≤–∞
        const headGeometry = new THREE.SphereGeometry(0.5, 16, 16);
        const headMaterial = new THREE.MeshPhongMaterial({ 
            color: botColors[i % botColors.length] 
        });
        const head = new THREE.Mesh(headGeometry, headMaterial);
        head.position.y = 5.5;
        
        // –¢–µ–ª–æ
        const bodyGeometry = new THREE.BoxGeometry(1, 2, 1);
        const bodyMaterial = new THREE.MeshPhongMaterial({ 
            color: botColors[i % botColors.length] 
        });
        const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
        body.position.y = 4;
        
        botGroup.add(head);
        botGroup.add(body);
        
        botGroup.position.set(
            (Math.random() - 0.5) * 60,
            0,
            (Math.random() - 0.5) * 60 - 20
        );
        
        botGroup.castShadow = true;
        botGroup.userData.health = 100;
        botGroup.userData.id = i;
        
        csScene.add(botGroup);
        csBots.push(botGroup);
    }
}

function createWeapons() {
    const weaponPositions = [
        { x: -20, z: -20, type: 'ak47' },
        { x: 20, z: -20, type: 'awp' },
        { x: -20, z: 0, type: 'm4a1' },
        { x: 20, z: 0, type: 'deagle' }
    ];
    
    weaponPositions.forEach(pos => {
        const weaponGeometry = new THREE.BoxGeometry(0.5, 0.5, 2);
        const weaponMaterial = new THREE.MeshPhongMaterial({ color: 0x8B4513 });
        const weapon = new THREE.Mesh(weaponGeometry, weaponMaterial);
        weapon.position.set(pos.x, 1, pos.z);
        weapon.rotation.x = Math.PI / 2;
        weapon.castShadow = true;
        weapon.userData.type = pos.type;
        
        csScene.add(weapon);
    });
}

function setupCSControls() {
    const keys = {};
    const mouse = { x: 0, y: 0 };
    
    window.addEventListener('keydown', (e) => {
        keys[e.key.toLowerCase()] = true;
        
        if (e.key === ' ') shoot();
        if (e.key === 'r') reload();
        if (e.key === 'e') pickWeapon();
    });
    
    window.addEventListener('keyup', (e) => {
        keys[e.key.toLowerCase()] = false;
    });
    
    window.addEventListener('mousemove', (e) => {
        mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
    });
    
    function updateMovement() {
        const speed = 0.3;
        const rotationSpeed = 0.03;
        
        // –ü–æ–≤–æ—Ä–æ—Ç –∏–≥—Ä–æ–∫–∞
        csPlayer.rotation.y -= mouse.x * rotationSpeed;
        
        // –î–≤–∏–∂–µ–Ω–∏–µ
        const direction = new THREE.Vector3();
        csCamera.getWorldDirection(direction);
        
        if (keys['w']) {
            csPlayer.position.x -= direction.x * speed;
            csPlayer.position.z -= direction.z * speed;
        }
        if (keys['s']) {
            csPlayer.position.x += direction.x * speed;
            csPlayer.position.z += direction.z * speed;
        }
        if (keys['a']) {
            csPlayer.position.x += direction.z * speed;
            csPlayer.position.z -= direction.x * speed;
        }
        if (keys['d']) {
            csPlayer.position.x -= direction.z * speed;
            csPlayer.position.z += direction.x * speed;
        }
        
        // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
        csPlayer.position.x = Math.max(-38, Math.min(38, csPlayer.position.x));
        csPlayer.position.z = Math.max(-38, Math.min(38, csPlayer.position.z));
        
        // –ö–∞–º–µ—Ä–∞ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∏–≥—Ä–æ–∫–æ–º
        csCamera.position.x = csPlayer.position.x;
        csCamera.position.y = csPlayer.position.y + 8;
        csCamera.position.z = csPlayer.position.z + 12;
        csCamera.lookAt(csPlayer.position.x, csPlayer.position.y + 2, csPlayer.position.z);
        
        // –î–≤–∏–∂–µ–Ω–∏–µ –±–æ—Ç–æ–≤
        csBots.forEach(bot => {
            if (bot.userData.health <= 0) return;
            
            const dx = csPlayer.position.x - bot.position.x;
            const dz = csPlayer.position.z - bot.position.z;
            const distance = Math.sqrt(dx * dx + dz * dz);
            
            if (distance > 5) {
                bot.position.x += (dx / distance) * 0.05;
                bot.position.z += (dz / distance) * 0.05;
                bot.lookAt(csPlayer.position);
            }
            
            // –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–µ–ª—å–±–∞ –±–æ—Ç–∞
            if (distance < 20 && Math.random() < 0.01) {
                botShoot(bot);
            }
        });
    }
    
    function animateCS() {
        requestAnimationFrame(animateCS);
        updateMovement();
        csRenderer.render(csScene, csCamera);
    }
    
    animateCS();
}

function shoot() {
    if (csAmmo <= 0) return;
    
    csAmmo--;
    updateCSHUD();
    
    // –°–æ–∑–¥–∞–µ–º –ª—É—á –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ø–∞–¥–∞–Ω–∏—è
    const raycaster = new THREE.Raycaster();
    raycaster.setFromCamera(new THREE.Vector2(0, 0), csCamera);
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ø–∞–¥–∞–Ω–∏–µ –≤ –±–æ—Ç–æ–≤
    const intersects = raycaster.intersectObjects(csBots);
    
    if (intersects.length > 0) {
        const bot = intersects[0].object.parent;
        bot.userData.health -= 35;
        
        if (bot.userData.health <= 0) {
            csKills++;
            csMoney += 300;
            updateCSHUD();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —Å–º–µ—Ä—Ç–∏
            bot.rotation.x = Math.PI / 2;
            
            setTimeout(() => {
                csScene.remove(bot);
                csBots = csBots.filter(b => b !== bot);
                
                if (csBots.length < 3) {
                    createBots();
                }
            }, 2000);
        }
    }
}

function botShoot(bot) {
    // –ü—Ä–æ—Å—Ç–æ–π —Ä–∞—Å—á–µ—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è
    const dx = csPlayer.position.x - bot.position.x;
    const dz = csPlayer.position.z - bot.position.z;
    const distance = Math.sqrt(dx * dx + dz * dz);
    
    if (distance < 15 && Math.random() < 0.3) {
        csHealth -= 10;
        updateCSHUD();
        
        if (csHealth <= 0) {
            alert('–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏! –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–Ω–æ–≤–æ.');
            resetCSGame();
        }
    }
}

function pickWeapon() {
    const raycaster = new THREE.Raycaster();
    raycaster.setFromCamera(new THREE.Vector2(0, 0), csCamera);
    const intersects = raycaster.intersectObjects(csScene.children);
    
    for (const intersect of intersects) {
        if (intersect.object.userData.type) {
            currentWeapon = intersect.object.userData.type;
            csAmmo = getWeaponAmmo(currentWeapon);
            updateCSHUD();
            csScene.remove(intersect.object);
            alert(`–ü–æ–¥–æ–±—Ä–∞–ª–∏ ${currentWeapon.toUpperCase()}!`);
            break;
        }
    }
}

function getWeaponAmmo(weapon) {
    const ammoMap = {
        'ak47': 30,
        'awp': 10,
        'm4a1': 30,
        'deagle': 7
    };
    return ammoMap[weapon] || 30;
}

function selectWeapon(weapon) {
    currentWeapon = weapon;
    document.querySelectorAll('.cs-weapon').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    csAmmo = getWeaponAmmo(weapon);
    updateCSHUD();
}

function reload() {
    csAmmo = getWeaponAmmo(currentWeapon);
    updateCSHUD();
}

function updateCSHUD() {
    document.getElementById('cs-health').textContent = csHealth;
    document.getElementById('cs-money').textContent = `$${csMoney}`;
    document.getElementById('cs-kills').textContent = `${csKills} —É–±–∏–π—Å—Ç–≤`;
    document.getElementById('cs-ammo').textContent = `${csAmmo}/${getWeaponAmmo(currentWeapon) * 3}`;
}

function resetCSGame() {
    csHealth = 100;
    csMoney = 800;
    csKills = 0;
    csAmmo = 30;
    updateCSHUD();
    
    // –û—á–∏—â–∞–µ–º —Å—Ü–µ–Ω—É –∏ —Å–æ–∑–¥–∞–µ–º –∑–∞–Ω–æ–≤–æ
    while(csScene.children.length > 0){ 
        csScene.remove(csScene.children[0]); 
    }
    csBots = [];
    initCS();
}

function exitCS() {
    document.getElementById('cs-game').style.display = 'none';
    csScene = null;
    csBots = [];
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
    if (appData.users[currentUser]) {
        appData.users[currentUser].games.cs = {
            kills: csKills,
            money: csMoney,
            health: csHealth
        };
        saveData();
    }
}

// My Talking Tom 2 - –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
function startTalkingTom() {
    showModal('talking-tom-modal');
    loadTomData();
}

function loadTomData() {
    const userData = appData.users[currentUser];
    const tomData = userData.games.tom || {
        happiness: 100,
        hunger: 100,
        money: 100,
        cases: 0,
        inventory: []
    };
    
    tomHappiness = tomData.happiness || 100;
    tomHunger = tomData.hunger || 100;
    tomMoney = tomData.money || 100;
    tomCases = tomData.cases || 0;
    tomInventory = tomData.inventory || [];
    
    updateTomStats();
    updateTomInventory();
}

function petTom() {
    tomHappiness = Math.min(100, tomHappiness + 10);
    tomMoney += 5;
    animateTom();
    updateTomStats();
    saveTomData();
}

function feedTom() {
    if (tomMoney >= 10) {
        tomHunger = Math.min(100, tomHunger + 30);
        tomMoney -= 10;
        tomHappiness = Math.min(100, tomHappiness + 5);
        updateTomStats();
        saveTomData();
    } else {
        alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
    }
}

function playWithTom() {
    tomHappiness = Math.min(100, tomHappiness + 20);
    tomHunger = Math.max(0, tomHunger - 10);
    updateTomStats();
    saveTomData();
}

function buyTomCase() {
    if (tomMoney >= 50) {
        tomMoney -= 50;
        tomCases++;
        updateTomStats();
        saveTomData();
        alert('–ö–µ–π—Å –∫—É–ø–ª–µ–Ω! –û—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ.');
    } else {
        alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥! –ù—É–∂–Ω–æ $50');
    }
}

function openTomCase() {
    if (tomCases <= 0) {
        alert('–ù–µ—Ç –∫–µ–π—Å–æ–≤ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è!');
        return;
    }
    
    tomCases--;
    
    // –°–ª—É—á–∞–π–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞
    const rewards = [
        { name: 'üçñ –ï–¥–∞', type: 'food', value: 20 },
        { name: 'üí∞ 50$', type: 'money', value: 50 },
        { name: 'üéÆ –ò–≥—Ä—É—à–∫–∞', type: 'toy', value: 15 },
        { name: 'üëï –û–¥–µ–∂–¥–∞', type: 'clothes', value: 30 },
        { name: 'üíé –î—Ä–∞–≥–æ—Ü–µ–Ω–Ω–æ—Å—Ç—å', type: 'jewelry', value: 100 }
    ];
    
    const reward = rewards[Math.floor(Math.random() * rewards.length)];
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞–≥—Ä–∞–¥—É
    if (reward.type === 'food') {
        tomHunger = Math.min(100, tomHunger + reward.value);
    } else if (reward.type === 'money') {
        tomMoney += reward.value;
    } else if (reward.type === 'toy') {
        tomHappiness = Math.min(100, tomHappiness + reward.value);
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
    tomInventory.push(reward);
    
    updateTomStats();
    updateTomInventory();
    saveTomData();
    
    alert(`–í—ã –æ—Ç–∫—Ä—ã–ª–∏ –∫–µ–π—Å –∏ –ø–æ–ª—É—á–∏–ª–∏: ${reward.name} (+${reward.value})!`);
}

function animateTom() {
    const tomPet = document.getElementById('tom-pet');
    tomPet.style.transform = 'scale(1.1)';
    setTimeout(() => {
        tomPet.style.transform = 'scale(1)';
    }, 300);
}

function updateTomStats() {
    document.getElementById('tom-happiness').textContent = `${tomHappiness}%`;
    document.getElementById('tom-hunger').textContent = `${tomHunger}%`;
    document.getElementById('tom-money').textContent = `$${tomMoney}`;
    document.getElementById('tom-cases').textContent = tomCases;
}

function updateTomInventory() {
    const inventoryGrid = document.getElementById('tom-inventory');
    
    if (tomInventory.length === 0) {
        inventoryGrid.innerHTML = `
            <div style="grid-column: 1/-1; text-align: center; padding: 40px; opacity: 0.7;">
                <div style="font-size: 48px; margin-bottom: 20px;">üéí</div>
                <div>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>
                <div style="font-size: 14px; margin-top: 10px;">–ö—É–ø–∏—Ç–µ –∫–µ–π—Å—ã, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã</div>
            </div>
        `;
        return;
    }
    
    inventoryGrid.innerHTML = tomInventory.map((item, index) => `
        <div class="inventory-item">
            <div style="font-size: 32px; margin-bottom: 10px;">${item.name.split(' ')[0]}</div>
            <div style="font-size: 14px; opacity: 0.8;">${item.type}</div>
            <div style="font-size: 12px; margin-top: 5px; color: var(--accent);">+${item.value}</div>
        </div>
    `).join('');
}

function saveTomData() {
    appData.users[currentUser].games.tom = {
        happiness: tomHappiness,
        hunger: tomHunger,
        money: tomMoney,
        cases: tomCases,
        inventory: tomInventory
    };
    saveData();
}

// –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ —Å –≤—ã–∑–æ–≤–æ–º –¥—Ä—É–∑–µ–π
let ticBoard = ['', '', '', '', '', '', '', '', ''];
let ticCurrentPlayer = 'X';
let ticGameActive = true;
let ticMode = 'bot';
let ticPlayerSymbol = 'X';
let ticOpponent = 'bot';

function startTicTacToe() {
    showModal('tic-tac-toe-modal');
    initTicTacToe();
}

function setTicMode(mode) {
    ticMode = mode;
    document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    const friendSelector = document.getElementById('friend-selector');
    if (mode === 'friend') {
        friendSelector.style.display = 'block';
        loadFriendsList();
    } else {
        friendSelector.style.display = 'none';
        ticOpponent = 'bot';
        document.getElementById('tic-opponent').textContent = '–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫: –ë–æ—Ç (‚≠ï)';
    }
}

function loadFriendsList() {
    const select = document.getElementById('friend-select');
    select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–∞</option>';
    
    USERS.forEach(user => {
        if (user !== currentUser) {
            const isOnline = appData.online[user];
            const option = document.createElement('option');
            option.value = user;
            option.textContent = `${user} ${isOnline ? 'üü¢' : '‚ö´'}`;
            option.disabled = !isOnline;
            select.appendChild(option);
        }
    });
}

function challengeFriend() {
    const friend = document.getElementById('friend-select').value;
    if (!friend) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–∞!');
        return;
    }
    
    if (!appData.online[friend]) {
        alert('–≠—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ñ—Ñ–ª–∞–π–Ω!');
        return;
    }
    
    addNotification(friend, '–í—ã–∑–æ–≤ –Ω–∞ –¥—É—ç–ª—å!', `${currentUser} –≤—ã–∑—ã–≤–∞–µ—Ç –≤–∞—Å –Ω–∞ –∏–≥—Ä—É –≤ –∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏!`, 'challenge');
    alert(`–í—ã–∑–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω ${friend}! –û–∂–∏–¥–∞–π—Ç–µ –æ—Ç–≤–µ—Ç–∞.`);
    closeModal('tic-tac-toe-modal');
}

function initTicTacToe() {
    const board = document.getElementById('tic-board');
    board.innerHTML = '';
    
    for (let i = 0; i < 9; i++) {
        const cell = document.createElement('div');
        cell.className = 'tic-cell';
        cell.dataset.index = i;
        cell.onclick = () => makeMove(i);
        board.appendChild(cell);
    }
    
    document.getElementById('tic-player').textContent = `–ò–≥—Ä–æ–∫: ${currentUser} (‚ùå)`;
    document.getElementById('tic-status').textContent = '–•–æ–¥: ‚ùå';
}

function makeMove(index) {
    if (!ticGameActive || ticBoard[index] !== '') return;
    
    ticBoard[index] = ticCurrentPlayer;
    const cell = document.querySelector(`.tic-cell[data-index="${index}"]`);
    cell.textContent = ticCurrentPlayer;
    cell.classList.add(ticCurrentPlayer.toLowerCase());
    
    if (checkWin()) {
        document.getElementById('tic-status').textContent = `–ü–æ–±–µ–¥–∏–ª ${ticCurrentPlayer === 'X' ? currentUser : ticOpponent}!`;
        ticGameActive = false;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        if (appData.users[currentUser]) {
            if (ticCurrentPlayer === 'X') {
                appData.users[currentUser].games.tic.wins++;
            } else {
                appData.users[currentUser].games.tic.losses++;
            }
            saveData();
        }
        
        return;
    }
    
    if (isBoardFull()) {
        document.getElementById('tic-status').textContent = '–ù–∏—á—å—è!';
        ticGameActive = false;
        return;
    }
    
    ticCurrentPlayer = ticCurrentPlayer === 'X' ? 'O' : 'X';
    document.getElementById('tic-status').textContent = `–•–æ–¥: ${ticCurrentPlayer === 'X' ? '‚ùå' : '‚≠ï'}`;
    
    if (ticMode === 'bot' && ticCurrentPlayer === 'O') {
        setTimeout(makeBotMove, 500);
    }
}

function makeBotMove() {
    const availableMoves = ticBoard.map((cell, index) => cell === '' ? index : -1).filter(i => i !== -1);
    if (availableMoves.length > 0) {
        // –ü—Ä–æ—Å—Ç–æ–π –ò–ò: —Å–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –≤—ã–∏–≥—Ä–∞—Ç—å, –ø–æ—Ç–æ–º –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, –ø–æ—Ç–æ–º —Å–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
        let move = -1;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–π —Ö–æ–¥
        move = findWinningMove('O');
        if (move === -1) {
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—ã–∏–≥—Ä—ã—à —Å–æ–ø–µ—Ä–Ω–∏–∫–∞
            move = findWinningMove('X');
        }
        if (move === -1) {
            // –°–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
            move = availableMoves[Math.floor(Math.random() * availableMoves.length)];
        }
        
        makeMove(move);
    }
}

function findWinningMove(player) {
    const lines = [
        [0,1,2], [3,4,5], [6,7,8],
        [0,3,6], [1,4,7], [2,5,8],
        [0,4,8], [2,4,6]
    ];
    
    for (const line of lines) {
        const [a,b,c] = line;
        const cells = [ticBoard[a], ticBoard[b], ticBoard[c]];
        const emptyIndex = line[cells.indexOf('')];
        
        if (cells.filter(c => c === player).length === 2 && cells.includes('')) {
            return emptyIndex;
        }
    }
    
    return -1;
}

function checkWin() {
    const patterns = [
        [0,1,2], [3,4,5], [6,7,8],
        [0,3,6], [1,4,7], [2,5,8],
        [0,4,8], [2,4,6]
    ];
    
    return patterns.some(pattern => {
        const [a,b,c] = pattern;
        return ticBoard[a] && ticBoard[a] === ticBoard[b] && ticBoard[a] === ticBoard[c];
    });
}

function isBoardFull() {
    return ticBoard.every(cell => cell !== '');
}

function resetTicTacToe() {
    ticBoard = ['', '', '', '', '', '', '', '', ''];
    ticCurrentPlayer = 'X';
    ticGameActive = true;
    initTicTacToe();
}

// –ö–ª–∏–∫–µ—Ä Pro
function startClicker() {
    showModal('clicker-modal');
    loadClickerData();
}

function loadClickerData() {
    const userData = appData.users[currentUser];
    const clickerData = userData.games.clicker || {
        money: 0,
        rebirths: 0,
        pets: [],
        eggs: [],
        upgrades: { click: 1, auto: 0, multiplier: 1 }
    };
    
    clickerMoney = clickerData.money || 0;
    clickerClickPower = clickerData.upgrades.click || 1;
    clickerAutoClicker = clickerData.upgrades.auto || 0;
    clickerMultiplier = clickerData.upgrades.multiplier || 1;
    rebirths = clickerData.rebirths || 0;
    pets = clickerData.pets || [];
    eggs = clickerData.eggs || [];
    
    updateClickerUI();
    
    // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
    if (clickerAutoClicker > 0 && !window.autoClickerInterval) {
        startAutoClicker();
    }
}

function clickMoney() {
    let gain = clickerClickPower * clickerMultiplier;
    if (activeBoost) {
        gain *= activeBoost.multiplier;
    }
    
    clickerMoney += gain;
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
    const button = document.getElementById('clicker-button');
    button.style.transform = 'scale(0.95)';
    setTimeout(() => {
        button.style.transform = 'scale(1)';
    }, 100);
    
    updateClickerUI();
    saveClickerData();
}

function buyUpgrade(type) {
    let cost = 0;
    
    switch(type) {
        case 'click':
            cost = 10 * Math.pow(2, clickerClickPower - 1);
            if (clickerMoney >= cost) {
                clickerMoney -= cost;
                clickerClickPower++;
            }
            break;
        case 'auto':
            cost = 100 * Math.pow(2, clickerAutoClicker);
            if (clickerMoney >= cost) {
                clickerMoney -= cost;
                clickerAutoClicker++;
                if (!window.autoClickerInterval) {
                    startAutoClicker();
                }
            }
            break;
        case 'multiplier':
            cost = 1000 * Math.pow(2, clickerMultiplier - 1);
            if (clickerMoney >= cost) {
                clickerMoney -= cost;
                clickerMultiplier += 0.2;
            }
            break;
    }
    
    if (clickerMoney >= cost) {
        updateClickerUI();
        saveClickerData();
    } else {
        alert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥! –ù—É–∂–Ω–æ: $${cost}`);
    }
}

function activateBoost(type) {
    const boosts = {
        '2x': { multiplier: 2, duration: 30, cost: 500 },
        '5x': { multiplier: 5, duration: 20, cost: 2000 },
        '10x': { multiplier: 10, duration: 10, cost: 5000 }
    };
    
    const boost = boosts[type];
    if (clickerMoney >= boost.cost) {
        clickerMoney -= boost.cost;
        activeBoost = { ...boost, endTime: Date.now() + boost.duration * 1000 };
        
        updateClickerUI();
        saveClickerData();
        
        alert(`–ë—É—Å—Ç ${type} –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –Ω–∞ ${boost.duration} —Å–µ–∫—É–Ω–¥!`);
        
        // –¢–∞–π–º–µ—Ä –±—É—Å—Ç–∞
        setTimeout(() => {
            if (activeBoost && activeBoost.multiplier === boost.multiplier) {
                activeBoost = null;
                updateClickerUI();
            }
        }, boost.duration * 1000);
    } else {
        alert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥! –ù—É–∂–Ω–æ: $${boost.cost}`);
    }
}

function buyRebirth() {
    const cost = 10000 * Math.pow(2, rebirths);
    
    if (clickerMoney >= cost) {
        if (confirm(`–ü–µ—Ä–µ—Ä–æ–¥–∏—Ç—å—Å—è –∑–∞ $${cost}?\n–í—ã –ø–æ–ª—É—á–∏—Ç–µ:\n+0.5x –∫ –º–Ω–æ–∂–∏—Ç–µ–ª—é\n–ù–æ–≤—ã–π –ø–∏—Ç–æ–º–µ—Ü\n–í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è —Å–±—Ä–æ—Å—è—Ç—Å—è`)) {
            clickerMoney = 0;
            rebirths++;
            clickerMultiplier += 0.5;
            clickerClickPower = 1;
            clickerAutoClicker = 0;
            activeBoost = null;
            
            // –î–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ –∑–∞ –ø–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ
            const petTypes = ['üêâ –î—Ä–∞–∫–æ–Ω', 'ü¶Ñ –ï–¥–∏–Ω–æ—Ä–æ–≥', 'üßå –û–≥—Ä', 'üßú –†—É—Å–∞–ª–∫–∞', 'üëª –ü—Ä–∏–∑—Ä–∞–∫'];
            const pet = petTypes[Math.floor(Math.random() * petTypes.length)];
            pets.push({ name: pet, rarity: 'legendary', level: 1 });
            
            updateClickerUI();
            saveClickerData();
            alert(`–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ #${rebirths} –∑–∞–≤–µ—Ä—à–µ–Ω–æ!\n–í—ã –ø–æ–ª—É—á–∏–ª–∏: ${pet}`);
        }
    } else {
        alert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥! –ù—É–∂–Ω–æ: $${cost}`);
    }
}

function startAutoClicker() {
    if (window.autoClickerInterval) {
        clearInterval(window.autoClickerInterval);
    }
    
    window.autoClickerInterval = setInterval(() => {
        let gain = clickerAutoClicker * 0.5 * clickerMultiplier;
        if (activeBoost) {
            gain *= activeBoost.multiplier;
        }
        
        clickerMoney += gain;
        updateClickerUI();
        saveClickerData();
    }, 1000);
}

function openShop() {
    closeModal('clicker-modal');
    showModal('shop-modal');
}

function buyEgg(type) {
    const prices = {
        'common': 100,
        'rare': 500,
        'epic': 2000,
        'legendary': 5000
    };
    
    const price = prices[type];
    if (clickerMoney >= price) {
        clickerMoney -= price;
        
        // –î–æ–±–∞–≤–ª—è–µ–º —è–π—Ü–æ
        eggs.push({
            type: type,
            id: Date.now(),
            progress: 0
        });
        
        updateClickerUI();
        saveClickerData();
        
        alert(`–í—ã –∫—É–ø–∏–ª–∏ ${type} —è–π—Ü–æ! –û—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ.`);
    } else {
        alert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥! –ù—É–∂–Ω–æ: $${price}`);
    }
}

function openEggs() {
    alert('–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å —è–∏—Ü –±—É–¥–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏!');
}

function openPets() {
    if (pets.length === 0) {
        alert('–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–∏—Ç–æ–º—Ü–µ–≤. –ö—É–ø–∏—Ç–µ —è–π—Ü–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ!');
        return;
    }
    
    let message = '–í–∞—à–∏ –ø–∏—Ç–æ–º—Ü—ã:\n\n';
    pets.forEach((pet, index) => {
        message += `${index + 1}. ${pet.name} (${pet.rarity}) –£—Ä. ${pet.level}\n`;
    });
    
    alert(message);
}

function updateClickerUI() {
    document.getElementById('clicker-money').textContent = `$${Math.floor(clickerMoney)}`;
    document.getElementById('clicker-per-click').textContent = `$${(clickerClickPower * clickerMultiplier * (activeBoost ? activeBoost.multiplier : 1)).toFixed(1)}`;
    document.getElementById('clicker-auto').textContent = `$${(clickerAutoClicker * 0.5 * clickerMultiplier * (activeBoost ? activeBoost.multiplier : 1)).toFixed(1)}/—Å–µ–∫`;
    document.getElementById('clicker-multiplier').textContent = `${clickerMultiplier.toFixed(1)}x${activeBoost ? ` +${activeBoost.multiplier}x` : ''}`;
    
    document.getElementById('click-price').textContent = `–¶–µ–Ω–∞: $${10 * Math.pow(2, clickerClickPower - 1)}`;
    document.getElementById('auto-price').textContent = `–¶–µ–Ω–∞: $${100 * Math.pow(2, clickerAutoClicker)}`;
    document.getElementById('multiplier-price').textContent = `–¶–µ–Ω–∞: $${1000 * Math.pow(2, clickerMultiplier - 1)}`;
    document.getElementById('rebirth-price').textContent = `–¶–µ–Ω–∞: $${10000 * Math.pow(2, rebirths)}`;
    document.getElementById('rebirth-count').textContent = `–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–π: ${rebirths}`;
}

function saveClickerData() {
    appData.users[currentUser].games.clicker = {
        money: clickerMoney,
        rebirths: rebirths,
        pets: pets,
        eggs: eggs,
        upgrades: {
            click: clickerClickPower,
            auto: clickerAutoClicker,
            multiplier: clickerMultiplier
        }
    };
    saveData();
}

// ====================
// –ü–ï–†–ï–í–û–î–ß–ò–ö (Google Translate style)
// ====================
async function translateText() {
    const text = document.getElementById('input-text').value;
    const from = document.getElementById('lang-from').value;
    const to = document.getElementById('lang-to').value;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Å–∏–º–≤–æ–ª–æ–≤
    document.getElementById('char-count').textContent = text.length;
    
    if (!text.trim()) {
        document.getElementById('output-text').value = '';
        return;
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
    const cacheKey = `${from}-${to}-${text}`;
    if (translationCache[cacheKey]) {
        document.getElementById('output-text').value = translationCache[cacheKey];
        return;
    }
    
    try {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π API –ø–µ—Ä–µ–≤–æ–¥–∞ (MyMemory)
        const response = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${from}|${to}`);
        const data = await response.json();
        
        if (data.responseData) {
            const translated = data.responseData.translatedText;
            translationCache[cacheKey] = translated;
            document.getElementById('output-text').value = translated;
        } else {
            // Fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å
            localTranslate(text, from, to);
        }
    } catch (error) {
        console.error('Translation error:', error);
        localTranslate(text, from, to);
    }
}

function localTranslate(text, from, to) {
    const dictionaries = {
        'ru-en': {
            '–ø—Ä–∏–≤–µ—Ç': 'hello',
            '–∫–∞–∫ –¥–µ–ª–∞': 'how are you',
            '—Å–ø–∞—Å–∏–±–æ': 'thank you',
            '–ø–æ–∂–∞–ª—É–π—Å—Ç–∞': 'you are welcome',
            '–¥–∞': 'yes',
            '–Ω–µ—Ç': 'no',
            '—Ö–æ—Ä–æ—à–æ': 'good',
            '–ø–ª–æ—Ö–æ': 'bad'
        },
        'en-ru': {
            'hello': '–ø—Ä–∏–≤–µ—Ç',
            'how are you': '–∫–∞–∫ –¥–µ–ª–∞',
            'thank you': '—Å–ø–∞—Å–∏–±–æ',
            'yes': '–¥–∞',
            'no': '–Ω–µ—Ç',
            'good': '—Ö–æ—Ä–æ—à–æ',
            'bad': '–ø–ª–æ—Ö–æ'
        }
    };
    
    const key = `${from}-${to}`;
    const dict = dictionaries[key];
    let result = text;
    
    if (dict) {
        for (const [word, translation] of Object.entries(dict)) {
            const regex = new RegExp(`\\b${word}\\b`, 'gi');
            result = result.replace(regex, translation);
        }
    } else {
        // –ü—Ä–æ—Å—Ç–æ–π –ø—Å–µ–≤–¥–æ–ø–µ—Ä–µ–≤–æ–¥ –¥–ª—è –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤
        result = `[–ü–µ—Ä–µ–≤–æ–¥ ${from} ‚Üí ${to}]: ${text}`;
    }
    
    document.getElementById('output-text').value = result;
}

function swapLanguages() {
    const from = document.getElementById('lang-from');
    const to = document.getElementById('lang-to');
    const temp = from.value;
    from.value = to.value;
    to.value = temp;
    translateText();
}

function speakTranslation() {
    const text = document.getElementById('output-text').value;
    if (!text.trim()) return;
    
    if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = document.getElementById('lang-to').value;
        utterance.rate = 0.9;
        speechSynthesis.speak(utterance);
    }
}

function startVoiceInput() {
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.lang = document.getElementById('lang-from').value;
        recognition.interimResults = false;
        
        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            document.getElementById('input-text').value = transcript;
            translateText();
        };
        
        recognition.start();
    } else {
        alert('–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º');
    }
}

function clearTranslation() {
    document.getElementById('input-text').value = '';
    document.getElementById('output-text').value = '';
    document.getElementById('char-count').textContent = '0';
}

function copyTranslation() {
    const text = document.getElementById('output-text').value;
    if (!text.trim()) return;
    
    navigator.clipboard.writeText(text).then(() => {
        alert('–ü–µ—Ä–µ–≤–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
    });
}

// ====================
// –ß–ê–°–´ –ú–ò–†–ê
// ====================
const timezones = {
    '–ú–æ—Å–∫–≤–∞': 'Europe/Moscow',
    '–õ–æ–Ω–¥–æ–Ω': 'Europe/London',
    '–ù—å—é-–ô–æ—Ä–∫': 'America/New_York',
    '–¢–æ–∫–∏–æ': 'Asia/Tokyo',
    '–î—É–±–∞–π': 'Asia/Dubai',
    '–°–∏–¥–Ω–µ–π': 'Australia/Sydney',
    '–ü–µ–∫–∏–Ω': 'Asia/Shanghai',
    '–ü–∞—Ä–∏–∂': 'Europe/Paris',
    '–ë–µ—Ä–ª–∏–Ω': 'Europe/Berlin',
    '–¢–æ—Ä–æ–Ω—Ç–æ': 'America/Toronto'
};

function initWorldClocks() {
    const grid = document.getElementById('clocks-grid');
    grid.innerHTML = '';
    
    Object.keys(timezones).forEach(city => {
        const clock = document.createElement('div');
        clock.className = 'clock';
        clock.innerHTML = `
            <div class="clock-city">${city}</div>
            <div class="clock-time" id="clock-${city}">00:00:00</div>
            <div class="clock-date" id="date-${city}">1 —è–Ω–≤–∞—Ä—è 2024</div>
        `;
        grid.appendChild(clock);
    });
    
    updateClocks();
    setInterval(updateClocks, 1000);
}

function updateClocks() {
    const now = new Date();
    
    Object.keys(timezones).forEach(city => {
        try {
            const timeString = now.toLocaleTimeString('ru-RU', { 
                timeZone: timezones[city],
                hour12: false 
            });
            
            const dateString = now.toLocaleDateString('ru-RU', { 
                timeZone: timezones[city],
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            document.getElementById(`clock-${city}`).textContent = timeString;
            document.getElementById(`date-${city}`).textContent = dateString;
        } catch (e) {
            document.getElementById(`clock-${city}`).textContent = now.toLocaleTimeString();
            document.getElementById(`date-${city}`).textContent = now.toLocaleDateString();
        }
    });
}

// ====================
// –ß–ê–¢
// ====================
function loadChat() {
    const usersList = document.getElementById('chat-users');
    usersList.innerHTML = `
        <div class="chat-user active" onclick="switchChat('general')">
            <div style="font-weight: 700;">üí¨ –û–±—â–∏–π —á–∞—Ç</div>
            <div style="font-size: 13px; opacity: 0.7;">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
        </div>
    `;
    
    USERS.forEach(user => {
        if (user !== currentUser) {
            const isOnline = appData.online[user];
            const userDiv = document.createElement('div');
            userDiv.className = 'chat-user';
            userDiv.onclick = () => switchChat(user);
            userDiv.innerHTML = `
                <div style="font-weight: 700; display: flex; align-items: center; gap: 8px;">
                    <span>üë§</span>
                    <span>${user}</span>
                    <span style="font-size: 10px; color: ${isOnline ? '#10b981' : '#ef4444'}">‚óè</span>
                </div>
                <div style="font-size: 12px; opacity: 0.7;">${isOnline ? 'üü¢ –û–Ω–ª–∞–π–Ω' : '‚ö´ –û—Ñ–ª–∞–π–Ω'}</div>
            `;
            usersList.appendChild(userDiv);
        }
    });
    
    switchChat('general');
}

function switchChat(user) {
    currentChat = user;
    
    document.querySelectorAll('.chat-user').forEach(el => el.classList.remove('active'));
    event.target.closest('.chat-user').classList.add('active');
    
    document.getElementById('chat-title').textContent = user === 'general' ? 'üí¨ –û–±—â–∏–π —á–∞—Ç' : `üë§ –õ–∏—á–Ω—ã–π —á–∞—Ç —Å ${user}`;
    
    showMessages();
}

function showMessages() {
    const list = document.getElementById('messages-list');
    const messages = chatMessages[currentChat] || [];
    
    if (messages.length === 0) {
        list.innerHTML = `
            <div style="text-align: center; padding: 40px; opacity: 0.7;">
                <div style="font-size: 48px; margin-bottom: 20px;">üí¨</div>
                <div style="font-size: 18px; margin-bottom: 10px;">–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                <div>–ù–∞–ø–∏—à–∏—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!</div>
            </div>
        `;
        return;
    }
    
    list.innerHTML = messages.map(msg => `
        <div class="message ${msg.sender === currentUser ? 'sent' : 'received'}">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                <div style="font-weight: 700;">${msg.sender}</div>
                <div style="font-size: 12px; opacity: 0.7;">${msg.time}</div>
            </div>
            <div style="line-height: 1.5;">${msg.text}</div>
        </div>
    `).join('');
    
    list.scrollTop = list.scrollHeight;
}

function sendMessage() {
    const input = document.getElementById('chat-message');
    const text = input.value.trim();
    
    if (!text) return;
    
    const message = {
        sender: currentUser,
        text: text,
        time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
    };
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    if (!chatMessages[currentChat]) {
        chatMessages[currentChat] = [];
    }
    chatMessages[currentChat].push(message);
    
    // –ï—Å–ª–∏ –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    if (currentChat !== 'general' && appData.online[currentChat]) {
        addNotification(currentChat, '–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', `${currentUser}: ${text}`, 'message');
    }
    
    // –û–±—â–∏–π —á–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –≤—Å–µ—Ö
    if (currentChat === 'general') {
        appData.chat.push(message);
        saveData();
    }
    
    input.value = '';
    showMessages();
}

// ====================
// –ö–ê–†–¢–´
// ====================
function loadMap() {
    const container = document.getElementById('map-container');
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º OpenStreetMap –±–µ–∑ API –∫–ª—é—á–∞
    container.innerHTML = `
        <div style="width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center;">
            <div style="font-size: 64px; margin-bottom: 30px;">üó∫Ô∏è</div>
            <h3 style="font-size: 28px; margin-bottom: 20px; font-weight: 800;">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç—ã</h3>
            <p style="opacity: 0.8; margin-bottom: 40px; font-size: 18px; line-height: 1.6;">
                –î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.<br>
                –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.
            </p>
            
            <div class="map-controls">
                <button class="map-btn" onclick="showCoordinates('–ú–æ—Å–∫–≤–∞', 55.7558, 37.6173)">üìç –ú–æ—Å–∫–≤–∞</button>
                <button class="map-btn" onclick="showCoordinates('–î—É–±–∞–π', 25.2048, 55.2708)">üìç –î—É–±–∞–π</button>
                <button class="map-btn" onclick="showCoordinates('–ü–∞—Ä–∏–∂', 48.8566, 2.3522)">üìç –ü–∞—Ä–∏–∂</button>
                <button class="map-btn" onclick="showCoordinates('–¢–æ–∫–∏–æ', 35.6762, 139.6503)">üìç –¢–æ–∫–∏–æ</button>
            </div>
            
            <div style="margin-top: 40px; padding: 25px; background: var(--card); border-radius: 15px; max-width: 600px;">
                <h4 style="margin-bottom: 15px; font-size: 20px; font-weight: 700;">–ë—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è</h4>
                <p style="opacity: 0.8; margin-bottom: 20px;">
                    –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ Google Maps –∏–ª–∏ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã
                </p>
                <div id="coordinates-display" style="font-family: 'Courier New', monospace; padding: 15px; background: var(--bg); border-radius: 10px; font-size: 16px;">
                    –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
                </div>
            </div>
        </div>
    `;
}

function showCoordinates(city, lat, lon) {
    const display = document.getElementById('coordinates-display');
    display.innerHTML = `
        <div style="font-weight: 700; margin-bottom: 10px;">üìç ${city}</div>
        <div>–®–∏—Ä–æ—Ç–∞: <span style="color: var(--accent);">${lat.toFixed(4)}¬∞</span></div>
        <div>–î–æ–ª–≥–æ—Ç–∞: <span style="color: var(--accent);">${lon.toFixed(4)}¬∞</span></div>
        <div style="margin-top: 15px; display: flex; gap: 10px;">
            <button class="voice-btn" onclick="copyToClipboard('${lat}, ${lon}')" style="padding: 8px 15px; font-size: 14px;">
                üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
            </button>
            <button class="voice-btn" onclick="openInMaps(${lat}, ${lon})" style="padding: 8px 15px; font-size: 14px; background: var(--success);">
                üó∫Ô∏è –û—Ç–∫—Ä—ã—Ç—å –≤ –∫–∞—Ä—Ç–∞—Ö
            </button>
        </div>
    `;
}

function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        alert('–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã: ' + text);
    });
}

function openInMaps(lat, lon) {
    // –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
    window.open(`https://www.google.com/maps?q=${lat},${lon}`, '_blank');
}

// ====================
// –ß–ê–¢-–ë–û–¢
// ====================
function initChatBot() {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π
    const messages = JSON.parse(localStorage.getItem(`chat_bot_${currentUser}`)) || [];
    if (messages.length > 0) {
        const container = document.getElementById('chat-bot-messages');
        container.innerHTML = messages.map(msg => `
            <div class="bot-message ${msg.sender === 'user' ? 'user' : ''}">
                <div style="font-weight: 700; margin-bottom: 5px;">${msg.sender === 'user' ? '–í—ã' : 'ü§ñ –ü–æ–º–æ—â–Ω–∏–∫'}:</div>
                <div>${msg.text}</div>
            </div>
        `).join('');
    }
}

function toggleChatBot() {
    const modal = document.getElementById('chat-bot-modal');
    modal.style.display = modal.style.display === 'flex' ? 'none' : 'flex';
}

function sendBotMessage() {
    const input = document.getElementById('bot-input');
    const text = input.value.trim();
    
    if (!text) return;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    addBotMessage(text, 'user');
    input.value = '';
    
    // –ò–ò –æ—Ç–≤–µ—Ç
    setTimeout(() => {
        const response = generateBotResponse(text);
        addBotMessage(response, 'bot');
    }, 500);
}

function addBotMessage(text, sender) {
    const container = document.getElementById('chat-bot-messages');
    const messageDiv = document.createElement('div');
    messageDiv.className = `bot-message ${sender === 'user' ? 'user' : ''}`;
    messageDiv.innerHTML = `
        <div style="font-weight: 700; margin-bottom: 5px;">${sender === 'user' ? '–í—ã' : 'ü§ñ –ü–æ–º–æ—â–Ω–∏–∫'}:</div>
        <div>${text}</div>
    `;
    
    container.appendChild(messageDiv);
    container.scrollTop = container.scrollHeight;
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
    const history = JSON.parse(localStorage.getItem(`chat_bot_${currentUser}`)) || [];
    history.push({ text, sender, time: new Date().toISOString() });
    localStorage.setItem(`chat_bot_${currentUser}`, JSON.stringify(history));
}

function generateBotResponse(text) {
    const lowerText = text.toLowerCase();
    
    // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
    if (lowerText.includes('–ø—Ä–∏–≤–µ—Ç') || lowerText.includes('–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π') || lowerText.includes('—Ö–∞–π')) {
        return `–ü—Ä–∏–≤–µ—Ç, ${currentUser}! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?`;
    }
    
    // –ò–≥—Ä—ã
    if (lowerText.includes('–∏–≥—Ä–∞') || lowerText.includes('game')) {
        return '–ù–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–≥—Ä—ã: Counter-Strike 1.6, My Talking Tom 2, –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ –∏ –ö–ª–∏–∫–µ—Ä Pro. –í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É –≤ —Ä–∞–∑–¥–µ–ª–µ "–ò–≥—Ä—ã".';
    }
    
    if (lowerText.includes('–∫—Å') || lowerText.includes('counter') || lowerText.includes('—Å—Ç—Ä–µ–ª—è–ª–∫–∞')) {
        return 'Counter-Strike 1.6 - –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —à—É—Ç–µ—Ä —Å –±–æ—Ç–∞–º–∏. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: WASD - –¥–≤–∏–∂–µ–Ω–∏–µ, –ü—Ä–æ–±–µ–ª - —Å—Ç—Ä–µ–ª—å–±–∞, R - –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞, E - –ø–æ–¥–æ–±—Ä–∞—Ç—å –æ—Ä—É–∂–∏–µ.';
    }
    
    if (lowerText.includes('—Ç–æ–º') || lowerText.includes('–ø–∏—Ç–æ–º–µ—Ü') || lowerText.includes('–∫–æ—Ç–∏–∫')) {
        return 'My Talking Tom 2 - –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–∏—Ç–æ–º–µ—Ü. –ö–æ—Ä–º–∏—Ç–µ –µ–≥–æ, –∏–≥—Ä–∞–π—Ç–µ, –ø–æ–∫—É–ø–∞–π—Ç–µ –∫–µ–π—Å—ã —Å –Ω–∞–≥—Ä–∞–¥–∞–º–∏. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –¢–æ–º–∞, —á—Ç–æ–±—ã –ø–æ–≥–ª–∞–¥–∏—Ç—å.';
    }
    
    if (lowerText.includes('–∫—Ä–µ—Å—Ç–∏–∫') || lowerText.includes('–Ω–æ–ª–∏–∫') || lowerText.includes('tic')) {
        return '–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ - –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞. –ú–æ–∂–Ω–æ –∏–≥—Ä–∞—Ç—å –ø—Ä–æ—Ç–∏–≤ –ò–ò –∏–ª–∏ –≤—ã–∑–≤–∞—Ç—å –¥—Ä—É–≥–∞ –Ω–∞ –¥—É—ç–ª—å —á–µ—Ä–µ–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.';
    }
    
    if (lowerText.includes('–∫–ª–∏–∫–µ—Ä') || lowerText.includes('clicker') || lowerText.includes('–¥–µ–Ω—å–≥–∏')) {
        return '–ö–ª–∏–∫–µ—Ä Pro - –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –∫–ª–∏–∫–∞–º–∏, –ø–æ–∫—É–ø–∞–π—Ç–µ —É–ª—É—á—à–µ–Ω–∏—è, —è–π—Ü–∞ —Å –ø–∏—Ç–æ–º—Ü–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—É—Å—Ç—ã. –ü–µ—Ä–µ—Ä–æ–∂–¥–∞–π—Ç–µ—Å—å –¥–ª—è –º–Ω–æ–∂–∏—Ç–µ–ª—è.';
    }
    
    // –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫
    if (lowerText.includes('–ø–µ—Ä–µ–≤–æ–¥') || lowerText.includes('translate') || lowerText.includes('—è–∑—ã–∫')) {
        return '–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 9 —è–∑—ã–∫–æ–≤. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç, –≤—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥/–≤—ã–≤–æ–¥. –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –æ–Ω–ª–∞–π–Ω API.';
    }
    
    // –ß–∞—Å—ã
    if (lowerText.includes('–≤—Ä–µ–º—è') || lowerText.includes('—á–∞—Å—ã') || lowerText.includes('time')) {
        return '–ß–∞—Å—ã –º–∏—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤—Ä–µ–º—è –≤ 10 –≥–æ—Ä–æ–¥–∞—Ö –º–∏—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É.';
    }
    
    // –ß–∞—Ç
    if (lowerText.includes('—á–∞—Ç') || lowerText.includes('—Å–æ–æ–±—â–µ–Ω') || lowerText.includes('message')) {
        return '–í —á–∞—Ç–µ –º–æ–∂–Ω–æ –æ–±—â–∞—Ç—å—Å—è –≤ –æ–±—â–µ–º –∫–∞–Ω–∞–ª–µ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ–Ω–ª–∞–π–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∑–µ–ª–µ–Ω—ã–º.';
    }
    
    // –ö–∞—Ä—Ç—ã
    if (lowerText.includes('–∫–∞—Ä—Ç') || lowerText.includes('map') || lowerText.includes('–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç')) {
        return '–í —Ä–∞–∑–¥–µ–ª–µ –ö–∞—Ä—Ç—ã –≤—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Ö –≤ Google Maps –∏–ª–∏ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç–∞—Ö.';
    }
    
    // –ü–æ–º–æ—â—å
    if (lowerText.includes('–ø–æ–º–æ—â—å') || lowerText.includes('help') || lowerText.includes('–∫–∞–∫')) {
        return '–Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å: –∏–≥—Ä–∞–º–∏, –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–º, —á–∞—Å–∞–º–∏, —á–∞—Ç–æ–º, –∫–∞—Ä—Ç–∞–º–∏. –°–ø—Ä–æ—Å–∏—Ç–µ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å".';
    }
    
    // –ß—Ç–æ —É–º–µ–µ—Ç
    if (lowerText.includes('—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å') || lowerText.includes('–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏')) {
        return '–Ø —É–º–µ—é:\nüéÆ –†–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ–± –∏–≥—Ä–∞—Ö\nüî§ –ü–æ–º–æ—á—å —Å –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–º\nüïê –ü–æ–∫–∞–∑–∞—Ç—å –≤—Ä–µ–º—è –≤ —Ä–∞–∑–Ω—ã—Ö –≥–æ—Ä–æ–¥–∞—Ö\nüí¨ –û–±—ä—è—Å–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É —á–∞—Ç–∞\nüó∫Ô∏è –ü–æ–º–æ—á—å —Å –∫–∞—Ä—Ç–∞–º–∏\n‚öôÔ∏è –†–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö';
    }
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    if (lowerText.includes('–Ω–∞—Å—Ç—Ä–æ–π–∫') || lowerText.includes('settings') || lowerText.includes('—Ç–µ–º–∞')) {
        return '–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º–æ–∂–Ω–æ —Å–º–µ–Ω–∏—Ç—å —Ç–µ–º—É (—Ç—ë–º–Ω–∞—è, —Å–≤–µ—Ç–ª–∞—è, —Ñ–∏–æ–ª–µ—Ç–æ–≤–∞—è), –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —Å–Ω–µ–≥, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å/–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ.';
    }
    
    // –ü—Ä–æ—â–∞–Ω–∏–µ
    if (lowerText.includes('–ø–æ–∫–∞') || lowerText.includes('–¥–æ —Å–≤–∏–¥–∞–Ω') || lowerText.includes('bye')) {
        return `–î–æ —Å–≤–∏–¥–∞–Ω–∏—è, ${currentUser}! –í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –µ—â—ë.`;
    }
    
    // –°–ø–∞—Å–∏–±–æ
    if (lowerText.includes('—Å–ø–∞—Å–∏–±–æ') || lowerText.includes('–±–ª–∞–≥–æ–¥–∞—Ä—é')) {
        return '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –†–∞–¥ –±—ã–ª –ø–æ–º–æ—á—å. –ï—Å—Ç—å –µ—â—ë –≤–æ–ø—Ä–æ—Å—ã?';
    }
    
    // –î–µ—Ñ–æ–ª—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç
    const responses = [
        '–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –ú–æ–≥—É –ª–∏ —è –ø–æ–º–æ—á—å –≤–∞–º —Å –∏–≥—Ä–∞–º–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã?',
        '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–ø—Ä–æ—Å–∏—Ç—å –æ –∏–≥—Ä–∞—Ö, –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–µ –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.',
        '–ù–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª –≤–æ–ø—Ä–æ—Å. –í—ã –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ—Å–∏—Ç—å –æ: –∏–≥—Ä–∞—Ö, –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–µ, —á–∞—Å–∞—Ö, —á–∞—Ç–µ, –∫–∞—Ä—Ç–∞—Ö –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.',
        `–Ø –≤–∞—à –ø–æ–º–æ—â–Ω–∏–∫ –Ω–∞ –∏–≥—Ä–æ–≤–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ, ${currentUser}. –ß–µ–º –º–æ–≥—É –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω?`,
        '–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å, –Ω–∞–ø–∏—à–∏—Ç–µ "–ø–æ–º–æ—â—å" –∏–ª–∏ "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å".'
    ];
    
    return responses[Math.floor(Math.random() * responses.length)];
}

// ====================
// –ù–ê–°–¢–†–û–ô–ö–ò
// ====================
function openSettings() {
    showModal('settings-modal');
}

function setTheme(theme) {
    document.body.setAttribute('data-theme', theme);
    appData.settings.theme = theme;
    saveData();
    
    document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–Ω–µ–∂–∏–Ω–∫–∏
    const snowToggle = document.getElementById('snow-toggle');
    if (theme === 'light') {
        snowToggle.checked = false;
        snowToggle.disabled = true;
        document.querySelectorAll('.snowflake').forEach(s => s.remove());
    } else {
        snowToggle.disabled = false;
        if (snowToggle.checked) {
            createSnowflakes();
        }
    }
}

function exportData() {
    const data = JSON.stringify(appData, null, 2);
    const blob = new Blob([data], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    
    const a = document.createElement('a');
    a.href = url;
    a.download = `platform_backup_${currentUser}_${Date.now()}.json`;
    a.click();
    
    alert('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ–∞–π–ª!');
}

function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'application/json';
    
    input.onchange = (e) => {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = (e) => {
            try {
                const data = JSON.parse(e.target.result);
                Object.assign(appData, data);
                saveData();
                alert('–î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã! –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                location.reload();
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ: ' + error.message);
            }
        };
        
        reader.readAsText(file);
    };
    
    input.click();
}

function clearData() {
    if (confirm('–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
        localStorage.clear();
        alert('–í—Å–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è.');
        location.reload();
    }
}

// ====================
// –£–¢–ò–õ–ò–¢–´
// ====================
function showModal(id) {
    document.getElementById(id).style.display = 'flex';
}

function closeModal(id) {
    document.getElementById(id).style.display = 'none';
}

function saveData() {
    localStorage.setItem('platform_data', JSON.stringify(appData));
}

function setupEventListeners() {
    // –°–Ω–µ–∂–∏–Ω–∫–∏
    document.getElementById('snow-toggle').addEventListener('change', (e) => {
        appData.settings.snow = e.target.checked;
        saveData();
        
        if (e.target.checked) {
            createSnowflakes();
        } else {
            document.querySelectorAll('.snowflake').forEach(s => s.remove());
        }
    });
    
    // –ß–∞—Ç
    document.getElementById('chat-message').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
    });
    
    // –ß–∞—Ç-–±–æ—Ç
    document.getElementById('bot-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendBotMessage();
    });
    
    // –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫
    document.getElementById('input-text').addEventListener('input', translateText);
}

// ====================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
// ====================
window.addEventListener('load', () => {
    initUserSelection();
    
    // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—Å—Ç–∞—Ä—à–µ 1 –¥–Ω—è)
    const now = Date.now();
    appData.notifications = (appData.notifications || []).filter(n => 
        now - n.timestamp < 24 * 60 * 60 * 1000
    );
    
    // –û—á–∏—â–∞–µ–º –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ (—Å—Ç–∞—Ä—à–µ 10 –º–∏–Ω—É—Ç)
    Object.keys(appData.online || {}).forEach(user => {
        if (now - appData.online[user] > 10 * 60 * 1000) {
            delete appData.online[user];
        }
    });
    
    saveData();
    
    // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    setInterval(saveData, 30000);
});
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ULTRA HUB: EVOLUTION 2.1</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        :root {
            --p: #00f2ff;
            --s: #ff00ff;
            --bg: #050505;
            --card: rgba(255, 255, 255, 0.08);
            --text: #fff;
            --border: rgba(0, 242, 255, 0.3);
        }
        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', sans-serif;
            height: 100vh;
            overflow: hidden;
            transition: background 0.5s;
        }
        body.mobile { font-size: 18px; }

        /* –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è */
        #auth-overlay {
            position: fixed; 
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, #000 0%, #0a0a2a 100%);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }
        .auth-card {
            background: var(--card);
            padding: 30px;
            border-radius: 20px;
            border: 2px solid var(--p);
            text-align: center;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 0 30px var(--p);
        }
        
        .auth-card select,
        .auth-card input,
        .auth-btn {
            width: 100%;
            padding: 14px;
            margin: 10px 0;
            border-radius: 12px;
            border: 2px solid var(--p);
            background: rgba(0,0,0,0.7);
            color: var(--text);
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .auth-btn {
            background: linear-gradient(45deg, var(--p), var(--s));
            color: #000;
            cursor: pointer;
            margin-top: 20px;
            border: none;
        }
        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 242, 255, 0.4);
        }
        
        /* UI */
        .btn {
            padding: 10px 15px;
            border-radius: 10px;
            border: 2px solid var(--p);
            background: rgba(0,0,0,0.5);
            color: var(--text);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn:hover {
            background: var(--p);
            color: #000;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        #main-content { 
            display: none; 
            height: 100vh; 
            flex-direction: column; 
        }
        nav {
            display: flex;
            gap: 5px;
            padding: 10px;
            background: rgba(0,0,0,0.9);
            border-bottom: 2px solid var(--p);
            overflow-x: auto;
            position: sticky;
            top: 0;
            z-index: 100;
            flex-wrap: wrap;
        }
        nav button {
            background: transparent;
            border: 2px solid var(--p);
            color: var(--p);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 11px;
            white-space: nowrap;
            cursor: pointer;
        }
        nav button.active {
            background: var(--p);
            color: #000;
        }

        /* –°–µ–∫—Ü–∏–∏ */
        section {
            display: none;
            padding: 15px;
            height: calc(100vh - 60px);
            overflow-y: auto;
            text-align: center;
        }
        section.active {
            display: block;
        }

        .card {
            background: var(--card);
            padding: 15px;
            border-radius: 15px;
            border: 1px solid var(--border);
            margin-bottom: 15px;
        }

        /* –ú–ê–ô–ù–ï–† (—Ç–æ–ª—å–∫–æ –∫–ª–∏–∫–µ—Ä) */
        #core {
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, var(--p) 0%, transparent 70%);
            border-radius: 50%;
            border: 3px solid #fff;
            margin: 20px auto;
            cursor: pointer;
            transition: all 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
        }

        /* –¢–û–ú 2 - —Ç–æ—á–Ω–∞—è –∫–æ–ø–∏—è */
        #tom2-container {
            max-width: 400px;
            margin: 0 auto;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 20px;
            position: relative;
            border: 3px solid #ff6b6b;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        #tom2-character {
            width: 200px;
            height: 200px;
            background: #f8c291;
            border-radius: 50%;
            margin: 20px auto;
            position: relative;
            border: 5px solid #e55039;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.2);
        }
        
        .tom2-eye {
            position: absolute;
            width: 30px;
            height: 40px;
            background: white;
            border-radius: 50%;
            top: 60px;
        }
        .tom2-eye.left { left: 50px; }
        .tom2-eye.right { right: 50px; }
        .tom2-pupil {
            position: absolute;
            width: 15px;
            height: 15px;
            background: black;
            border-radius: 50%;
            top: 12px;
            left: 7px;
        }
        
        .tom2-ear {
            position: absolute;
            width: 40px;
            height: 60px;
            background: #f8c291;
            border-radius: 50%;
            top: -30px;
        }
        .tom2-ear.left { left: 40px; transform: rotate(-20deg); }
        .tom2-ear.right { right: 40px; transform: rotate(20deg); }
        
        .tom2-mouth {
            position: absolute;
            width: 60px;
            height: 30px;
            background: #e55039;
            border-radius: 0 0 30px 30px;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        #tom2-message {
            background: white;
            padding: 10px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px solid #ff6b6b;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #333;
        }
        
        .tom2-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .tom2-btn {
            padding: 12px;
            border: none;
            border-radius: 10px;
            background: #ff6b6b;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .tom2-btn:hover {
            transform: scale(1.05);
            background: #ff5252;
        }
        
        .tom2-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .tom2-stat {
            background: rgba(255,255,255,0.9);
            padding: 10px;
            border-radius: 10px;
            border: 2px solid #4ecdc4;
        }
        
        .tom2-stat-bar {
            height: 10px;
            background: #ddd;
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .tom2-stat-fill {
            height: 100%;
            background: #4ecdc4;
            width: 100%;
            transition: width 0.5s;
        }

        /* –Ø–ô–¶–ê */
        .egg-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .egg-item {
            padding: 15px;
            border-radius: 15px;
            border: 3px solid;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .egg-item:hover {
            transform: scale(1.05);
        }
        
        .egg-common { border-color: #bdc3c7; background: #2c3e50; }
        .egg-rare { border-color: #00ff00; background: #004d00; }
        .egg-epic { border-color: #9b59b6; background: #3d0059; }
        .egg-mythic { border-color: #e74c3c; background: #5d0000; }
        .egg-legendary { border-color: #f1c40f; background: #5d4d00; }
        .egg-secret { border-color: #ffffff; background: #666; }
        .egg-god { border-color: #00ffff; background: #003333; }
        
        .egg-price {
            font-size: 18px;
            font-weight: bold;
            color: gold;
            margin: 10px 0;
        }

        /* –ü–ò–¢–û–ú–¶–´ */
        .pet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        
        .pet-card {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
            border: 1px solid var(--p);
        }
        
        .pet-emoji {
            font-size: 40px;
            margin-bottom: 5px;
        }

        /* –ü–ï–†–ï–†–û–ñ–î–ï–ù–ò–Ø */
        .prestige-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid gold;
        }
        
        .prestige-cost {
            font-size: 24px;
            color: gold;
            font-weight: bold;
            margin: 10px 0;
        }

        /* –û–î–ï–ñ–î–ê (–≤ –¢–∞–º–µ–≥–æ—á–∏) */
        .clothing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        
        .clothing-item {
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .clothing-item:hover {
            background: rgba(255,255,255,0.2);
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .auth-card { padding: 20px; }
            nav button { font-size: 10px; padding: 6px 10px; }
            section { padding: 10px; }
            #tom2-character { width: 150px; height: 150px; }
            .tom2-eye { top: 45px; }
            .tom2-eye.left { left: 40px; }
            .tom2-eye.right { right: 40px; }
        }
    </style>
</head>
<body>

<!-- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è -->
<div id="auth-overlay">
    <div class="auth-card">
        <h2 style="color:var(--p); margin-bottom: 20px;">üîê –í–•–û–î –í –°–ò–°–¢–ï–ú–£</h2>
        
        <select id="user-select">
            <option value="–ù–∏–∫–∏—Ç–∞">–ù–∏–∫–∏—Ç–∞ [ADMIN]</option>
            <option value="–ê–ª–µ–Ω–∞">–ê–ª–µ–Ω–∞</option>
            <option value="–°–∞—à–∞">–°–∞—à–∞</option>
            <option value="–ê–ª–∏—Å–∞">–ê–ª–∏—Å–∞</option>
        </select>
        
        <select id="device-select">
            <option value="pc">üñ•Ô∏è –ö–æ–º–ø—å—é—Ç–µ—Ä</option>
            <option value="mobile">üì± –°–º–∞—Ä—Ç—Ñ–æ–Ω</option>
        </select>
        
        <input type="password" id="password-input" placeholder="–í–í–ï–î–ò–¢–ï –õ–Æ–ë–û–ô –ü–ê–†–û–õ–¨" autocomplete="off">
        
        <button class="auth-btn" onclick="identify()">
            üîì –í–û–ô–¢–ò
        </button>
    </div>
</div>

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
<div id="main-content">
    <nav>
        <button onclick="switchTab('home')" class="active">üè† –ì–õ–ê–í–ù–ê–Ø</button>
        <button onclick="switchTab('tom2')">üò∏ –¢–û–ú 2</button>
        <button onclick="switchTab('miner')">‚õèÔ∏è –ú–ê–ô–ù–ï–†</button>
        <button onclick="switchTab('eggs')">ü•ö –Ø–ô–¶–ê</button>
        <button onclick="switchTab('pets')">üé™ –ü–ò–¢–û–ú–¶–´</button>
        <button onclick="switchTab('prestige')">üîÑ –ü–ï–†–ï–†–û–ñ–î–ï–ù–ò–Ø</button>
        <button onclick="switchTab('map')">üó∫Ô∏è –ö–ê–†–¢–ê</button>
        <button onclick="switchTab('chat')">üí¨ –ß–ê–¢</button>
        <button onclick="switchTab('exit')">üö™ –í–´–•–û–î</button>
    </nav>

    <!-- –ì–ª–∞–≤–Ω–∞—è -->
    <section id="home" class="active">
        <div class="card">
            <h1 id="clock" style="font-size: 2.5rem; margin:0; text-shadow: 0 0 10px var(--p);">00:00:00</h1>
            <p id="user-tag" style="color:var(--p); font-size: 1rem; margin: 10px 0;"></p>
            <div style="margin-top: 20px;">
                <h3>üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê</h3>
                <p>üí∞ –ë–∞–ª–∞–Ω—Å: <span id="balance-display">0</span> BYTES</p>
                <p>üé™ –ü–∏—Ç–æ–º—Ü–µ–≤: <span id="pets-count">0</span></p>
                <p>üîÑ –ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–π: <span id="rebirth-count">0</span></p>
                <p>‚ö° –ú–Ω–æ–∂–∏—Ç–µ–ª—å: <span id="multiplier">1x</span></p>
                <p>ü•ö –Ø–∏—Ü –æ—Ç–∫—Ä—ã—Ç–æ: <span id="eggs-opened">0</span></p>
            </div>
        </div>
    </section>

    <!-- –¢–û–ú 2 (–ø–æ–ª–Ω–∞—è –∫–æ–ø–∏—è —Å –º–∞–≥–∞–∑–∏–Ω–æ–º –æ–¥–µ–∂–¥—ã) -->
    <section id="tom2">
        <div class="card">
            <h2 style="color:#ff6b6b; margin-bottom: 20px;">üò∏ –¢–û–ú 2</h2>
            
            <div id="tom2-container">
                <div id="tom2-character">
                    <div class="tom2-ear left"></div>
                    <div class="tom2-ear right"></div>
                    
                    <div class="tom2-eye left">
                        <div class="tom2-pupil"></div>
                    </div>
                    <div class="tom2-eye right">
                        <div class="tom2-pupil"></div>
                    </div>
                    
                    <div class="tom2-mouth"></div>
                    
                    <!-- –û–¥–µ–∂–¥–∞ -->
                    <div id="tom2-clothing" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
                        <!-- –û–¥–µ–∂–¥–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
                    </div>
                </div>
                
                <div id="tom2-message">
                    –ü—Ä–∏–≤–µ—Ç! –Ø –¢–æ–º!
                </div>
                
                <div class="tom2-stats">
                    <div class="tom2-stat">
                        <div>üçï –ì–æ–ª–æ–¥</div>
                        <div class="tom2-stat-bar">
                            <div id="tom2-hunger-bar" class="tom2-stat-fill" style="width: 100%; background: #4ecdc4;"></div>
                        </div>
                        <div id="tom2-hunger-value">100%</div>
                    </div>
                    
                    <div class="tom2-stat">
                        <div>üí§ –≠–Ω–µ—Ä–≥–∏—è</div>
                        <div class="tom2-stat-bar">
                            <div id="tom2-energy-bar" class="tom2-stat-fill" style="width: 100%; background: #ffd32a;"></div>
                        </div>
                        <div id="tom2-energy-value">100%</div>
                    </div>
                    
                    <div class="tom2-stat">
                        <div>üòä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</div>
                        <div class="tom2-stat-bar">
                            <div id="tom2-mood-bar" class="tom2-stat-fill" style="width: 100%; background: #ff6b6b;"></div>
                        </div>
                        <div id="tom2-mood-value">100%</div>
                    </div>
                    
                    <div class="tom2-stat">
                        <div>‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ</div>
                        <div class="tom2-stat-bar">
                            <div id="tom2-health-bar" class="tom2-stat-fill" style="width: 100%; background: #1dd1a1;"></div>
                        </div>
                        <div id="tom2-health-value">100%</div>
                    </div>
                </div>
                
                <div class="tom2-buttons">
                    <button class="tom2-btn" onclick="tom2Action('feed')">üçï –ö–û–†–ú–ò–¢–¨</button>
                    <button class="tom2-btn" onclick="tom2Action('sleep')">üò¥ –°–ü–ê–¢–¨</button>
                    <button class="tom2-btn" onclick="tom2Action('play')">‚öΩ –ò–ì–†–ê–¢–¨</button>
                    <button class="tom2-btn" onclick="tom2Action('clean')">üõÅ –ú–´–¢–¨</button>
                    <button class="tom2-btn" onclick="tom2Action('heal')">üíä –õ–ï–ß–ò–¢–¨</button>
                    <button class="tom2-btn" onclick="tom2Action('pet')">‚ù§Ô∏è –ì–õ–ê–î–ò–¢–¨</button>
                </div>
            </div>
            
            <!-- –ú–∞–≥–∞–∑–∏–Ω –æ–¥–µ–∂–¥—ã –¥–ª—è –¢–æ–º–∞ 2 -->
            <div style="margin-top: 30px;">
                <h3>üëï –ú–ê–ì–ê–ó–ò–ù –û–î–ï–ñ–î–´ –î–õ–Ø –¢–û–ú–ê</h3>
                <p>–í–∞—à–∏ BYTES: <span id="clothing-balance">0</span></p>
                
                <div class="clothing-grid" id="clothing-store">
                    <div class="clothing-item" onclick="buyClothing('hat', 1000)">
                        <div style="font-size: 40px;">üé©</div>
                        <div>–®–ª—è–ø–∞</div>
                        <div>1000 BYTES</div>
                    </div>
                    
                    <div class="clothing-item" onclick="buyClothing('glasses', 2000)">
                        <div style="font-size: 40px;">üëì</div>
                        <div>–û—á–∫–∏</div>
                        <div>2000 BYTES</div>
                    </div>
                    
                    <div class="clothing-item" onclick="buyClothing('tie', 1500)">
                        <div style="font-size: 40px;">üëî</div>
                        <div>–ì–∞–ª—Å—Ç—É–∫</div>
                        <div>1500 BYTES</div>
                    </div>
                    
                    <div class="clothing-item" onclick="buyClothing('cape', 5000)">
                        <div style="font-size: 40px;">üß•</div>
                        <div>–ü–ª–∞—â</div>
                        <div>5000 BYTES</div>
                    </div>
                    
                    <div class="clothing-item" onclick="buyClothing('crown', 10000)">
                        <div style="font-size: 40px;">üëë</div>
                        <div>–ö–æ—Ä–æ–Ω–∞</div>
                        <div>10000 BYTES</div>
                    </div>
                    
                    <div class="clothing-item" onclick="buyClothing('armor', 20000)">
                        <div style="font-size: 40px;">üõ°Ô∏è</div>
                        <div>–ë—Ä–æ–Ω—è</div>
                        <div>20000 BYTES</div>
                    </div>
                </div>
                
                <h4 style="margin-top: 20px;">üé™ –í–∞—à–∞ –æ–¥–µ–∂–¥–∞:</h4>
                <div class="clothing-grid" id="owned-clothing">
                    <!-- –ö—É–ø–ª–µ–Ω–Ω–∞—è –æ–¥–µ–∂–¥–∞ -->
                </div>
            </div>
        </div>
    </section>

    <!-- –ú–ê–ô–ù–ï–† (—Ç–æ–ª—å–∫–æ –∫–ª–∏–∫–µ—Ä) -->
    <section id="miner">
        <div class="card">
            <h2 style="color:var(--p);">‚õèÔ∏è –ú–ê–ô–ù–ï–†</h2>
            <p style="font-size: 24px; margin: 20px 0;">üí∞ <span id="miner-balance">0</span> BYTES</p>
            <p>‚ö° –ú–Ω–æ–∂–∏—Ç–µ–ª—å: <span id="miner-multiplier">1x</span></p>
            
            <div id="core" onclick="clickMiner()">
                –ö–õ–ò–ö–ù–ò!
            </div>
            
            <p style="margin: 15px 0;">–ù–∞–∂–∏–º–∞–π –Ω–∞ —è–¥—Ä–æ –¥–ª—è –¥–æ–±—ã—á–∏ BYTES!</p>
            
            <div style="margin-top: 20px;">
                <h4>‚ö° –£–ª—É—á—à–µ–Ω–∏—è:</h4>
                <button class="btn" onclick="buyUpgrade('click_power')" style="margin: 5px;">
                    üí™ –°–∏–ª–∞ –∫–ª–∏–∫–∞ (1000 BYTES)
                </button>
                <button class="btn" onclick="buyUpgrade('auto_clicker')" style="margin: 5px;">
                    ü§ñ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä (5000 BYTES)
                </button>
            </div>
        </div>
    </section>

    <!-- –Ø–ô–¶–ê -->
    <section id="eggs">
        <div class="card">
            <h2>ü•ö –ú–ê–ì–ê–ó–ò–ù –Ø–ò–¶</h2>
            <p>–í–∞—à–∏ BYTES: <span id="egg-balance">0</span></p>
            <p>–û—Ç–∫—Ä—ã—Ç–æ —è–∏—Ü: <span id="total-eggs">0</span></p>
            
            <div class="egg-grid">
                <div class="egg-item egg-common" onclick="buyEgg('common')">
                    <div style="font-size: 50px;">ü•ö</div>
                    <h3>–û–±—ã—á–Ω–æ–µ —è–π—Ü–æ</h3>
                    <div class="egg-price">100 BYTES</div>
                    <p style="font-size: 12px;">–®–∞–Ω—Å: –æ–±—ã—á–Ω—ã–π 80%, —Ä–µ–¥–∫–∏–π 15%</p>
                </div>
                
                <div class="egg-item egg-rare" onclick="buyEgg('rare')">
                    <div style="font-size: 50px;">üîµ</div>
                    <h3>–†–µ–¥–∫–æ–µ —è–π—Ü–æ</h3>
                    <div class="egg-price">500 BYTES</div>
                    <p style="font-size: 12px;">–®–∞–Ω—Å: —Ä–µ–¥–∫–∏–π 70%, —ç–ø–∏—á–µ—Å–∫–∏–π 25%</p>
                </div>
                
                <div class="egg-item egg-epic" onclick="buyEgg('epic')">
                    <div style="font-size: 50px;">üíú</div>
                    <h3>–≠–ø–∏—á–µ—Å–∫–æ–µ —è–π—Ü–æ</h3>
                    <div class="egg-price">2,000 BYTES</div>
                    <p style="font-size: 12px;">–®–∞–Ω—Å: —ç–ø–∏—á–µ—Å–∫–∏–π 65%, –º–∏—Ñ–∏—á–µ—Å–∫–∏–π 30%</p>
                </div>
                
                <div class="egg-item egg-mythic" onclick="buyEgg('mythic')">
                    <div style="font-size: 50px;">üü†</div>
                    <h3>–ú–∏—Ñ–∏—á–µ—Å–∫–æ–µ —è–π—Ü–æ</h3>
                    <div class="egg-price">10,000 BYTES</div>
                    <p style="font-size: 12px;">–®–∞–Ω—Å: –º–∏—Ñ–∏—á–µ—Å–∫–∏–π 60%, –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π 35%</p>
                </div>
                
                <div class="egg-item egg-legendary" onclick="buyEgg('legendary')">
                    <div style="font-size: 50px;">‚≠ê</div>
                    <h3>–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ —è–π—Ü–æ</h3>
                    <div class="egg-price">50,000 BYTES</div>
                    <p style="font-size: 12px;">–®–∞–Ω—Å: –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π 70%, —Å–µ–∫—Ä–µ—Ç–Ω–æ–µ 25%</p>
                </div>
                
                <div class="egg-item egg-secret" onclick="buyEgg('secret')">
                    <div style="font-size: 50px;">üëÅÔ∏è</div>
                    <h3>–°–µ–∫—Ä–µ—Ç–Ω–æ–µ —è–π—Ü–æ</h3>
                    <div class="egg-price">250,000 BYTES</div>
                    <p style="font-size: 12px;">–®–∞–Ω—Å: —Å–µ–∫—Ä–µ—Ç–Ω–æ–µ 85%, –±–æ–≥ 15%</p>
                </div>
                
                <div class="egg-item egg-god" onclick="buyEgg('god')">
                    <div style="font-size: 50px;">üëë</div>
                    <h3>–ë–û–ì –Ø–ô–¶–û</h3>
                    <div class="egg-price">1,000,000 BYTES</div>
                    <p style="font-size: 12px;">–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ: –±–æ–≥-–ø–∏—Ç–æ–º–µ—Ü</p>
                </div>
            </div>
            
            <div id="egg-result" style="margin-top: 20px; padding: 15px; background: rgba(0,255,0,0.1); border-radius: 10px; display: none;"></div>
        </div>
    </section>

    <!-- –ü–ò–¢–û–ú–¶–´ -->
    <section id="pets">
        <div class="card">
            <h2>üé™ –í–ê–®–ò –ü–ò–¢–û–ú–¶–´</h2>
            <p>–í—Å–µ–≥–æ –ø–∏—Ç–æ–º—Ü–µ–≤: <span id="total-pets-display">0</span></p>
            <p>–ê–∫—Ç–∏–≤–Ω—ã–µ –±–æ–Ω—É—Å—ã: +<span id="pet-bonus">0</span>x –∫ –º–Ω–æ–∂–∏—Ç–µ–ª—é</p>
            
            <div class="pet-grid" id="pets-container">
                <!-- –ü–∏—Ç–æ–º—Ü—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
            
            <div style="margin-top: 20px;">
                <button class="btn" onclick="activateAllPets()" style="margin: 5px;">
                    ‚ö° –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ—Ö
                </button>
                <button class="btn" onclick="petFusion()" style="margin: 5px;">
                    üîÆ –°–ª–∏—è–Ω–∏–µ (2 –ø–∏—Ç–æ–º—Ü–∞ ‚Üí 1 —É–ª—É—á—à–µ–Ω–Ω—ã–π)
                </button>
            </div>
        </div>
    </section>

    <!-- –ü–ï–†–ï–†–û–ñ–î–ï–ù–ò–Ø -->
    <section id="prestige">
        <div class="card">
            <h2>üîÑ –ü–ï–†–ï–†–û–ñ–î–ï–ù–ò–Ø</h2>
            
            <div class="prestige-card">
                <h3>–¢–µ–∫—É—â–µ–µ –ø–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ: <span id="current-prestige">0</span></h3>
                <p>–¢–µ–∫—É—â–∏–π –º–Ω–æ–∂–∏—Ç–µ–ª—å: <span id="current-multiplier">1x</span></p>
                <p>–°–ª–µ–¥—É—é—â–∏–π –º–Ω–æ–∂–∏—Ç–µ–ª—å: <span id="next-multiplier">1.5x</span></p>
                
                <div class="prestige-cost">
                    –°—Ç–æ–∏–º–æ—Å—Ç—å: <span id="prestige-cost-display">10,000</span> BYTES
                </div>
                
                <button class="btn" onclick="doPrestige()" style="background: gold; color: black; font-size: 18px; padding: 15px;">
                    üîÑ –ü–ï–†–ï–†–û–î–ò–¢–¨–°–Ø
                </button>
                
                <p style="margin-top: 15px; font-size: 14px;">
                    –ü—Ä–∏ –ø–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–∏ –≤—ã —Ç–µ—Ä—è–µ—Ç–µ –≤—Å–µ BYTES, –Ω–æ –ø–æ–ª—É—á–∞–µ—Ç–µ +0.5x –∫ –º–Ω–æ–∂–∏—Ç–µ–ª—é –Ω–∞–≤—Å–µ–≥–¥–∞!
                </p>
            </div>
            
            <div style="margin-top: 20px;">
                <h4>‚ö° –ë–æ–Ω—É—Å—ã –æ—Ç –ø–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–π:</h4>
                <div id="prestige-bonuses">
                    <!-- –ë–æ–Ω—É—Å—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </section>

    <!-- –ö–ê–†–¢–ê -->
    <section id="map">
        <div class="card">
            <h2>üó∫Ô∏è –ö–ê–†–¢–ê</h2>
            <div id="map-container" style="height: 400px; border-radius: 10px; border: 2px solid var(--p);"></div>
            <div style="margin-top: 15px;">
                <button class="btn" onclick="findMyLocation()" style="margin: 5px;">üìç –ú–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</button>
                <button class="btn" onclick="addMapMarker()" style="margin: 5px;">üìå –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–∫—É</button>
            </div>
        </div>
    </section>

    <!-- –ß–ê–¢ -->
    <section id="chat">
        <div class="card">
            <h2>üí¨ –ß–ê–¢</h2>
            <div id="chat-container" style="height: 300px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 10px; padding: 10px; margin-bottom: 10px;"></div>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." style="flex: 1; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.1); color: white; border: 1px solid var(--p);">
                <button class="btn" onclick="sendChatMessage()">üì®</button>
            </div>
        </div>
    </section>

    <!-- –í–´–•–û–î -->
    <section id="exit">
        <div class="card">
            <h2>üö™ –í–´–•–û–î</h2>
            <button class="btn" onclick="logout()" style="margin: 10px; padding: 15px; font-size: 18px;">
                üîì –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
            </button>
            <button class="btn" onclick="exportData()" style="margin: 10px; padding: 15px; font-size: 18px; background: #4CAF50;">
                üíæ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
            </button>
            <button class="btn" onclick="importData()" style="margin: 10px; padding: 15px; font-size: 18px; background: #2196F3;">
                üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
            </button>
            <button class="btn" onclick="fullReset()" style="margin: 10px; padding: 15px; font-size: 18px; background: #f44336;">
                üí£ –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
            </button>
            <input type="file" id="import-file" accept=".json" style="display: none;" onchange="handleFileImport(this.files[0])">
        </div>
    </section>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// ====================
// –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
// ====================
let currentUser = "";
let currentDevice = "";
let map = null;
let markers = [];
let autoClickerInterval = null;

// –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
const petsDatabase = {
    common: [
        { id: 1, name: "–ö–æ—Ç—ë–Ω–æ–∫", emoji: "üê±", bonus: "+0.1x", value: 0.1, rarity: "common" },
        { id: 2, name: "–©–µ–Ω–æ–∫", emoji: "üê∂", bonus: "+0.1x", value: 0.1, rarity: "common" },
        { id: 3, name: "–•–æ–º—è–∫", emoji: "üêπ", bonus: "+0.05x", value: 0.05, rarity: "common" }
    ],
    rare: [
        { id: 4, name: "–õ–∏—Å–∞", emoji: "ü¶ä", bonus: "+0.2x", value: 0.2, rarity: "rare" },
        { id: 5, name: "–ü–∞–Ω–¥–∞", emoji: "üêº", bonus: "+0.15x", value: 0.15, rarity: "rare" }
    ],
    epic: [
        { id: 6, name: "–î—Ä–∞–∫–æ–Ω", emoji: "üê≤", bonus: "+0.5x", value: 0.5, rarity: "epic" },
        { id: 7, name: "–ï–¥–∏–Ω–æ—Ä–æ–≥", emoji: "ü¶Ñ", bonus: "+0.5x", value: 0.5, rarity: "epic" }
    ],
    mythic: [
        { id: 8, name: "–ì—Ä–∏—Ñ–æ–Ω", emoji: "ü¶Ö", bonus: "+1x", value: 1, rarity: "mythic" },
        { id: 9, name: "–î–µ–º–æ–Ω", emoji: "üòà", bonus: "+0.8x", value: 0.8, rarity: "mythic" }
    ],
    legendary: [
        { id: 10, name: "–ê–Ω–≥–µ–ª", emoji: "üëº", bonus: "+2x", value: 2, rarity: "legendary" },
        { id: 11, name: "–¢–∏—Ç–∞–Ω", emoji: "üóø", bonus: "+1.5x", value: 1.5, rarity: "legendary" }
    ],
    secret: [
        { id: 12, name: "–ò–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω–∏–Ω", emoji: "üëΩ", bonus: "+3x", value: 3, rarity: "secret" },
        { id: 13, name: "–†–æ–±–æ—Ç", emoji: "ü§ñ", bonus: "+2.5x", value: 2.5, rarity: "secret" }
    ],
    god: [
        { id: 14, name: "–ë–û–ì-–ö–û–¢", emoji: "üòº‚ö°", bonus: "+5x", value: 5, rarity: "god" },
        { id: 15, name: "–í–°–ï–õ–ï–ù–ù–ê–Ø", emoji: "üåå", bonus: "+5x", value: 5, rarity: "god" }
    ]
};

const clothingItems = {
    hat: { emoji: "üé©", name: "–®–ª—è–ø–∞", price: 1000 },
    glasses: { emoji: "üëì", name: "–û—á–∫–∏", price: 2000 },
    tie: { emoji: "üëî", name: "–ì–∞–ª—Å—Ç—É–∫", price: 1500 },
    cape: { emoji: "üß•", name: "–ü–ª–∞—â", price: 5000 },
    crown: { emoji: "üëë", name: "–ö–æ—Ä–æ–Ω–∞", price: 10000 },
    armor: { emoji: "üõ°Ô∏è", name: "–ë—Ä–æ–Ω—è", price: 20000 }
};

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
let hubData = JSON.parse(localStorage.getItem('hub_data')) || {
    "–ù–∏–∫–∏—Ç–∞": { 
        bytes: 1000, 
        rebirths: 0, 
        eggsOpened: 0,
        pets: [], 
        clothing: [],
        upgrades: { click_power: 1, auto_clicker: false },
        tom2: { hunger: 100, energy: 100, mood: 100, health: 100 }
    },
    "–ê–ª–µ–Ω–∞": { 
        bytes: 500, 
        rebirths: 0, 
        eggsOpened: 0,
        pets: [], 
        clothing: [],
        upgrades: { click_power: 1, auto_clicker: false },
        tom2: { hunger: 100, energy: 100, mood: 100, health: 100 }
    },
    "–°–∞—à–∞": { 
        bytes: 300, 
        rebirths: 0, 
        eggsOpened: 0,
        pets: [], 
        clothing: [],
        upgrades: { click_power: 1, auto_clicker: false },
        tom2: { hunger: 100, energy: 100, mood: 100, health: 100 }
    },
    "–ê–ª–∏—Å–∞": { 
        bytes: 200, 
        rebirths: 0, 
        eggsOpened: 0,
        pets: [], 
        clothing: [],
        upgrades: { click_power: 1, auto_clicker: false },
        tom2: { hunger: 100, energy: 100, mood: 100, health: 100 }
    }
};

let chatData = JSON.parse(localStorage.getItem('hub_chat')) || [];

// ====================
// –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
// ====================
function identify() {
    const user = document.getElementById('user-select').value;
    const device = document.getElementById('device-select').value;
    const password = document.getElementById('password-input').value;
    
    if (!password || password.trim() === "") {
        alert("–í–≤–µ–¥–∏—Ç–µ –ª—é–±–æ–π —Å–∏–º–≤–æ–ª –≤ –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è!");
        return;
    }
    
    currentUser = user;
    currentDevice = device;
    
    if (device === 'mobile') {
        document.body.classList.add('mobile');
    }
    
    document.getElementById('auth-overlay').style.display = 'none';
    document.getElementById('main-content').style.display = 'flex';
    document.getElementById('user-tag').innerText = `üë§ ${user}`;
    
    updateAllUI();
    startTom2System();
    loadChat();
    startClock();
    
    if (hubData[currentUser].upgrades.auto_clicker) {
        startAutoClicker();
    }
    
    saveData();
}

// ====================
// –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê
// ====================
function updateAllUI() {
    if (!currentUser || !hubData[currentUser]) return;
    
    const userData = hubData[currentUser];
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –≤–µ–∑–¥–µ
    const balance = userData.bytes || 0;
    const rebirths = userData.rebirths || 0;
    const multiplier = calculateMultiplier();
    
    document.getElementById('balance-display').textContent = balance;
    document.getElementById('miner-balance').textContent = balance;
    document.getElementById('egg-balance').textContent = balance;
    document.getElementById('clothing-balance').textContent = balance;
    
    document.getElementById('rebirth-count').textContent = rebirths;
    document.getElementById('multiplier').textContent = multiplier.toFixed(1) + 'x';
    document.getElementById('miner-multiplier').textContent = multiplier.toFixed(1) + 'x';
    document.getElementById('current-multiplier').textContent = multiplier.toFixed(1) + 'x';
    document.getElementById('next-multiplier').textContent = (multiplier + 0.5).toFixed(1) + 'x';
    
    document.getElementById('pets-count').textContent = (userData.pets || []).length;
    document.getElementById('total-pets-display').textContent = (userData.pets || []).length;
    document.getElementById('total-eggs').textContent = userData.eggsOpened || 0;
    document.getElementById('eggs-opened').textContent = userData.eggsOpened || 0;
    document.getElementById('current-prestige').textContent = rebirths;
    
    const prestigeCost = Math.floor(10000 * Math.pow(1.5, rebirths));
    document.getElementById('prestige-cost-display').textContent = prestigeCost.toLocaleString();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –±–æ–Ω—É—Å—ã –ø–∏—Ç–æ–º—Ü–µ–≤
    updatePetBonus();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∏—Ç–æ–º—Ü–µ–≤
    renderPets();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ–¥–µ–∂–¥—É
    renderOwnedClothing();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¢–æ–º–∞ 2
    updateTom2UI();
}

function calculateMultiplier() {
    const userData = hubData[currentUser];
    let multiplier = 1 + (userData.rebirths || 0) * 0.5;
    
    // –ë–æ–Ω—É—Å –æ—Ç –ø–∏—Ç–æ–º—Ü–µ–≤
    const activePets = (userData.pets || []).filter(p => p.active);
    activePets.forEach(pet => {
        multiplier += pet.value || 0;
    });
    
    // –ë–æ–Ω—É—Å –æ—Ç —É–ª—É—á—à–µ–Ω–∏–π
    if (userData.upgrades) {
        multiplier *= userData.upgrades.click_power || 1;
    }
    
    return multiplier;
}

function updatePetBonus() {
    const userData = hubData[currentUser];
    const activePets = (userData.pets || []).filter(p => p.active);
    let bonus = 0;
    activePets.forEach(pet => {
        bonus += pet.value || 0;
    });
    document.getElementById('pet-bonus').textContent = bonus.toFixed(1);
}

function saveData() {
    localStorage.setItem('hub_data', JSON.stringify(hubData));
    localStorage.setItem('hub_chat', JSON.stringify(chatData));
    localStorage.setItem('last_user', currentUser);
}

// ====================
// –¢–û–ú 2 –°–ò–°–¢–ï–ú–ê
// ====================
function startTom2System() {
    updateTom2UI();
    
    setInterval(() => {
        const tom2 = hubData[currentUser].tom2;
        
        tom2.hunger = Math.max(0, tom2.hunger - 0.5);
        tom2.energy = Math.max(0, tom2.energy - 0.3);
        tom2.mood = Math.max(0, tom2.mood - 0.2);
        
        if (tom2.hunger < 20) tom2.health = Math.max(0, tom2.health - 0.5);
        if (tom2.energy < 20) tom2.health = Math.max(0, tom2.health - 0.3);
        
        updateTom2UI();
        saveData();
    }, 10000);
}

function updateTom2UI() {
    const tom2 = hubData[currentUser].tom2;
    
    document.getElementById('tom2-hunger-bar').style.width = tom2.hunger + '%';
    document.getElementById('tom2-energy-bar').style.width = tom2.energy + '%';
    document.getElementById('tom2-mood-bar').style.width = tom2.mood + '%';
    document.getElementById('tom2-health-bar').style.width = tom2.health + '%';
    
    document.getElementById('tom2-hunger-value').textContent = Math.round(tom2.hunger) + '%';
    document.getElementById('tom2-energy-value').textContent = Math.round(tom2.energy) + '%';
    document.getElementById('tom2-mood-value').textContent = Math.round(tom2.mood) + '%';
    document.getElementById('tom2-health-value').textContent = Math.round(tom2.health) + '%';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    let message = "–ü—Ä–∏–≤–µ—Ç! –Ø –¢–æ–º!";
    if (tom2.hunger < 20) message = "–Ø –≥–æ–ª–æ–¥–µ–Ω! üçï";
    else if (tom2.energy < 20) message = "–Ø —É—Å—Ç–∞–ª... üò¥";
    else if (tom2.mood < 20) message = "–ú–Ω–µ —Å–∫—É—á–Ω–æ... üòû";
    else if (tom2.health < 50) message = "–Ø –∑–∞–±–æ–ª–µ–ª... ü§í";
    
    document.getElementById('tom2-message').textContent = message;
}

function tom2Action(action) {
    const tom2 = hubData[currentUser].tom2;
    const messages = {
        feed: "–í–∫—É—Å–Ω–æ! –ú—É—Ä—Ä—Ä... üòã",
        sleep: "Zzz... –•–æ—Ä–æ—à–æ —Å–ø–ª—é... üí§",
        play: "–£—Ä–∞! –ò–≥—Ä–∞–µ–º! ‚öΩ",
        clean: "–ß–∏—Å—Ç–æ—Ç–∞! üõÅ",
        heal: "–°–ø–∞—Å–∏–±–æ, –º–Ω–µ –ª—É—á—à–µ! üíä",
        pet: "–ú—É—Ä—Ä—Ä... ‚ù§Ô∏è"
    };
    
    switch(action) {
        case 'feed':
            tom2.hunger = Math.min(100, tom2.hunger + 30);
            tom2.mood = Math.min(100, tom2.mood + 10);
            break;
        case 'sleep':
            tom2.energy = 100;
            tom2.health = Math.min(100, tom2.health + 10);
            break;
        case 'play':
            tom2.energy = Math.max(0, tom2.energy - 20);
            tom2.mood = Math.min(100, tom2.mood + 30);
            break;
        case 'clean':
            tom2.mood = Math.min(100, tom2.mood + 15);
            break;
        case 'heal':
            tom2.health = 100;
            break;
        case 'pet':
            tom2.mood = Math.min(100, tom2.mood + 20);
            break;
    }
    
    document.getElementById('tom2-message').textContent = messages[action];
    updateTom2UI();
    saveData();
    
    setTimeout(() => {
        document.getElementById('tom2-message').textContent = "–ü—Ä–∏–≤–µ—Ç! –Ø –¢–æ–º!";
    }, 2000);
}

// ====================
// –ú–ê–ô–ù–ï–† (–∫–ª–∏–∫–µ—Ä)
// ====================
function clickMiner() {
    const core = document.getElementById('core');
    const userData = hubData[currentUser];
    const multiplier = calculateMultiplier();
    const clickPower = userData.upgrades.click_power || 1;
    
    // –ê–Ω–∏–º–∞—Ü–∏—è
    core.style.transform = 'scale(0.9)';
    setTimeout(() => core.style.transform = 'scale(1)', 100);
    
    // –î–æ–±–∞–≤–ª—è–µ–º BYTES
    const gain = Math.floor(10 * multiplier * clickPower);
    userData.bytes += gain;
    hubData[currentUser] = userData;
    
    updateAllUI();
    saveData();
}

function buyUpgrade(type) {
    const userData = hubData[currentUser];
    const costs = {
        click_power: 1000,
        auto_clicker: 5000
    };
    
    const cost = costs[type];
    if (userData.bytes < cost) {
        alert(`–ù—É–∂–Ω–æ ${cost} BYTES!`);
        return;
    }
    
    userData.bytes -= cost;
    
    if (type === 'click_power') {
        userData.upgrades.click_power = (userData.upgrades.click_power || 1) + 1;
    } else if (type === 'auto_clicker' && !userData.upgrades.auto_clicker) {
        userData.upgrades.auto_clicker = true;
        startAutoClicker();
    }
    
    hubData[currentUser] = userData;
    updateAllUI();
    saveData();
    alert(`–£–ª—É—á—à–µ–Ω–∏–µ –∫—É–ø–ª–µ–Ω–æ!`);
}

function startAutoClicker() {
    if (autoClickerInterval) return;
    
    autoClickerInterval = setInterval(() => {
        if (!hubData[currentUser]?.upgrades?.auto_clicker) {
            clearInterval(autoClickerInterval);
            autoClickerInterval = null;
            return;
        }
        
        const userData = hubData[currentUser];
        const multiplier = calculateMultiplier();
        const gain = Math.floor(5 * multiplier);
        userData.bytes += gain;
        hubData[currentUser] = userData;
        
        if (document.getElementById('miner').classList.contains('active')) {
            updateAllUI();
        }
        saveData();
    }, 1000);
}

// ====================
// –Ø–ô–¶–ê
// ====================
function buyEgg(type) {
    const userData = hubData[currentUser];
    const prices = {
        common: 100,
        rare: 500,
        epic: 2000,
        mythic: 10000,
        legendary: 50000,
        secret: 250000,
        god: 1000000
    };
    
    const price = prices[type];
    if (userData.bytes < price) {
        alert(`–ù—É–∂–Ω–æ ${price.toLocaleString()} BYTES!`);
        return;
    }
    
    userData.bytes -= price;
    userData.eggsOpened = (userData.eggsOpened || 0) + 1;
    
    const result = openEgg(type);
    const resultElement = document.getElementById('egg-result');
    
    resultElement.innerHTML = `<h3>üéâ –í–´ –ü–û–õ–£–ß–ò–õ–ò:</h3>` +
        result.map(pet => `
            <div style="margin: 10px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                <div style="font-size: 40px;">${pet.emoji}</div>
                <div><strong>${pet.name}</strong></div>
                <div>${pet.bonus} –∫ –º–Ω–æ–∂–∏—Ç–µ–ª—é</div>
            </div>
        `).join('');
    
    resultElement.style.display = 'block';
    
    if (!userData.pets) userData.pets = [];
    result.forEach(pet => {
        userData.pets.push({
            ...pet,
            active: true,
            id: Date.now() + Math.random()
        });
    });
    
    hubData[currentUser] = userData;
    updateAllUI();
    saveData();
    
    setTimeout(() => {
        resultElement.style.display = 'none';
    }, 5000);
}

function openEgg(type) {
    const results = [];
    
    // –û—Å–Ω–æ–≤–Ω–æ–π –ø–∏—Ç–æ–º–µ—Ü
    const eggChances = {
        common: { common: 0.8, rare: 0.15, epic: 0.04, mythic: 0.01 },
        rare: { rare: 0.7, epic: 0.25, mythic: 0.04, legendary: 0.01 },
        epic: { epic: 0.65, mythic: 0.3, legendary: 0.04, secret: 0.01 },
        mythic: { mythic: 0.6, legendary: 0.35, secret: 0.04, god: 0.01 },
        legendary: { legendary: 0.7, secret: 0.25, god: 0.05 },
        secret: { secret: 0.85, god: 0.15 },
        god: { god: 1 }
    };
    
    const chances = eggChances[type];
    const rand = Math.random();
    let cumulative = 0;
    let selectedRarity = 'common';
    
    for (const [rarity, chance] of Object.entries(chances)) {
        cumulative += chance;
        if (rand <= cumulative) {
            selectedRarity = rarity;
            break;
        }
    }
    
    const pool = petsDatabase[selectedRarity];
    if (pool && pool.length > 0) {
        const pet = {...pool[Math.floor(Math.random() * pool.length)]};
        results.push(pet);
    }
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∏—Ç–æ–º—Ü—ã
    if (type === 'god') {
        for (let i = 0; i < 3; i++) {
            const legendaryPool = petsDatabase['legendary'];
            if (legendaryPool && legendaryPool.length > 0) {
                results.push({...legendaryPool[Math.floor(Math.random() * legendaryPool.length)]});
            }
        }
    } else if (['legendary', 'secret', 'mythic'].includes(type)) {
        const extraCount = Math.floor(Math.random() * 2) + 1;
        for (let i = 0; i < extraCount; i++) {
            const extraTypes = ['common', 'rare', 'epic'];
            const extraType = extraTypes[Math.floor(Math.random() * extraTypes.length)];
            const extraPool = petsDatabase[extraType];
            if (extraPool && extraPool.length > 0) {
                results.push({...extraPool[Math.floor(Math.random() * extraPool.length)]});
            }
        }
    }
    
    return results;
}

// ====================
// –ü–ò–¢–û–ú–¶–´
// ====================
function renderPets() {
    const container = document.getElementById('pets-container');
    const userData = hubData[currentUser];
    const pets = userData.pets || [];
    
    container.innerHTML = '';
    
    if (pets.length === 0) {
        container.innerHTML = '<p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–∏—Ç–æ–º—Ü–µ–≤. –ö—É–ø–∏—Ç–µ —è–π—Ü–∞!</p>';
        return;
    }
    
    pets.forEach((pet, index) => {
        const petCard = document.createElement('div');
        petCard.className = 'pet-card';
        petCard.innerHTML = `
            <div class="pet-emoji">${pet.emoji}</div>
            <div><strong>${pet.name}</strong></div>
            <div>${pet.bonus}</div>
            <div style="font-size: 12px; color: #888;">${pet.rarity}</div>
            <button class="btn" onclick="togglePet(${index})" style="margin-top: 5px; padding: 5px; font-size: 12px;">
                ${pet.active ? '–î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å' : '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å'}
            </button>
        `;
        container.appendChild(petCard);
    });
}

function togglePet(index) {
    const userData = hubData[currentUser];
    if (userData.pets && userData.pets[index]) {
        userData.pets[index].active = !userData.pets[index].active;
        hubData[currentUser] = userData;
        updateAllUI();
        saveData();
    }
}

function activateAllPets() {
    const userData = hubData[currentUser];
    if (userData.pets) {
        userData.pets.forEach(pet => pet.active = true);
        hubData[currentUser] = userData;
        updateAllUI();
        saveData();
        alert('–í—Å–µ –ø–∏—Ç–æ–º—Ü—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã!');
    }
}

function petFusion() {
    const userData = hubData[currentUser];
    const pets = userData.pets || [];
    
    if (pets.length < 2) {
        alert('–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –ø–∏—Ç–æ–º—Ü–∞ –¥–ª—è —Å–ª–∏—è–Ω–∏—è!');
        return;
    }
    
    // –í—ã–±–∏—Ä–∞–µ–º –¥–≤—É—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–∏—Ç–æ–º—Ü–µ–≤
    const index1 = Math.floor(Math.random() * pets.length);
    let index2;
    do {
        index2 = Math.floor(Math.random() * pets.length);
    } while (index2 === index1);
    
    const pet1 = pets[index1];
    const pet2 = pets[index2];
    
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞
    const newPet = {
        id: Date.now(),
        name: `${pet1.name}-${pet2.name}`,
        emoji: pet1.emoji + pet2.emoji,
        bonus: `+${(pet1.value + pet2.value + 0.3).toFixed(1)}x`,
        value: pet1.value + pet2.value + 0.3,
        rarity: 'fused',
        active: true
    };
    
    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã—Ö
    pets.splice(Math.max(index1, index2), 1);
    pets.splice(Math.min(index1, index2), 1);
    
    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ
    pets.push(newPet);
    userData.pets = pets;
    hubData[currentUser] = userData;
    
    updateAllUI();
    saveData();
    alert(`–°–ª–∏—è–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ! –ü–æ–ª—É—á–µ–Ω: ${newPet.name}`);
}

// ====================
# –ü–ï–†–ï–†–û–ñ–î–ï–ù–ò–Ø
# ====================
function doPrestige() {
    const userData = hubData[currentUser];
    const rebirths = userData.rebirths || 0;
    const cost = Math.floor(10000 * Math.pow(1.5, rebirths));
    
    if (userData.bytes < cost) {
        alert(`–ù—É–∂–Ω–æ ${cost.toLocaleString()} BYTES –¥–ª—è –ø–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏—è!`);
        return;
    }
    
    if (!confirm(`–ü–µ—Ä–µ—Ä–æ–¥–∏—Ç—å—Å—è –∑–∞ ${cost.toLocaleString()} BYTES?\n–í—ã –ø–æ–ª—É—á–∏—Ç–µ +0.5x –∫ –º–Ω–æ–∂–∏—Ç–µ–ª—é –Ω–∞–≤—Å–µ–≥–¥–∞!`)) {
        return;
    }
    
    userData.bytes = 0;
    userData.rebirths = rebirths + 1;
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —É–ª—É—á—à–µ–Ω–∏—è
    userData.upgrades = { click_power: 1, auto_clicker: false };
    
    hubData[currentUser] = userData;
    updateAllUI();
    saveData();
    alert(`–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ #${userData.rebirths} –∑–∞–≤–µ—Ä—à–µ–Ω–æ!`);
}

// ====================
# –û–î–ï–ñ–î–ê –î–õ–Ø –¢–û–ú–ê 2
# ====================
function buyClothing(item, price) {
    const userData = hubData[currentUser];
    
    if (userData.bytes < price) {
        alert(`–ù—É–∂–Ω–æ ${price} BYTES!`);
        return;
    }
    
    if (!userData.clothing) userData.clothing = [];
    if (userData.clothing.includes(item)) {
        alert('–≠—Ç–∞ –æ–¥–µ–∂–¥–∞ —É–∂–µ –∫—É–ø–ª–µ–Ω–∞!');
        return;
    }
    
    userData.bytes -= price;
    userData.clothing.push(item);
    hubData[currentUser] = userData;
    
    updateAllUI();
    saveData();
    alert(`–ö—É–ø–ª–µ–Ω–æ: ${clothingItems[item].name}`);
}

function renderOwnedClothing() {
    const container = document.getElementById('owned-clothing');
    const clothingContainer = document.getElementById('tom2-clothing');
    const userData = hubData[currentUser];
    const owned = userData.clothing || [];
    
    container.innerHTML = '';
    clothingContainer.innerHTML = '';
    
    if (owned.length === 0) {
        container.innerHTML = '<p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ–¥–µ–∂–¥—ã</p>';
        return;
    }
    
    owned.forEach(item => {
        const clothing = clothingItems[item];
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫
        const div = document.createElement('div');
        div.className = 'clothing-item';
        div.onclick = () => equipClothing(item);
        div.innerHTML = `
            <div style="font-size: 30px;">${clothing.emoji}</div>
            <div>${clothing.name}</div>
            <button class="btn" onclick="sellClothing('${item}')" style="margin-top: 5px; padding: 3px; font-size: 10px;">
                –ü—Ä–æ–¥–∞—Ç—å
            </button>
        `;
        container.appendChild(div);
        
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞ –¢–æ–º–∞
        const clothingElement = document.createElement('div');
        clothingElement.style.position = 'absolute';
        clothingElement.style.top = '50%';
        clothingElement.style.left = '50%';
        clothingElement.style.transform = 'translate(-50%, -50%)';
        clothingElement.style.fontSize = '80px';
        clothingElement.textContent = clothing.emoji;
        clothingElement.id = `clothing-${item}`;
        clothingElement.style.display = 'none';
        clothingContainer.appendChild(clothingElement);
    });
}

function equipClothing(item) {
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–¥–µ–∂–¥—É –Ω–∞ –¢–æ–º–µ
    document.querySelectorAll('#tom2-clothing > div').forEach(el => {
        el.style.display = 'none';
    });
    
    const clothingEl = document.getElementById(`clothing-${item}`);
    if (clothingEl) {
        clothingEl.style.display = 'block';
    }
}

function sellClothing(item) {
    const userData = hubData[currentUser];
    const clothing = clothingItems[item];
    const sellPrice = Math.floor(clothing.price * 0.5);
    
    if (!confirm(`–ü—Ä–æ–¥–∞—Ç—å ${clothing.name} –∑–∞ ${sellPrice} BYTES?`)) return;
    
    const index = userData.clothing.indexOf(item);
    if (index > -1) {
        userData.clothing.splice(index, 1);
        userData.bytes += sellPrice;
        hubData[currentUser] = userData;
        
        updateAllUI();
        saveData();
        alert(`–ü—Ä–æ–¥–∞–Ω–æ: ${clothing.name}`);
    }
}

// ====================
# –ö–ê–†–¢–ê
# ====================
function initMap() {
    if (map) return;
    
    map = L.map('map-container').setView([55.7558, 37.6173], 10);
    
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap'
    }).addTo(map);
}

function findMyLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            (position) => {
                const lat = position.coords.latitude;
                const lng = position.coords.longitude;
                map.setView([lat, lng], 15);
                L.marker([lat, lng]).addTo(map).bindPopup('–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ').openPopup();
                alert('üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ!');
            },
            () => {
                alert('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ');
            }
        );
    } else {
        alert('‚ö†Ô∏è –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
    }
}

function addMapMarker() {
    if (!map) return;
    
    const center = map.getCenter();
    L.marker([center.lat, center.lng])
        .addTo(map)
        .bindPopup(`–ú–µ—Ç–∫–∞ –æ—Ç ${currentUser}`)
        .openPopup();
    
    alert('üìå –ú–µ—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
}

// ====================
# –ß–ê–¢
# ====================
function loadChat() {
    const container = document.getElementById('chat-container');
    container.innerHTML = '';
    
    chatData.slice(-20).forEach(msg => {
        const msgDiv = document.createElement('div');
        msgDiv.style.padding = '5px';
        msgDiv.style.margin = '3px 0';
        msgDiv.style.background = msg.user === currentUser ? 'rgba(0,255,0,0.1)' : 'rgba(0,242,255,0.1)';
        msgDiv.style.borderRadius = '5px';
        msgDiv.innerHTML = `<strong>${msg.user}:</strong> ${msg.text}`;
        container.appendChild(msgDiv);
    });
    
    container.scrollTop = container.scrollHeight;
}

function sendChatMessage() {
    const input = document.getElementById('chat-input');
    const text = input.value.trim();
    
    if (!text) return;
    
    const message = {
        user: currentUser,
        text: text,
        time: new Date().toLocaleTimeString()
    };
    
    chatData.push(message);
    if (chatData.length > 100) chatData.shift();
    
    localStorage.setItem('hub_chat', JSON.stringify(chatData));
    loadChat();
    input.value = '';
}

// ====================
# –£–¢–ò–õ–ò–¢–´
# ====================
function startClock() {
    function update() {
        const now = new Date();
        document.getElementById('clock').textContent = 
            now.toLocaleTimeString('ru-RU', { hour12: false });
    }
    update();
    setInterval(update, 1000);
}

function switchTab(tabId) {
    document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    document.querySelectorAll('section').forEach(section => section.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
    
    if (tabId === 'map') {
        setTimeout(() => {
            if (map) map.invalidateSize();
            else initMap();
        }, 100);
    }
}

function logout() {
    if (confirm('–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞?')) {
        location.reload();
    }
}

function exportData() {
    const data = {
        hubData: hubData,
        chatData: chatData,
        exportDate: new Date().toISOString()
    };
    
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `ultra-hub-backup-${currentUser}.json`;
    a.click();
    URL.revokeObjectURL(url);
    
    alert('üíæ –î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
}

function importData() {
    document.getElementById('import-file').click();
}

function handleFileImport(file) {
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const data = JSON.parse(e.target.result);
            
            if (confirm("–ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ?")) {
                if (data.hubData) hubData = data.hubData;
                if (data.chatData) chatData = data.chatData;
                
                saveData();
                updateAllUI();
                loadChat();
                alert('üíæ –î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
            }
        } catch (err) {
            alert('‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ñ–∞–π–ª–∞!');
        }
    };
    reader.readAsText(file);
}

function fullReset() {
    if (confirm('üí£ –£–î–ê–õ–ò–¢–¨ –í–°–ï –î–ê–ù–ù–´–ï?\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!')) {
        localStorage.clear();
        location.reload();
    }
}

// ====================
# –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
# ====================
window.addEventListener('load', function() {
    // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
    document.getElementById('password-input').value = "1";
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ Enter
    document.getElementById('password-input').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') identify();
    });
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å–µ—Å—Å–∏–∏
    const lastUser = localStorage.getItem('last_user');
    if (lastUser && hubData[lastUser]) {
        currentUser = lastUser;
        document.getElementById('auth-overlay').style.display = 'none';
        document.getElementById('main-content').style.display = 'flex';
        document.getElementById('user-tag').innerText = `üë§ ${lastUser}`;
        updateAllUI();
        startTom2System();
        loadChat();
        startClock();
        
        if (hubData[currentUser].upgrades.auto_clicker) {
            startAutoClicker();
        }
    }
});

// –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
window.addEventListener('keydown', function(e) {
    // –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (F8 –¥–ª—è –ù–∏–∫–∏—Ç—ã)
    if (e.key === 'F8' && currentUser === "–ù–∏–∫–∏—Ç–∞") {
        const bytes = parseInt(prompt("–°–∫–æ–ª—å–∫–æ BYTES –¥–æ–±–∞–≤–∏—Ç—å?"));
        if (!isNaN(bytes) && bytes > 0) {
            hubData[currentUser].bytes += bytes;
            updateAllUI();
            saveData();
            alert(`–î–æ–±–∞–≤–ª–µ–Ω–æ ${bytes} BYTES!`);
        }
    }
    
    // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç–µ
    if (e.key === 'Enter' && document.getElementById('chat-input') === document.activeElement) {
        sendChatMessage();
    }
});
</script>
</body>
</html>

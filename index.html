<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTRA PLATFORM</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --light: #f3f4f6;
            --gray: #6b7280;
            --background: #0f172a;
            --card: #1e293b;
            --border: #374151;
            --text: #e5e7eb;
        }

        [data-theme="light"] {
            --background: #ffffff;
            --card: #f9fafb;
            --border: #e5e7eb;
            --text: #111827;
            --dark: #f3f4f6;
        }

        [data-theme="purple"] {
            --primary: #a855f7;
            --primary-dark: #9333ea;
            --secondary: #d946ef;
            --background: #1e1b4b;
            --card: #312e81;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }

        /* –í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
        #user-select {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--background) 0%, #000 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .user-select-box {
            background: rgba(30, 41, 59, 0.95);
            padding: 3rem;
            border-radius: 20px;
            border: 2px solid var(--primary);
            width: 100%;
            max-width: 600px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .user-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .user-subtitle {
            opacity: 0.8;
            margin-bottom: 2rem;
        }

        .user-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .user-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 1.25rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .user-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
        }

        .user-btn.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 0 30px rgba(99, 102, 241, 0.5);
            animation: pulse 2s infinite;
        }

        .user-btn.occupied {
            border-color: var(--danger);
            color: var(--danger);
            cursor: not-allowed;
            opacity: 0.7;
            position: relative;
        }

        .user-btn.occupied::after {
            content: '–ó–ê–ù–Ø–¢';
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--danger);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.5); }
            50% { box-shadow: 0 0 40px rgba(99, 102, 241, 0.8); }
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2rem;
        }

        .action-btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .enter-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
        }

        .enter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
        }

        .exit-btn {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 2px solid var(--danger);
        }

        .exit-btn:hover {
            background: var(--danger);
            color: white;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å */
        #main-app {
            display: none;
            min-height: 100vh;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .user-name {
            font-weight: 600;
        }

        .user-balance {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .settings-btn {
            background: rgba(99, 102, 241, 0.1);
            border: 2px solid var(--primary);
            color: var(--primary);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2rem;
        }

        .settings-btn:hover {
            background: var(--primary);
            color: white;
            transform: rotate(180deg);
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-tabs {
            display: flex;
            background: var(--card);
            padding: 1rem;
            gap: 0.5rem;
            overflow-x: auto;
            border-bottom: 1px solid var(--border);
        }

        .nav-tab {
            background: transparent;
            border: 2px solid transparent;
            color: var(--text);
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0.7;
        }

        .nav-tab:hover {
            opacity: 1;
            background: rgba(99, 102, 241, 0.1);
        }

        .nav-tab.active {
            background: var(--primary);
            color: white;
            opacity: 1;
        }

        /* –°–æ–¥–µ—Ä–∂–∏–º–æ–µ */
        .content {
            padding: 2rem;
            min-height: calc(100vh - 140px);
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –û–±–ª–∞–∫–æ */
        .cloud-subtabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        .cloud-subtab {
            background: transparent;
            border: none;
            color: var(--text);
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            opacity: 0.7;
            transition: all 0.3s;
        }

        .cloud-subtab.active {
            background: var(--primary);
            color: white;
            opacity: 1;
        }

        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .file-card {
            background: var(--card);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.3s;
            cursor: pointer;
        }

        .file-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .file-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        /* –ò–≥—Ä—ã */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }

        .game-card {
            background: var(--card);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .game-card:hover {
            transform: translateY(-8px);
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .game-header {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            padding: 2rem;
            text-align: center;
            color: white;
        }

        .game-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .game-body {
            padding: 1.5rem;
        }

        .game-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .play-btn {
            width: 100%;
            padding: 1rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .play-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        /* CS 3D –∏–≥—Ä–∞ */
        .cs-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1000;
            display: none;
        }

        #cs-canvas {
            width: 100%;
            height: 100%;
        }

        .cs-hud {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            z-index: 10;
        }

        .cs-stats {
            background: rgba(0, 0, 0, 0.8);
            padding: 1rem 1.5rem;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            backdrop-filter: blur(10px);
            border: 1px solid var(--primary);
        }

        .cs-controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
        }

        .cs-weapon-selector {
            display: flex;
            gap: 0.5rem;
        }

        .cs-weapon-btn {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid var(--primary);
            color: white;
            padding: 0.75rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .cs-weapon-btn:hover {
            background: var(--primary);
        }

        .cs-weapon-btn.active {
            background: var(--primary);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
        }

        /* –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ */
        .tic-tac-toe-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 400px;
            margin: 2rem auto;
        }

        .tic-cell {
            aspect-ratio: 1;
            background: var(--card);
            border: 2px solid var(--primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tic-cell:hover {
            background: rgba(99, 102, 241, 0.1);
        }

        .tic-cell.x { color: var(--primary); }
        .tic-cell.o { color: var(--secondary); }

        /* –ö–ª–∏–∫–µ—Ä */
        .clicker-game {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        .clicker-money {
            font-size: 4rem;
            font-weight: 800;
            color: var(--success);
            margin: 2rem 0;
            text-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
        }

        .clicker-button {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            margin: 2rem auto;
            display: block;
            box-shadow: 0 20px 40px rgba(99, 102, 241, 0.3);
        }

        .clicker-button:active {
            transform: scale(0.95);
        }

        .clicker-upgrades {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .upgrade-card {
            background: var(--card);
            border-radius: 15px;
            padding: 1.5rem;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
        }

        .upgrade-card:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
        }

        /* –ö–∞—Ä—Ç—ã */
        #map {
            height: 600px;
            border-radius: 20px;
            border: 2px solid var(--primary);
            overflow: hidden;
        }

        .map-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        /* –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ */
        .translator-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .lang-selectors {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
            align-items: center;
        }

        .lang-select {
            background: var(--card);
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 1rem;
            border-radius: 10px;
            font-size: 1rem;
        }

        .swap-btn {
            background: var(--primary);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2rem;
        }

        .swap-btn:hover {
            background: var(--secondary);
            transform: rotate(180deg);
        }

        .text-boxes {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .text-area {
            background: var(--card);
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 1.25rem;
            border-radius: 10px;
            min-height: 200px;
            font-size: 1rem;
            resize: vertical;
            font-family: inherit;
        }

        .translate-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1.5rem;
        }

        .voice-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            transition: all 0.3s;
        }

        .voice-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        /* –ß–∞—Å—ã */
        .clocks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }

        .clock-card {
            background: var(--card);
            padding: 2rem;
            border-radius: 20px;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .clock-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .clock-city {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .clock-time {
            font-size: 2.5rem;
            font-weight: 800;
            margin: 1rem 0;
        }

        .clock-date {
            opacity: 0.8;
            font-size: 1rem;
        }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .setting-card {
            background: var(--card);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
        }

        .theme-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .theme-btn {
            padding: 1rem;
            border-radius: 10px;
            border: 2px solid transparent;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .theme-btn.active {
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
        }

        .theme-dark {
            background: #1f2937;
            color: white;
        }

        .theme-light {
            background: white;
            color: #111827;
        }

        .theme-purple {
            background: linear-gradient(45deg, #1e1b4b, #312e81);
            color: white;
        }

        /* –ß–∞—Ç-–±–æ—Ç */
        .chat-container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card);
            border-radius: 20px;
            overflow: hidden;
            height: 600px;
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border);
        }

        .chat-messages {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .chat-message {
            max-width: 70%;
            padding: 1rem 1.25rem;
            border-radius: 18px;
            animation: fadeIn 0.3s ease;
        }

        .chat-message.user {
            background: var(--primary);
            color: white;
            align-self: flex-end;
        }

        .chat-message.bot {
            background: rgba(255, 255, 255, 0.05);
            align-self: flex-start;
        }

        .chat-input-area {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.05);
            border-top: 1px solid var(--border);
        }

        .chat-input {
            flex: 1;
            background: var(--card);
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 1rem 1.25rem;
            border-radius: 25px;
            font-size: 1rem;
        }

        .chat-send {
            background: var(--primary);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
        }

        .chat-send:hover {
            background: var(--secondary);
            transform: scale(1.05);
        }

        /* –õ–∏–¥–µ—Ä—ã */
        .leaderboard-table {
            background: var(--card);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .leaderboard-row {
            display: grid;
            grid-template-columns: 60px 1fr 100px 100px;
            padding: 1rem 1.5rem;
            align-items: center;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s;
        }

        .leaderboard-row:hover {
            background: rgba(99, 102, 241, 0.05);
        }

        .leaderboard-header {
            background: var(--primary);
            color: white;
            font-weight: 700;
        }

        .rank-badge {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
        }

        .rank-1 { background: gold; color: #000; }
        .rank-2 { background: silver; color: #000; }
        .rank-3 { background: #cd7f32; color: #000; }
        .rank-other { background: var(--primary); }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: var(--card);
            border-radius: 20px;
            padding: 2.5rem;
            max-width: 500px;
            width: 100%;
            border: 2px solid var(--primary);
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .content { padding: 1rem; }
            .header { padding: 1rem; flex-direction: column; gap: 1rem; }
            .nav-tabs { overflow-x: scroll; }
            .user-grid { grid-template-columns: repeat(2, 1fr); }
            .text-boxes { grid-template-columns: 1fr; }
            .lang-selectors { grid-template-columns: 1fr; }
            .games-grid { grid-template-columns: 1fr; }
            .clocks-grid { grid-template-columns: 1fr; }
            .leaderboard-row { grid-template-columns: 50px 1fr 80px 80px; padding: 0.75rem 1rem; }
            .cs-controls { flex-direction: column; gap: 1rem; }
        }

        /* –£—Ç–∏–ª–∏—Ç—ã */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .mt-2 { margin-top: 2rem; }
        .mb-2 { margin-bottom: 2rem; }
        .p-2 { padding: 2rem; }
        .cursor-pointer { cursor: pointer; }
    </style>
</head>
<body>
    <!-- –í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="user-select">
        <div class="user-select-box">
            <h1 class="user-title">ULTRA PLATFORM</h1>
            <p class="user-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –≤—Ö–æ–¥–∞</p>
            
            <div class="user-grid" id="user-grid">
                <!-- –ö–Ω–æ–ø–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
            
            <div class="action-buttons">
                <button class="action-btn enter-btn" onclick="enterPlatform()">
                    –í–æ–π—Ç–∏ –≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
                </button>
                <button class="action-btn exit-btn" onclick="exitPlatform()">
                    –í—ã–π—Ç–∏ —Å —Å–∞–π—Ç–∞
                </button>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="main-app">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="header">
            <div class="logo">
                <span>üéÆ</span>
                <span>ULTRA PLATFORM</span>
            </div>
            
            <div class="user-info">
                <div class="user-avatar" id="user-avatar">U</div>
                <div>
                    <div class="user-name" id="current-user">–ì–æ—Å—Ç—å</div>
                    <div class="user-balance">
                        <span>üí∞</span>
                        <span id="user-balance">$1000</span>
                    </div>
                </div>
                <button class="settings-btn" onclick="openSettings()">‚öôÔ∏è</button>
            </div>
        </header>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-page="cloud">‚òÅÔ∏è –û–±–ª–∞–∫–æ</button>
            <button class="nav-tab" data-page="games">üéÆ –ò–≥—Ä—ã</button>
            <button class="nav-tab" data-page="maps">üó∫Ô∏è –ö–∞—Ä—Ç—ã</button>
            <button class="nav-tab" data-page="translator">üî§ –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫</button>
            <button class="nav-tab" data-page="clocks">‚è∞ –ß–∞—Å—ã</button>
            <button class="nav-tab" data-page="chatbot">ü§ñ –ß–∞—Ç-–±–æ—Ç</button>
            <button class="nav-tab" data-page="leaders">üèÜ –õ–∏–¥–µ—Ä—ã</button>
        </nav>

        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
        <main class="content">
            <!-- –û–±–ª–∞–∫–æ -->
            <section id="cloud" class="page active">
                <div class="cloud-subtabs">
                    <button class="cloud-subtab active" data-subtab="photos">üì∑ –§–æ—Ç–æ</button>
                    <button class="cloud-subtab" data-subtab="videos">üé¨ –í–∏–¥–µ–æ</button>
                    <button class="cloud-subtab" data-subtab="files">üìÅ –§–∞–π–ª—ã</button>
                </div>
                
                <div class="files-grid" id="cloud-files">
                    <!-- –§–∞–π–ª—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </section>

            <!-- –ò–≥—Ä—ã -->
            <section id="games" class="page">
                <div class="games-grid">
                    <!-- Counter-Strike -->
                    <div class="game-card">
                        <div class="game-header">
                            <div class="game-icon">üî´</div>
                            <h3>Counter-Strike 2</h3>
                        </div>
                        <div class="game-body">
                            <div class="game-stats">
                                <span>üë• 0/24</span>
                                <span>üéØ 0.00 K/D</span>
                            </div>
                            <button class="play-btn" onclick="startCSGame()">
                                –ò–≥—Ä–∞—Ç—å
                            </button>
                        </div>
                    </div>

                    <!-- –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ -->
                    <div class="game-card">
                        <div class="game-header">
                            <div class="game-icon">‚ùå‚≠ï</div>
                            <h3>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h3>
                        </div>
                        <div class="game-body">
                            <div class="game-stats">
                                <span>üéÆ –°—Ä–µ–¥–Ω—è—è</span>
                                <span>üèÜ 0 –ø–æ–±–µ–¥</span>
                            </div>
                            <button class="play-btn" onclick="startTicTacToe()">
                                –ò–≥—Ä–∞—Ç—å
                            </button>
                        </div>
                    </div>

                    <!-- –ö–ª–∏–∫–µ—Ä -->
                    <div class="game-card">
                        <div class="game-header">
                            <div class="game-icon">üí∞</div>
                            <h3>–ö–ª–∏–∫–µ—Ä</h3>
                        </div>
                        <div class="game-body">
                            <div class="game-stats">
                                <span>üîÑ 0 —É—Ä.</span>
                                <span>üêæ 0 –ø–∏—Ç–æ–º—Ü–µ–≤</span>
                            </div>
                            <button class="play-btn" onclick="startClicker()">
                                –ò–≥—Ä–∞—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- –ö–∞—Ä—Ç—ã -->
            <section id="maps" class="page">
                <div id="map"></div>
                <div class="map-controls mt-2">
                    <button class="voice-btn" onclick="findMyLocation()">
                        üìç –ú–æ—ë –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
                    </button>
                    <button class="voice-btn" onclick="searchLocation()">
                        üîç –ü–æ–∏—Å–∫ –º–µ—Å—Ç–∞
                    </button>
                </div>
            </section>

            <!-- –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ -->
            <section id="translator" class="page">
                <div class="translator-container">
                    <div class="lang-selectors">
                        <select class="lang-select" id="lang-from">
                            <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                            <option value="en">üá∫üá∏ –ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                            <option value="zh">üá®üá≥ –ö–∏—Ç–∞–π—Å–∫–∏–π</option>
                            <option value="ar">üá∏üá¶ –ê—Ä–∞–±—Å–∫–∏–π</option>
                        </select>
                        
                        <button class="swap-btn" onclick="swapLanguages()">‚áÑ</button>
                        
                        <select class="lang-select" id="lang-to">
                            <option value="en">üá∫üá∏ –ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                            <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                            <option value="zh">üá®üá≥ –ö–∏—Ç–∞–π—Å–∫–∏–π</option>
                            <option value="ar">üá∏üá¶ –ê—Ä–∞–±—Å–∫–∏–π</option>
                        </select>
                    </div>
                    
                    <div class="text-boxes">
                        <textarea class="text-area" id="input-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞..." oninput="translateText()"></textarea>
                        <textarea class="text-area" id="output-text" placeholder="–ü–µ—Ä–µ–≤–æ–¥..." readonly></textarea>
                    </div>
                    
                    <div class="translate-controls">
                        <button class="voice-btn" onclick="speakTranslation()">
                            üîä –ü—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏ –ø–µ—Ä–µ–≤–æ–¥
                        </button>
                        <button class="voice-btn" onclick="startVoiceInput()">
                            üé§ –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥
                        </button>
                    </div>
                </div>
            </section>

            <!-- –ß–∞—Å—ã -->
            <section id="clocks" class="page">
                <div class="clocks-grid" id="clocks-container">
                    <!-- –ß–∞—Å—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </section>

            <!-- –ß–∞—Ç-–±–æ—Ç -->
            <section id="chatbot" class="page">
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="chat-message bot">
                            –ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –ú–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –ø–æ–º–æ—á—å —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–±–æ–ª—Ç–∞—Ç—å. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
                        </div>
                    </div>
                    <div class="chat-input-area">
                        <input type="text" class="chat-input" id="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="if(event.key === 'Enter') sendChatMessage()">
                        <button class="chat-send" onclick="sendChatMessage()">‚û§</button>
                    </div>
                </div>
            </section>

            <!-- –õ–∏–¥–µ—Ä—ã -->
            <section id="leaders" class="page">
                <div class="leaderboard-table">
                    <div class="leaderboard-row leaderboard-header">
                        <div>#</div>
                        <div>–ò–≥—Ä–æ–∫</div>
                        <div>–û—á–∫–∏</div>
                        <div>–ò–≥—Ä–∞</div>
                    </div>
                    <div id="leaderboard-content">
                        <!-- –õ–∏–¥–µ—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- CS 3D –ò–≥—Ä–∞ -->
    <div class="cs-container" id="cs-game">
        <canvas id="cs-canvas"></canvas>
        <div class="cs-hud">
            <div class="cs-stats">
                <span id="cs-health">‚ù§Ô∏è 100</span>
                <span id="cs-money">üí∞ $800</span>
                <span id="cs-kills">üéØ 0 —É–±–∏–π—Å—Ç–≤</span>
                <span id="cs-ammo">üî´ 30/90</span>
            </div>
        </div>
        <div class="cs-controls">
            <div class="cs-weapon-selector">
                <button class="cs-weapon-btn" onclick="selectWeapon('akm')">üî´ AKM</button>
                <button class="cs-weapon-btn" onclick="selectWeapon('awp')">üéØ AWP</button>
                <button class="cs-weapon-btn" onclick="selectWeapon('glock')">üî´ GLOCK</button>
                <button class="cs-weapon-btn" onclick="selectWeapon('deagle')">üî´ DEAGLE</button>
            </div>
            <button class="cs-weapon-btn" onclick="exitCSGame()" style="background: var(--danger);">üö™ –í—ã—Ö–æ–¥</button>
        </div>
    </div>

    <!-- –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ -->
    <div id="tic-modal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 1.5rem; text-align: center;">‚ùå‚≠ï –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h2>
            
            <div class="tic-tac-toe-board" id="tic-board"></div>
            
            <div style="text-align: center; margin-top: 2rem;">
                <div id="tic-status" style="margin-bottom: 1rem; font-size: 1.2rem; font-weight: 600;"></div>
                <button class="play-btn" onclick="resetTicTacToe()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <button class="play-btn" onclick="closeModal('tic-modal')" style="background: var(--gray); margin-top: 0.5rem;">–í—ã—Ö–æ–¥</button>
            </div>
        </div>
    </div>

    <!-- –ö–ª–∏–∫–µ—Ä -->
    <div id="clicker-modal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 1.5rem; text-align: center;">üí∞ –ö–ª–∏–∫–µ—Ä –∏–≥—Ä–∞</h2>
            
            <div class="clicker-game">
                <div class="clicker-money" id="clicker-money">$0</div>
                <button class="clicker-button" onclick="clickMoney()">–ö–õ–ò–ö!</button>
                
                <div class="clicker-upgrades">
                    <div class="upgrade-card" onclick="buyUpgrade('click')">
                        <div style="font-weight: 700; margin-bottom: 0.5rem;">üí™ –°–∏–ª–∞ –∫–ª–∏–∫–∞</div>
                        <div style="opacity: 0.8; font-size: 0.9rem;">+$1 –∑–∞ –∫–ª–∏–∫</div>
                        <div style="color: var(--primary); margin-top: 0.5rem; font-weight: 600;">–¶–µ–Ω–∞: $10</div>
                    </div>
                    <div class="upgrade-card" onclick="buyUpgrade('auto')">
                        <div style="font-weight: 700; margin-bottom: 0.5rem;">‚ö° –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</div>
                        <div style="opacity: 0.8; font-size: 0.9rem;">+$0.5/—Å–µ–∫</div>
                        <div style="color: var(--primary); margin-top: 0.5rem; font-weight: 600;">–¶–µ–Ω–∞: $100</div>
                    </div>
                </div>
                
                <button class="play-btn" onclick="closeModal('clicker-modal')" style="margin-top: 2rem; background: var(--gray);">–í—ã—Ö–æ–¥</button>
            </div>
        </div>
    </div>

    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 1.5rem; text-align: center;">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            
            <div class="settings-grid">
                <div class="setting-card">
                    <h3 style="margin-bottom: 1rem;">üé® –¢–µ–º–∞</h3>
                    <div class="theme-selector">
                        <button class="theme-btn theme-dark active" onclick="setTheme('dark')">–¢—ë–º–Ω–∞—è</button>
                        <button class="theme-btn theme-light" onclick="setTheme('light')">–°–≤–µ—Ç–ª–∞—è</button>
                        <button class="theme-btn theme-purple" onclick="setTheme('purple')">–§–∏–æ–ª–µ—Ç–æ–≤–∞—è</button>
                    </div>
                </div>
                
                <div class="setting-card">
                    <h3 style="margin-bottom: 1rem;">üîä –ó–≤—É–∫–∏</h3>
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <span>–í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫–∏ –∏–≥—Ä—ã</span>
                        <label style="position: relative; display: inline-block; width: 60px; height: 30px;">
                            <input type="checkbox" id="sound-toggle" checked style="opacity: 0; width: 0; height: 0;">
                            <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: var(--gray); transition: .4s; border-radius: 34px;"></span>
                            <span style="position: absolute; content: ''; height: 22px; width: 22px; left: 4px; bottom: 4px; background: white; transition: .4s; border-radius: 50%;"></span>
                        </label>
                    </div>
                </div>
                
                <div class="setting-card">
                    <h3 style="margin-bottom: 1rem;">üíæ –î–∞–Ω–Ω—ã–µ</h3>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                        <button class="play-btn" onclick="exportData()">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                        <button class="play-btn" onclick="importData()" style="background: var(--secondary);">–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                        <button class="play-btn" onclick="clearData()" style="background: var(--danger);">–°–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                    </div>
                </div>
            </div>
            
            <button class="play-btn" onclick="closeModal('settings-modal')" style="margin-top: 2rem; width: 100%; background: var(--gray);">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

<script>
// ====================
// –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
// ====================
const USERS = ["–ù–∏–∫–∏—Ç–∞", "–ê–ª–µ–Ω–∞", "–°–∞—à–∞", "–ê–ª–∏—Å–∞", "–ì–æ—Å—Ç—å"];
let currentUser = null;
let platformData = JSON.parse(localStorage.getItem('ultra_platform_v2')) || {
    users: {},
    online: {},
    settings: { theme: 'dark', sounds: true },
    games: {
        cs: { kills: 0, deaths: 0, wins: 0 },
        tic: { wins: 0, losses: 0 },
        clicker: { money: 0, clickPower: 1, autoClicker: 0 }
    }
};

// Three.js –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è CS
let csScene, csCamera, csRenderer, csPlayer, csBots = [], csBullets = [], csWalls = [];
let csHealth = 100, csMoney = 800, csKills = 0, csAmmo = 30;
let currentWeapon = 'akm';

// –ö–∞—Ä—Ç–∞
let map = null;

// ====================
// –í–´–ë–û–† –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
// ====================
function initUserSelection() {
    const userGrid = document.getElementById('user-grid');
    userGrid.innerHTML = '';
    
    USERS.forEach(username => {
        const isOccupied = platformData.online && platformData.online[username];
        const btn = document.createElement('button');
        btn.className = `user-btn ${isOccupied ? 'occupied' : ''}`;
        btn.textContent = username;
        btn.onclick = () => selectUser(username, isOccupied);
        userGrid.appendChild(btn);
    });
}

function selectUser(username, isOccupied) {
    if (isOccupied) {
        alert(`‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "${username}" —É–∂–µ –≤ –∏–≥—Ä–µ!`);
        return;
    }
    
    document.querySelectorAll('.user-btn').forEach(btn => btn.classList.remove('selected'));
    event.target.classList.add('selected');
    currentUser = username;
}

function enterPlatform() {
    if (!currentUser) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!');
        return;
    }
    
    if (platformData.online && platformData.online[currentUser]) {
        alert(`‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "${currentUser}" —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É!`);
        initUserSelection();
        return;
    }
    
    // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ –Ω–µ—Ç
    if (!platformData.users[currentUser]) {
        platformData.users[currentUser] = {
            balance: 1000,
            joinDate: new Date().toISOString()
        };
    }
    
    // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –æ–Ω–ª–∞–π–Ω
    platformData.online[currentUser] = Date.now();
    saveData();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
    initPlatform();
}

function initPlatform() {
    document.getElementById('user-select').style.display = 'none';
    document.getElementById('main-app').style.display = 'block';
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É
    setTheme(platformData.settings.theme);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    updateUserInfo();
    loadCloudFiles();
    initMap();
    initWorldClocks();
    initLeaderboard();
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    setupEventListeners();
}

function updateUserInfo() {
    const userData = platformData.users[currentUser];
    const firstLetter = currentUser.charAt(0).toUpperCase();
    
    document.getElementById('user-avatar').textContent = firstLetter;
    document.getElementById('current-user').textContent = currentUser;
    document.getElementById('user-balance').textContent = `$${userData.balance || 1000}`;
}

function exitPlatform() {
    if (confirm('–í—ã–π—Ç–∏ —Å —Å–∞–π—Ç–∞?')) {
        if (currentUser && platformData.online) {
            delete platformData.online[currentUser];
            saveData();
        }
        window.close();
    }
}

// ====================
// –û–ë–õ–ê–ö–û
// ====================
function loadCloudFiles() {
    const files = [
        { name: '–§–æ—Ç–æ 1.jpg', type: 'photo', size: '2.4 MB', icon: 'üì∑' },
        { name: '–ü–µ–π–∑–∞–∂.png', type: 'photo', size: '3.1 MB', icon: 'üèûÔ∏è' },
        { name: '–í–∏–¥–µ–æ 1.mp4', type: 'video', size: '45.2 MB', icon: 'üé¨' },
        { name: '–î–æ–∫—É–º–µ–Ω—Ç.pdf', type: 'file', size: '1.1 MB', icon: 'üìÑ' },
        { name: '–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è.pptx', type: 'file', size: '8.7 MB', icon: 'üìä' },
        { name: '–ú—É–∑—ã–∫–∞.mp3', type: 'audio', size: '5.3 MB', icon: 'üéµ' }
    ];
    
    const grid = document.getElementById('cloud-files');
    grid.innerHTML = files.map(file => `
        <div class="file-card">
            <div class="file-icon">${file.icon}</div>
            <div style="font-weight: 600; margin-bottom: 0.5rem;">${file.name}</div>
            <div style="font-size: 0.9rem; opacity: 0.7;">${file.size}</div>
        </div>
    `).join('');
}

// ====================
// –ò–ì–†–´
// ====================
// Counter-Strike 3D
function startCSGame() {
    document.getElementById('cs-game').style.display = 'block';
    initCSGame();
}

function initCSGame() {
    const canvas = document.getElementById('cs-canvas');
    
    // –°—Ü–µ–Ω–∞
    csScene = new THREE.Scene();
    csScene.background = new THREE.Color(0x111122);
    
    // –ö–∞–º–µ—Ä–∞
    csCamera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
    csCamera.position.set(0, 10, 20);
    csCamera.lookAt(0, 0, 0);
    
    // –†–µ–Ω–¥–µ—Ä–µ—Ä
    csRenderer = new THREE.WebGLRenderer({ canvas, antialias: true });
    csRenderer.setSize(canvas.clientWidth, canvas.clientHeight);
    csRenderer.shadowMap.enabled = true;
    
    // –û—Å–≤–µ—â–µ–Ω–∏–µ
    const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
    csScene.add(ambientLight);
    
    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
    directionalLight.position.set(10, 20, 10);
    directionalLight.castShadow = true;
    csScene.add(directionalLight);
    
    // –ü–æ–ª (–∫–∞—Ä—Ç–∞ Dust 2)
    createMapDust2();
    
    // –ò–≥—Ä–æ–∫
    createPlayer();
    
    // –ë–æ—Ç—ã
    createBots();
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    setupCSControls();
    
    // –ê–Ω–∏–º–∞—Ü–∏—è
    animateCS();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º HUD
    updateCSHUD();
}

function createMapDust2() {
    // –ü–æ–ª
    const floorGeometry = new THREE.PlaneGeometry(100, 100);
    const floorTexture = createGridTexture(100, 100);
    const floorMaterial = new THREE.MeshPhongMaterial({ map: floorTexture });
    const floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.rotation.x = -Math.PI / 2;
    floor.receiveShadow = true;
    csScene.add(floor);
    
    // –°—Ç–µ–Ω—ã –∫–∞—Ä—Ç—ã Dust 2
    const wallMaterial = new THREE.MeshPhongMaterial({ color: 0x8B4513 });
    
    // –í–Ω–µ—à–Ω–∏–µ —Å—Ç–µ–Ω—ã
    const wallPositions = [
        { x: 0, z: -40, width: 80, height: 10, depth: 2 }, // –°–µ–≤–µ—Ä
        { x: 0, z: 40, width: 80, height: 10, depth: 2 }, // –Æ–≥
        { x: -40, z: 0, width: 2, height: 10, depth: 80 }, // –ó–∞–ø–∞–¥
        { x: 40, z: 0, width: 2, height: 10, depth: 80 } // –í–æ—Å—Ç–æ–∫
    ];
    
    wallPositions.forEach(pos => {
        const geometry = new THREE.BoxGeometry(pos.width, pos.height, pos.depth);
        const wall = new THREE.Mesh(geometry, wallMaterial);
        wall.position.set(pos.x, pos.height/2, pos.z);
        wall.castShadow = true;
        wall.receiveShadow = true;
        csWalls.push(wall);
        csScene.add(wall);
    });
    
    // –ó–¥–∞–Ω–∏—è –∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
    const obstacles = [
        { x: -20, z: -20, size: [8, 6, 8] }, // –ë–æ–º–±–∞ A
        { x: 20, z: 20, size: [8, 6, 8] }, // –ë–æ–º–±–∞ B
        { x: -10, z: 10, size: [4, 4, 4] },
        { x: 10, z: -10, size: [4, 4, 4] }
    ];
    
    obstacles.forEach(obs => {
        const geometry = new THREE.BoxGeometry(...obs.size);
        const material = new THREE.MeshPhongMaterial({ color: 0xA0522D });
        const obstacle = new THREE.Mesh(geometry, material);
        obstacle.position.set(obs.x, obs.size[1]/2, obs.z);
        obstacle.castShadow = true;
        obstacle.receiveShadow = true;
        csWalls.push(obstacle);
        csScene.add(obstacle);
    });
    
    // –Ø—â–∏–∫–∏ (–∫–∞–∫ –≤ CS)
    for (let i = 0; i < 10; i++) {
        const geometry = new THREE.BoxGeometry(2, 2, 2);
        const material = new THREE.MeshPhongMaterial({ 
            color: Math.random() > 0.5 ? 0x8B4513 : 0xA0522D 
        });
        const box = new THREE.Mesh(geometry, material);
        box.position.set(
            (Math.random() - 0.5) * 70,
            1,
            (Math.random() - 0.5) * 70
        );
        box.castShadow = true;
        box.receiveShadow = true;
        csWalls.push(box);
        csScene.add(box);
    }
}

function createGridTexture(width, height) {
    const canvas = document.createElement('canvas');
    canvas.width = width * 10;
    canvas.height = height * 10;
    const ctx = canvas.getContext('2d');
    
    // –¢–µ–∫—Å—Ç—É—Ä–∞ –∑–µ–º–ª–∏
    ctx.fillStyle = '#8B7355';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // –°–µ—Ç–∫–∞
    ctx.strokeStyle = '#6B5B45';
    ctx.lineWidth = 2;
    
    for (let i = 0; i <= canvas.width; i += 100) {
        ctx.beginPath();
        ctx.moveTo(i, 0);
        ctx.lineTo(i, canvas.height);
        ctx.stroke();
    }
    
    for (let i = 0; i <= canvas.height; i += 100) {
        ctx.beginPath();
        ctx.moveTo(0, i);
        ctx.lineTo(canvas.width, i);
        ctx.stroke();
    }
    
    const texture = new THREE.CanvasTexture(canvas);
    texture.wrapS = THREE.RepeatWrapping;
    texture.wrapT = THREE.RepeatWrapping;
    texture.repeat.set(10, 10);
    return texture;
}

function createPlayer() {
    // –¢–µ–ª–æ –∏–≥—Ä–æ–∫–∞
    const bodyGeometry = new THREE.BoxGeometry(1, 2, 1);
    const bodyMaterial = new THREE.MeshPhongMaterial({ color: 0x00ff00 });
    csPlayer = new THREE.Mesh(bodyGeometry, bodyMaterial);
    csPlayer.position.y = 1;
    csPlayer.castShadow = true;
    csScene.add(csPlayer);
    
    // –ì–æ–ª–æ–≤–∞
    const headGeometry = new THREE.SphereGeometry(0.5);
    const headMaterial = new THREE.MeshPhongMaterial({ color: 0x00cc00 });
    const head = new THREE.Mesh(headGeometry, headMaterial);
    head.position.y = 2.5;
    csPlayer.add(head);
}

function createBots() {
    for (let i = 0; i < 3; i++) {
        const geometry = new THREE.BoxGeometry(1, 2, 1);
        const material = new THREE.MeshPhongMaterial({ color: 0xff0000 });
        const bot = new THREE.Mesh(geometry, material);
        
        bot.position.set(
            (Math.random() - 0.5) * 60,
            1,
            (Math.random() - 0.5) * 60
        );
        
        bot.userData = {
            health: 100,
            type: 'bot',
            speed: 0.03 + Math.random() * 0.02
        };
        
        bot.castShadow = true;
        csScene.add(bot);
        csBots.push(bot);
    }
}

function setupCSControls() {
    const keys = {};
    
    window.addEventListener('keydown', (e) => {
        keys[e.key.toLowerCase()] = true;
        
        // –í—ã—Å—Ç—Ä–µ–ª
        if (e.key === ' ' || e.key === 'f') {
            shoot();
        }
        
        // –í—ã—Ö–æ–¥
        if (e.key === 'Escape') {
            exitCSGame();
        }
        
        // –ü–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞
        if (e.key === 'r') {
            reload();
        }
    });
    
    window.addEventListener('keyup', (e) => {
        keys[e.key.toLowerCase()] = false;
    });
    
    // –î–≤–∏–∂–µ–Ω–∏–µ
    function updateMovement() {
        const speed = 0.2;
        
        if (keys['w']) csPlayer.position.z -= speed;
        if (keys['s']) csPlayer.position.z += speed;
        if (keys['a']) csPlayer.position.x -= speed;
        if (keys['d']) csPlayer.position.x += speed;
        
        // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
        csPlayer.position.x = Math.max(-38, Math.min(38, csPlayer.position.x));
        csPlayer.position.z = Math.max(-38, Math.min(38, csPlayer.position.z));
        
        // –ö–∞–º–µ—Ä–∞ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∏–≥—Ä–æ–∫–æ–º
        csCamera.position.x = csPlayer.position.x;
        csCamera.position.y = csPlayer.position.y + 5;
        csCamera.position.z = csPlayer.position.z + 10;
        csCamera.lookAt(csPlayer.position.x, csPlayer.position.y, csPlayer.position.z);
    }
    
    // –ê–Ω–∏–º–∞—Ü–∏—è
    function animateCS() {
        requestAnimationFrame(animateCS);
        
        updateMovement();
        updateBots();
        updateBullets();
        
        csRenderer.render(csScene, csCamera);
    }
    
    window.csAnimation = animateCS;
}

function updateBots() {
    csBots.forEach((bot, index) => {
        if (!bot.userData || bot.userData.health <= 0) return;
        
        // –î–≤–∏–∂–µ–Ω–∏–µ –∫ –∏–≥—Ä–æ–∫—É
        const dx = csPlayer.position.x - bot.position.x;
        const dz = csPlayer.position.z - bot.position.z;
        const distance = Math.sqrt(dx * dx + dz * dz);
        
        if (distance > 5) {
            bot.position.x += (dx / distance) * bot.userData.speed;
            bot.position.z += (dz / distance) * bot.userData.speed;
        }
        
        // –ü–æ–≤–æ—Ä–æ—Ç –∫ –∏–≥—Ä–æ–∫—É
        bot.lookAt(csPlayer.position);
        
        // –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–µ–ª—å–±–∞
        if (distance < 15 && Math.random() < 0.01) {
            botShoot(bot);
        }
    });
}

function shoot() {
    if (csAmmo <= 0) return;
    
    csAmmo--;
    updateCSHUD();
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –ø—É–ª–∏
    const geometry = new THREE.SphereGeometry(0.1);
    const material = new THREE.MeshBasicMaterial({ color: 0xffff00 });
    const bullet = new THREE.Mesh(geometry, material);
    
    // –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç –∫–∞–º–µ—Ä—ã
    const direction = new THREE.Vector3();
    csCamera.getWorldDirection(direction);
    
    bullet.position.copy(csCamera.position);
    bullet.userData = {
        velocity: direction.multiplyScalar(1),
        damage: 34,
        owner: 'player'
    };
    
    csBullets.push(bullet);
    csScene.add(bullet);
}

function botShoot(bot) {
    const geometry = new THREE.SphereGeometry(0.1);
    const material = new THREE.MeshBasicMaterial({ color: 0xff0000 });
    const bullet = new THREE.Mesh(geometry, material);
    
    const direction = new THREE.Vector3();
    direction.subVectors(csPlayer.position, bot.position).normalize();
    
    bullet.position.copy(bot.position);
    bullet.position.y += 1.5;
    
    bullet.userData = {
        velocity: direction.multiplyScalar(0.8),
        damage: 10,
        owner: 'bot'
    };
    
    csBullets.push(bullet);
    csScene.add(bullet);
}

function updateBullets() {
    for (let i = csBullets.length - 1; i >= 0; i--) {
        const bullet = csBullets[i];
        bullet.position.add(bullet.userData.velocity);
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–¥–∞–Ω–∏—è
        let hit = false;
        
        // –í –±–æ—Ç–æ–≤ (–æ—Ç –∏–≥—Ä–æ–∫–∞)
        if (bullet.userData.owner === 'player') {
            csBots.forEach((bot, botIndex) => {
                const distance = bullet.position.distanceTo(bot.position);
                if (distance < 1.5) {
                    bot.userData.health -= bullet.userData.damage;
                    
                    if (bot.userData.health <= 0) {
                        // –£–±–∏–π—Å—Ç–≤–æ
                        csKills++;
                        csMoney += 300;
                        platformData.games.cs.kills = (platformData.games.cs.kills || 0) + 1;
                        saveData();
                        
                        // –£–¥–∞–ª—è–µ–º –±–æ—Ç–∞
                        csScene.remove(bot);
                        csBots.splice(botIndex, 1);
                        
                        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                        setTimeout(() => {
                            if (csBots.length < 5) {
                                createBots();
                            }
                        }, 2000);
                    }
                    hit = true;
                }
            });
        }
        
        // –í –∏–≥—Ä–æ–∫–∞ (–æ—Ç –±–æ—Ç–æ–≤)
        if (bullet.userData.owner === 'bot') {
            const distance = bullet.position.distanceTo(csPlayer.position);
            if (distance < 1.5) {
                csHealth -= bullet.userData.damage;
                updateCSHUD();
                
                if (csHealth <= 0) {
                    csHealth = 0;
                    platformData.games.cs.deaths = (platformData.games.cs.deaths || 0) + 1;
                    saveData();
                    alert('üíÄ –í—ã —É–º–µ—Ä–ª–∏! –ù–∞–∂–º–∏—Ç–µ OK –¥–ª—è –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è.');
                    csHealth = 100;
                    csPlayer.position.set(0, 1, 0);
                }
                hit = true;
            }
        }
        
        // –í —Å—Ç–µ–Ω—ã
        csWalls.forEach(wall => {
            const distance = bullet.position.distanceTo(wall.position);
            if (distance < 3) {
                hit = true;
            }
        });
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏ –∏–ª–∏ –¥–∞–ª–µ–∫–æ
        if (hit || bullet.position.distanceTo(csPlayer.position) > 100) {
            csScene.remove(bullet);
            csBullets.splice(i, 1);
        }
    }
}

function selectWeapon(weapon) {
    currentWeapon = weapon;
    document.querySelectorAll('.cs-weapon-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Ç—Ä–æ–Ω—ã
    switch(weapon) {
        case 'akm': csAmmo = 30; break;
        case 'awp': csAmmo = 10; break;
        case 'glock': csAmmo = 20; break;
        case 'deagle': csAmmo = 7; break;
    }
    updateCSHUD();
}

function reload() {
    csAmmo = currentWeapon === 'akm' ? 30 : 
              currentWeapon === 'awp' ? 10 :
              currentWeapon === 'glock' ? 20 : 7;
    updateCSHUD();
}

function updateCSHUD() {
    document.getElementById('cs-health').textContent = `‚ù§Ô∏è ${csHealth}`;
    document.getElementById('cs-money').textContent = `üí∞ $${csMoney}`;
    document.getElementById('cs-kills').textContent = `üéØ ${csKills} —É–±–∏–π—Å—Ç–≤`;
    document.getElementById('cs-ammo').textContent = `üî´ ${csAmmo}`;
}

function exitCSGame() {
    document.getElementById('cs-game').style.display = 'none';
    
    // –û—á–∏—â–∞–µ–º —Å—Ü–µ–Ω—É
    if (csScene) {
        while(csScene.children.length > 0) {
            csScene.remove(csScene.children[0]);
        }
    }
    csBots = [];
    csBullets = [];
    csWalls = [];
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    csHealth = 100;
    csMoney = 800;
    csKills = 0;
    csAmmo = 30;
}

// –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏
let ticBoard = ['', '', '', '', '', '', '', '', ''];
let ticCurrentPlayer = 'X';
let ticGameActive = true;

function startTicTacToe() {
    showModal('tic-modal');
    initTicTacToe();
}

function initTicTacToe() {
    const board = document.getElementById('tic-board');
    board.innerHTML = '';
    
    for (let i = 0; i < 9; i++) {
        const cell = document.createElement('div');
        cell.className = 'tic-cell';
        cell.dataset.index = i;
        cell.onclick = () => makeMove(i);
        board.appendChild(cell);
    }
    
    document.getElementById('tic-status').textContent = `–•–æ–¥ –∏–≥—Ä–æ–∫–∞: ${ticCurrentPlayer}`;
}

function makeMove(index) {
    if (!ticGameActive || ticBoard[index] !== '') return;
    
    ticBoard[index] = ticCurrentPlayer;
    const cell = document.querySelector(`.tic-cell[data-index="${index}"]`);
    cell.textContent = ticCurrentPlayer;
    cell.classList.add(ticCurrentPlayer.toLowerCase());
    
    if (checkWin()) {
        document.getElementById('tic-status').textContent = `üèÜ –ü–æ–±–µ–¥–∏–ª ${ticCurrentPlayer}!`;
        ticGameActive = false;
        if (ticCurrentPlayer === 'X') {
            platformData.games.tic.wins = (platformData.games.tic.wins || 0) + 1;
        }
        saveData();
        return;
    }
    
    if (isBoardFull()) {
        document.getElementById('tic-status').textContent = 'ü§ù –ù–∏—á—å—è!';
        ticGameActive = false;
        return;
    }
    
    ticCurrentPlayer = ticCurrentPlayer === 'X' ? 'O' : 'X';
    document.getElementById('tic-status').textContent = `–•–æ–¥ –∏–≥—Ä–æ–∫–∞: ${ticCurrentPlayer}`;
    
    // –•–æ–¥ –±–æ—Ç–∞
    if (ticCurrentPlayer === 'O') {
        setTimeout(makeBotMove, 500);
    }
}

function makeBotMove() {
    // –ü—Ä–æ—Å—Ç–æ–π AI: —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ø—Ä–æ–±—É–µ–º –≤—ã–∏–≥—Ä–∞—Ç—å, –ø–æ—Ç–æ–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, –ø–æ—Ç–æ–º —Å–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
    
    // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—ã–∏–≥—Ä—ã—à
    for (let i = 0; i < 9; i++) {
        if (ticBoard[i] === '' && checkMoveWin('O', i)) {
            makeMove(i);
            return;
        }
    }
    
    // 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–≥—Ä–æ–∫–∞
    for (let i = 0; i < 9; i++) {
        if (ticBoard[i] === '' && checkMoveWin('X', i)) {
            makeMove(i);
            return;
        }
    }
    
    // 3. –°–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
    const availableMoves = ticBoard.map((cell, index) => cell === '' ? index : -1).filter(i => i !== -1);
    if (availableMoves.length > 0) {
        const randomMove = availableMoves[Math.floor(Math.random() * availableMoves.length)];
        makeMove(randomMove);
    }
}

function checkMoveWin(player, move) {
    const tempBoard = [...ticBoard];
    tempBoard[move] = player;
    
    const winPatterns = [
        [0,1,2], [3,4,5], [6,7,8], // rows
        [0,3,6], [1,4,7], [2,5,8], // columns
        [0,4,8], [2,4,6] // diagonals
    ];
    
    return winPatterns.some(pattern => {
        const [a,b,c] = pattern;
        return tempBoard[a] === player && tempBoard[b] === player && tempBoard[c] === player;
    });
}

function checkWin() {
    return checkMoveWin(ticCurrentPlayer, -1);
}

function isBoardFull() {
    return ticBoard.every(cell => cell !== '');
}

function resetTicTacToe() {
    ticBoard = ['', '', '', '', '', '', '', '', ''];
    ticCurrentPlayer = 'X';
    ticGameActive = true;
    initTicTacToe();
}

// –ö–ª–∏–∫–µ—Ä
let clickerMoney = 0;
let clickerClickPower = 1;
let clickerAutoClicker = 0;

function startClicker() {
    showModal('clicker-modal');
    loadClickerData();
}

function loadClickerData() {
    const data = platformData.games.clicker;
    clickerMoney = data.money || 0;
    clickerClickPower = data.clickPower || 1;
    clickerAutoClicker = data.autoClicker || 0;
    
    updateClickerDisplay();
    
    // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
    if (clickerAutoClicker > 0 && !window.autoClickerInterval) {
        startAutoClicker();
    }
}

function clickMoney() {
    clickerMoney += clickerClickPower;
    updateClickerDisplay();
    saveClickerData();
}

function buyUpgrade(type) {
    const costs = {
        click: 10 * Math.pow(2, clickerClickPower - 1),
        auto: 100 * Math.pow(2, clickerAutoClicker)
    };
    
    const cost = costs[type];
    
    if (clickerMoney >= cost) {
        clickerMoney -= cost;
        
        if (type === 'click') {
            clickerClickPower++;
        } else if (type === 'auto') {
            clickerAutoClicker++;
            if (!window.autoClickerInterval) {
                startAutoClicker();
            }
        }
        
        updateClickerDisplay();
        saveClickerData();
    } else {
        alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
    }
}

function startAutoClicker() {
    if (window.autoClickerInterval) {
        clearInterval(window.autoClickerInterval);
    }
    
    window.autoClickerInterval = setInterval(() => {
        clickerMoney += clickerAutoClicker * 0.5;
        updateClickerDisplay();
        saveClickerData();
    }, 1000);
}

function updateClickerDisplay() {
    document.getElementById('clicker-money').textContent = `$${clickerMoney.toFixed(2)}`;
}

function saveClickerData() {
    platformData.games.clicker = {
        money: clickerMoney,
        clickPower: clickerClickPower,
        autoClicker: clickerAutoClicker
    };
    saveData();
}

// ====================
// –ö–ê–†–¢–´ (Leaflet OpenStreetMap)
// ====================
function initMap() {
    map = L.map('map').setView([55.7558, 37.6173], 13); // –ú–æ—Å–∫–≤–∞
    
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap contributors',
        maxZoom: 19
    }).addTo(map);
    
    // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä
    L.marker([55.7558, 37.6173]).addTo(map)
        .bindPopup('–ú–æ—Å–∫–≤–∞, –†–æ—Å—Å–∏—è')
        .openPopup();
}

function findMyLocation() {
    if (!navigator.geolocation) {
        alert('–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º');
        return;
    }
    
    navigator.geolocation.getCurrentPosition(
        (position) => {
            const lat = position.coords.latitude;
            const lng = position.coords.longitude;
            
            map.setView([lat, lng], 15);
            
            L.marker([lat, lng]).addTo(map)
                .bindPopup('–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ')
                .openPopup();
        },
        () => {
            alert('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ');
        }
    );
}

function searchLocation() {
    const query = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞:');
    if (!query) return;
    
    // –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º –º–µ—Å—Ç–∞–º
    const locations = {
        '–º–æ—Å–∫–≤–∞': [55.7558, 37.6173],
        '–¥—É–±–∞–π': [25.2048, 55.2708],
        '–∫–∏–µ–≤': [50.4501, 30.5234],
        '–ø–∞—Ä–∏–∂': [48.8566, 2.3522],
        '–±–µ—Ä–ª–∏–Ω': [52.5200, 13.4050],
        '—Ç–æ–∫–∏–æ': [35.6762, 139.6503],
        '–ø–µ–∫–∏–Ω': [39.9042, 116.4074]
    };
    
    const loc = locations[query.toLowerCase()];
    if (loc) {
        map.setView(loc, 13);
        L.marker(loc).addTo(map)
            .bindPopup(query.charAt(0).toUpperCase() + query.slice(1))
            .openPopup();
    } else {
        alert('–ú–µ—Å—Ç–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –±–∞–∑–µ');
    }
}

// ====================
// –ü–ï–†–ï–í–û–î–ß–ò–ö (—É–ª—É—á—à–µ–Ω–Ω—ã–π)
// ====================
const translationDictionary = {
    // –†—É—Å—Å–∫–∏–π -> –ê–Ω–≥–ª–∏–π—Å–∫–∏–π
    'ru-en': {
        '–ø—Ä–∏–≤–µ—Ç': 'hello',
        '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ': 'hello',
        '–∫–∞–∫ –¥–µ–ª–∞': 'how are you',
        '—Å–ø–∞—Å–∏–±–æ': 'thank you',
        '–ø–æ–∂–∞–ª—É–π—Å—Ç–∞': 'you are welcome',
        '–¥–∞': 'yes',
        '–Ω–µ—Ç': 'no',
        '—Ö–æ—Ä–æ—à–æ': 'good',
        '–ø–ª–æ—Ö–æ': 'bad',
        '—è': 'i',
        '—Ç—ã': 'you',
        '–º—ã': 'we',
        '–æ–Ω–∏': 'they',
        '–¥–æ–º': 'house',
        '–º–∞—à–∏–Ω–∞': 'car',
        '–∫–æ–º–ø—å—é—Ç–µ—Ä': 'computer',
        '–∏–≥—Ä–∞': 'game',
        '–¥–µ–Ω—å–≥–∏': 'money',
        '—Ä–∞–±–æ—Ç–∞': 'work',
        '–ª—é–±–æ–≤—å': 'love',
        '—Å–µ–º—å—è': 'family',
        '–¥—Ä—É–≥': 'friend'
    },
    // –ê–Ω–≥–ª–∏–π—Å–∫–∏–π -> –†—É—Å—Å–∫–∏–π
    'en-ru': {
        'hello': '–ø—Ä–∏–≤–µ—Ç',
        'hi': '–ø—Ä–∏–≤–µ—Ç',
        'how are you': '–∫–∞–∫ –¥–µ–ª–∞',
        'thank you': '—Å–ø–∞—Å–∏–±–æ',
        'thanks': '—Å–ø–∞—Å–∏–±–æ',
        'you are welcome': '–ø–æ–∂–∞–ª—É–π—Å—Ç–∞',
        'yes': '–¥–∞',
        'no': '–Ω–µ—Ç',
        'good': '—Ö–æ—Ä–æ—à–æ',
        'bad': '–ø–ª–æ—Ö–æ',
        'i': '—è',
        'you': '—Ç—ã',
        'we': '–º—ã',
        'they': '–æ–Ω–∏',
        'house': '–¥–æ–º',
        'car': '–º–∞—à–∏–Ω–∞',
        'computer': '–∫–æ–º–ø—å—é—Ç–µ—Ä',
        'game': '–∏–≥—Ä–∞',
        'money': '–¥–µ–Ω—å–≥–∏',
        'work': '—Ä–∞–±–æ—Ç–∞',
        'love': '–ª—é–±–æ–≤—å',
        'family': '—Å–µ–º—å—è',
        'friend': '–¥—Ä—É–≥'
    },
    // –†—É—Å—Å–∫–∏–π -> –ö–∏—Ç–∞–π—Å–∫–∏–π
    'ru-zh': {
        '–ø—Ä–∏–≤–µ—Ç': '‰Ω†Â•Ω',
        '—Å–ø–∞—Å–∏–±–æ': 'Ë∞¢Ë∞¢',
        '–¥–∞': 'ÊòØ',
        '–Ω–µ—Ç': 'Ê≤°Êúâ',
        '—è': 'Êàë',
        '—Ç—ã': '‰Ω†',
        '–¥–µ–Ω—å–≥–∏': 'Èí±'
    },
    // –ö–∏—Ç–∞–π—Å–∫–∏–π -> –†—É—Å—Å–∫–∏–π
    'zh-ru': {
        '‰Ω†Â•Ω': '–ø—Ä–∏–≤–µ—Ç',
        'Ë∞¢Ë∞¢': '—Å–ø–∞—Å–∏–±–æ',
        'ÊòØ': '–¥–∞',
        'Ê≤°Êúâ': '–Ω–µ—Ç',
        'Êàë': '—è',
        '‰Ω†': '—Ç—ã',
        'Èí±': '–¥–µ–Ω—å–≥–∏'
    }
};

function swapLanguages() {
    const from = document.getElementById('lang-from');
    const to = document.getElementById('lang-to');
    const temp = from.value;
    from.value = to.value;
    to.value = temp;
    translateText();
}

function translateText() {
    const text = document.getElementById('input-text').value.trim();
    const from = document.getElementById('lang-from').value;
    const to = document.getElementById('lang-to').value;
    
    if (!text) {
        document.getElementById('output-text').value = '';
        return;
    }
    
    const key = `${from}-${to}`;
    const dict = translationDictionary[key];
    
    if (dict) {
        // –ü—Ä–æ—Å—Ç–æ–π –ø–æ-—Å–ª–æ–≤–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥
        const words = text.toLowerCase().split(' ');
        const translatedWords = words.map(word => {
            // –ò—â–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
            if (dict[word]) return dict[word];
            
            // –ò—â–µ–º —á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
            for (const [key, value] of Object.entries(dict)) {
                if (key.includes(word) || word.includes(key)) {
                    return value;
                }
            }
            
            return word; // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏, –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
        });
        
        document.getElementById('output-text').value = translatedWords.join(' ');
    } else {
        // –ï—Å–ª–∏ –Ω–µ—Ç —Å–ª–æ–≤–∞—Ä—è –¥–ª—è —ç—Ç–æ–π –ø–∞—Ä—ã —è–∑—ã–∫–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Å–µ–≤–¥–æ–ø–µ—Ä–µ–≤–æ–¥
        const pseudoTranslated = text.split('').map((char, i) => {
            if (Math.random() > 0.7 && i > 0) {
                return char.toUpperCase();
            }
            return char;
        }).join('');
        
        document.getElementById('output-text').value = `[–ü–ï–†–ï–í–û–î]: ${pseudoTranslated}`;
    }
}

function speakTranslation() {
    const text = document.getElementById('output-text').value;
    if (!text) return;
    
    if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = document.getElementById('lang-to').value;
        utterance.rate = 0.9;
        utterance.pitch = 1.0;
        speechSynthesis.speak(utterance);
    } else {
        alert('–ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏');
    }
}

function startVoiceInput() {
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.lang = document.getElementById('lang-from').value;
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;
        
        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            document.getElementById('input-text').value = transcript;
            translateText();
        };
        
        recognition.onerror = (event) => {
            console.error('–û—à–∏–±–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è:', event.error);
        };
        
        recognition.start();
    } else {
        alert('–ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏');
    }
}

// ====================
// –ß–ê–°–´ –ú–ò–†–ê
// ====================
const timezones = {
    '–ú–æ—Å–∫–≤–∞': 'Europe/Moscow',
    '–î—É–±–∞–π': 'Asia/Dubai',
    '–ö–∏–µ–≤': 'Europe/Kiev',
    '–ü–∞—Ä–∏–∂': 'Europe/Paris',
    '–ë–µ—Ä–ª–∏–Ω': 'Europe/Berlin',
    '–¢–æ–∫–∏–æ': 'Asia/Tokyo',
    '–ü–µ–∫–∏–Ω': 'Asia/Shanghai',
    '–°–µ—É–ª': 'Asia/Seoul',
    '–¢–∞—à–∫–µ–Ω—Ç': 'Asia/Tashkent'
};

function initWorldClocks() {
    const container = document.getElementById('clocks-container');
    container.innerHTML = '';
    
    Object.keys(timezones).forEach(city => {
        const card = document.createElement('div');
        card.className = 'clock-card';
        card.innerHTML = `
            <div class="clock-city">${city}</div>
            <div class="clock-time" id="clock-${city}">00:00:00</div>
            <div class="clock-date" id="date-${city}">1 —è–Ω–≤–∞—Ä—è 2024</div>
        `;
        container.appendChild(card);
    });
    
    updateClocks();
    setInterval(updateClocks, 1000);
}

function updateClocks() {
    const now = new Date();
    
    Object.keys(timezones).forEach(city => {
        try {
            const timeString = now.toLocaleTimeString('ru-RU', { timeZone: timezones[city], hour12: false });
            const dateString = now.toLocaleDateString('ru-RU', { 
                timeZone: timezones[city],
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            document.getElementById(`clock-${city}`).textContent = timeString;
            document.getElementById(`date-${city}`).textContent = dateString;
        } catch (e) {
            console.log(`–û—à–∏–±–∫–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ –¥–ª—è ${city}:`, e);
            document.getElementById(`clock-${city}`).textContent = now.toLocaleTimeString();
            document.getElementById(`date-${city}`).textContent = now.toLocaleDateString();
        }
    });
}

// ====================
// –ß–ê–¢-–ë–û–¢ AI
// ====================
const botResponses = {
    '–ø—Ä–∏–≤–µ—Ç': ['–ü—Ä–∏–≤–µ—Ç! üòä', '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!', '–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é!'],
    '–∫–∞–∫ –¥–µ–ª–∞': ['–û—Ç–ª–∏—á–Ω–æ, —Å–ø–∞—Å–∏–±–æ! –ê —É –≤–∞—Å?', '–•–æ—Ä–æ—à–æ, —Ä–∞–±–æ—Ç–∞—é –Ω–∞–¥ –æ—Ç–≤–µ—Ç–∞–º–∏!', '–í—Å—ë –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ!'],
    '—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å': [
        '–Ø –º–æ–≥—É: –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç, –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞—Ä—Ç—ã, –∏–≥—Ä–∞—Ç—å —Å –≤–∞–º–∏ –≤ –∏–≥—Ä—ã, –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã!',
        '–ú–æ–∏ —Ñ—É–Ω–∫—Ü–∏–∏: –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫, –ö–∞—Ä—Ç—ã, –ò–≥—Ä—ã (CS, –∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏, –∫–ª–∏–∫–µ—Ä), –ß–∞—Å—ã –º–∏—Ä–∞, –ß–∞—Ç —Å –ò–ò!',
        '–Ø –≤–∞—à —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫: –ø–µ—Ä–µ–≤–æ–¥, –∫–∞—Ä—Ç—ã, –∏–≥—Ä—ã –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!'
    ],
    '—Å–ø–∞—Å–∏–±–æ': ['–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! üòä', '–í—Å–µ–≥–¥–∞ —Ä–∞–¥ –ø–æ–º–æ—á—å!', '–û–±—Ä–∞—â–∞–π—Ç–µ—Å—å!'],
    '–ø–æ–∫–∞': ['–î–æ —Å–≤–∏–¥–∞–Ω–∏—è! üëã', '–í—Å–µ–≥–æ —Ö–æ—Ä–æ—à–µ–≥–æ!', '–í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å!'],
    '–∏–≥—Ä–∞': ['–£ –Ω–∞—Å –µ—Å—Ç—å: Counter-Strike 3D, –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏, –ö–ª–∏–∫–µ—Ä! –í –∫–∞–∫—É—é —Ö–æ—Ç–∏—Ç–µ?', '–ò–≥—Ä—ã: CS 3D, –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏, –ö–ª–∏–∫–µ—Ä —Å –ø–∏—Ç–æ–º—Ü–∞–º–∏!'],
    '–ø–µ—Ä–µ–≤–æ–¥': ['–Ø –ø–µ—Ä–µ–≤–æ–∂—É —Å —Ä—É—Å—Å–∫–æ–≥–æ, –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ, –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ –∏ –∞—Ä–∞–±—Å–∫–æ–≥–æ. –ß—Ç–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏?', '–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 4 —è–∑—ã–∫–∞. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç!'],
    '–∫–∞—Ä—Ç–∞': ['–ö–∞—Ä—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ OpenStreetMap. –ú–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –ª—é–±–æ–µ –º–µ—Å—Ç–æ!', '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞—Ä—Ç—É –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏–ª–∏ –ø–æ–∏—Å–∫–∞ –º–µ—Å—Ç!'],
    '–≤—Ä–µ–º—è': ['–ü–æ–∫–∞–∑—ã–≤–∞—é –≤—Ä–µ–º—è –≤ 9 –≥–æ—Ä–æ–¥–∞—Ö –º–∏—Ä–∞!', '–ß–∞—Å—ã –º–∏—Ä–∞: –ú–æ—Å–∫–≤–∞, –î—É–±–∞–π, –ö–∏–µ–≤, –ü–∞—Ä–∏–∂, –ë–µ—Ä–ª–∏–Ω, –¢–æ–∫–∏–æ, –ü–µ–∫–∏–Ω, –°–µ—É–ª, –¢–∞—à–∫–µ–Ω—Ç']
};

function sendChatMessage() {
    const input = document.getElementById('chat-input');
    const message = input.value.trim();
    
    if (!message) return;
    
    addChatMessage(message, 'user');
    input.value = '';
    
    // –û—Ç–≤–µ—Ç –±–æ—Ç–∞
    setTimeout(() => {
        const response = getBotResponse(message.toLowerCase());
        addChatMessage(response, 'bot');
    }, 500);
}

function getBotResponse(message) {
    // –ò—â–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
    for (const [key, responses] of Object.entries(botResponses)) {
        if (message.includes(key)) {
            return responses[Math.floor(Math.random() * responses.length)];
        }
    }
    
    // –ï—Å–ª–∏ –Ω–µ—Ç —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—â–∏–µ –æ—Ç–≤–µ—Ç—ã
    const genericResponses = [
        '–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.',
        '–Ø –µ—â–µ —É—á—É—Å—å. –°–ø—Ä–æ—Å–∏—Ç–µ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ!',
        '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ-–¥—Ä—É–≥–æ–º—É.',
        '–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è –Ω–µ –∑–Ω–∞—é –æ—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å. –ù–æ —è —É—á—É—Å—å!',
        '–ú–æ–∂–µ—Ç–µ —Å–ø—Ä–æ—Å–∏—Ç—å –æ –ø–µ—Ä–µ–≤–æ–¥–µ, –∫–∞—Ä—Ç–∞—Ö –∏–ª–∏ –∏–≥—Ä–∞—Ö!'
    ];
    
    return genericResponses[Math.floor(Math.random() * genericResponses.length)];
}

function addChatMessage(text, sender) {
    const messages = document.getElementById('chat-messages');
    const message = document.createElement('div');
    message.className = `chat-message ${sender}`;
    message.textContent = text;
    messages.appendChild(message);
    messages.scrollTop = messages.scrollHeight;
}

// ====================
// –õ–ò–î–ï–†–ë–û–†–î
// ====================
function initLeaderboard() {
    updateLeaderboard();
}

function updateLeaderboard() {
    const leaderboard = document.getElementById('leaderboard-content');
    leaderboard.innerHTML = '';
    
    // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
    const players = Object.entries(platformData.users).map(([username, data]) => {
        const csScore = platformData.games.cs?.kills || 0;
        const ticScore = platformData.games.tic?.wins || 0;
        const clickerScore = platformData.games.clicker?.money || 0;
        
        const totalScore = csScore * 10 + ticScore * 100 + clickerScore / 1000;
        
        return {
            username,
            score: Math.round(totalScore),
            cs: csScore,
            tic: ticScore,
            clicker: clickerScore
        };
    });
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –æ—á–∫–∞–º
    players.sort((a, b) => b.score - a.score);
    
    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ–ø-10
    players.slice(0, 10).forEach((player, index) => {
        const row = document.createElement('div');
        row.className = 'leaderboard-row';
        
        const rankClass = index < 3 ? `rank-${index + 1}` : 'rank-other';
        
        row.innerHTML = `
            <div>
                <div class="rank-badge ${rankClass}">${index + 1}</div>
            </div>
            <div>${player.username}</div>
            <div>${player.score}</div>
            <div>CS:${player.cs} T:${player.tic} C:$${Math.round(player.clicker)}</div>
        `;
        
        leaderboard.appendChild(row);
    });
}

// ====================
// –ù–ê–°–¢–†–û–ô–ö–ò
// ====================
function openSettings() {
    showModal('settings-modal');
}

function setTheme(theme) {
    document.body.setAttribute('data-theme', theme);
    platformData.settings.theme = theme;
    saveData();
    
    document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
    event?.target.classList.add('active');
}

function exportData() {
    const dataStr = JSON.stringify(platformData);
    const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
    
    const link = document.createElement('a');
    link.setAttribute('href', dataUri);
    link.setAttribute('download', 'ultra-platform-backup.json');
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    
    alert('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
}

function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'application/json';
    
    input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = e => {
            try {
                const data = JSON.parse(e.target.result);
                Object.assign(platformData, data);
                saveData();
                alert('–î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞.');
                location.reload();
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ: ' + error.message);
            }
        };
        
        reader.readAsText(file);
    };
    
    input.click();
}

function clearData() {
    if (confirm('–í–ù–ò–ú–ê–ù–ò–ï! –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
        localStorage.clear();
        alert('–î–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è.');
        location.reload();
    }
}

// ====================
// –£–¢–ò–õ–ò–¢–´
// ====================
function showModal(modalId) {
    document.getElementById(modalId).style.display = 'flex';
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
}

function saveData() {
    localStorage.setItem('ultra_platform_v2', JSON.stringify(platformData));
}

function setupEventListeners() {
    // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º
    document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            const pageId = tab.dataset.page;
            
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            
            tab.classList.add('active');
            document.getElementById(pageId).classList.add('active');
        });
    });
    
    // –í–∫–ª–∞–¥–∫–∏ –æ–±–ª–∞–∫–∞
    document.querySelectorAll('.cloud-subtab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.cloud-subtab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
        });
    });
    
    // –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫
    document.getElementById('input-text').addEventListener('input', translateText);
    
    // –ß–∞—Ç (Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏)
    document.getElementById('chat-input').addEventListener('keypress', e => {
        if (e.key === 'Enter') sendChatMessage();
    });
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞
    window.addEventListener('resize', () => {
        if (map) {
            map.invalidateSize();
        }
        
        if (csRenderer && csCamera) {
            const canvas = document.getElementById('cs-canvas');
            if (canvas) {
                csCamera.aspect = canvas.clientWidth / canvas.clientHeight;
                csCamera.updateProjectionMatrix();
                csRenderer.setSize(canvas.clientWidth, canvas.clientHeight);
            }
        }
    });
}

// ====================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
// ====================
window.addEventListener('load', () => {
    initUserSelection();
    
    // –û—á–∏—â–∞–µ–º –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ (—Å—Ç–∞—Ä—à–µ 5 –º–∏–Ω—É—Ç)
    const now = Date.now();
    Object.keys(platformData.online || {}).forEach(user => {
        if (now - platformData.online[user] > 5 * 60 * 1000) {
            delete platformData.online[user];
        }
    });
    saveData();
});
</script>
</body>
</html>

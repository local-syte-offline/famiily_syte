<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTRA PLATFORM</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #8B5CF6;
            --primary-dark: #7C3AED;
            --secondary: #EC4899;
            --success: #10B981;
            --danger: #EF4444;
            --warning: #F59E0B;
            --dark: #111827;
            --light: #F3F4F6;
            --gray: #6B7280;
            --background: #0F172A;
            --card: #1E293B;
            --border: #374151;
            --text: #E5E7EB;
        }

        [data-theme="light"] {
            --background: #F9FAFB;
            --card: #FFFFFF;
            --border: #E5E7EB;
            --text: #111827;
            --dark: #F3F4F6;
        }

        [data-theme="purple"] {
            --primary: #A855F7;
            --primary-dark: #9333EA;
            --secondary: #D946EF;
            --background: #1E1B4B;
            --card: #312E81;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }

        /* –°–Ω–µ–∂–∏–Ω–∫–∏ */
        .snowflake {
            position: fixed;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0.7;
            animation: fall linear forwards;
            z-index: 1000;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        /* –í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
        #user-select-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--background) 0%, #000 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .user-select-container {
            background: rgba(30, 41, 59, 0.95);
            padding: 3rem;
            border-radius: 24px;
            width: 90%;
            max-width: 600px;
            border: 2px solid var(--primary);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(20px);
        }

        .user-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .user-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 1.25rem;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.1rem;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .user-btn:hover {
            transform: translateY(-4px);
            border-color: var(--secondary);
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.3);
        }

        .user-btn.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.5);
        }

        .user-btn.occupied {
            border-color: var(--danger);
            color: var(--danger);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .user-btn.occupied::after {
            content: '–ó–ê–ù–Ø–¢';
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--danger);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2rem;
        }

        .action-btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .enter-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .enter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4);
        }

        .exit-btn {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 2px solid var(--danger);
        }

        .exit-btn:hover {
            background: var(--danger);
            color: white;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å */
        #main-interface {
            display: none;
            min-height: 100vh;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .navbar {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            padding: 0.5rem 0;
        }

        .nav-tab {
            background: transparent;
            border: 2px solid transparent;
            color: var(--text);
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            white-space: nowrap;
            opacity: 0.7;
        }

        .nav-tab:hover {
            opacity: 1;
            background: rgba(139, 92, 246, 0.1);
        }

        .nav-tab.active {
            background: var(--primary);
            color: white;
            opacity: 1;
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.3);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .settings-btn {
            background: rgba(139, 92, 246, 0.1);
            border: 2px solid var(--primary);
            color: var(--primary);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .settings-btn:hover {
            background: var(--primary);
            color: white;
            transform: rotate(90deg);
        }

        /* –°–µ–∫—Ü–∏–∏ */
        .section {
            display: none;
            padding: 2rem;
            animation: fadeIn 0.5s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* –û–±–ª–∞–∫–æ */
        .cloud-subtabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border);
            padding-bottom: 1rem;
        }

        .cloud-subtab {
            background: transparent;
            border: none;
            color: var(--text);
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            opacity: 0.7;
            transition: all 0.3s;
        }

        .cloud-subtab.active {
            background: var(--primary);
            color: white;
            opacity: 1;
        }

        .cloud-content {
            background: var(--card);
            border-radius: 20px;
            padding: 2rem;
            min-height: 400px;
            border: 1px solid var(--border);
        }

        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .file-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .file-item:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        /* –ò–≥—Ä—ã */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
        }

        .game-card {
            background: var(--card);
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .game-card:hover {
            transform: translateY(-8px);
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .game-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 2rem;
            text-align: center;
            color: white;
        }

        .game-body {
            padding: 1.5rem;
        }

        .game-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .play-btn {
            width: 100%;
            padding: 1rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .play-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.02);
        }

        /* 3D –∏–≥—Ä–∞ CS */
        .cs-game-container {
            width: 100%;
            height: 600px;
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            border: 3px solid var(--primary);
        }

        #cs-canvas {
            width: 100%;
            height: 100%;
        }

        .cs-hud {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            z-index: 10;
        }

        .cs-stats {
            background: rgba(0, 0, 0, 0.8);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
        }

        .cs-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .cs-tab {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .cs-tab.active {
            background: var(--primary);
            color: white;
        }

        /* –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ */
        .tic-tac-toe-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 2rem auto;
            max-width: 400px;
        }

        .tic-cell {
            aspect-ratio: 1;
            background: var(--card);
            border: 2px solid var(--primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tic-cell:hover {
            background: rgba(139, 92, 246, 0.1);
        }

        /* –ö–ª–∏–∫–µ—Ä */
        .clicker-game {
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
        }

        .clicker-display {
            font-size: 3.5rem;
            color: var(--success);
            margin: 2rem 0;
            font-weight: 700;
        }

        .clicker-btn {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            color: white;
            font-size: 1.25rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin: 2rem auto;
            display: block;
            box-shadow: 0 15px 35px rgba(139, 92, 246, 0.3);
        }

        .clicker-btn:active {
            transform: scale(0.95);
        }

        .upgrades-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .upgrade-item {
            background: var(--card);
            border-radius: 12px;
            padding: 1.25rem;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
        }

        .upgrade-item:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
        }

        /* –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ */
        .translator-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .lang-selectors {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
            align-items: center;
        }

        .lang-select {
            background: var(--card);
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 1rem;
            border-radius: 12px;
            font-size: 1rem;
        }

        .swap-btn {
            background: var(--primary);
            color: white;
            border: none;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
        }

        .swap-btn:hover {
            transform: rotate(180deg);
            background: var(--secondary);
        }

        .text-areas {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .text-area {
            background: var(--card);
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 1.25rem;
            border-radius: 12px;
            min-height: 180px;
            font-size: 1rem;
            resize: vertical;
            font-family: inherit;
        }

        .voice-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1.5rem;
        }

        .voice-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
            font-weight: 500;
        }

        .voice-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        /* –ß–∞—Å—ã */
        .clocks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }

        .clock-card {
            background: var(--card);
            padding: 2rem;
            border-radius: 20px;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .clock-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .clock-time {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 1rem 0;
            color: var(--primary);
        }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .setting-card {
            background: var(--card);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
        }

        .theme-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .theme-btn {
            padding: 1rem;
            border-radius: 12px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .theme-btn.active {
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
        }

        .theme-dark {
            background: #111827;
            color: white;
        }

        .theme-light {
            background: white;
            color: #111827;
        }

        .theme-purple {
            background: linear-gradient(135deg, #1E1B4B, #312E81);
            color: white;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border);
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        /* –ß–∞—Ç-–±–æ—Ç */
        .chat-container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card);
            border-radius: 20px;
            overflow: hidden;
            height: 600px;
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border);
        }

        .chat-messages {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            max-width: 70%;
            padding: 1rem 1.25rem;
            border-radius: 18px;
            animation: fadeIn 0.3s ease;
        }

        .message.user {
            background: var(--primary);
            color: white;
            align-self: flex-end;
        }

        .message.bot {
            background: rgba(255, 255, 255, 0.05);
            align-self: flex-start;
        }

        .chat-input-container {
            display: flex;
            gap: 1rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.05);
            border-top: 1px solid var(--border);
        }

        .chat-input {
            flex: 1;
            background: var(--card);
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 1rem 1.25rem;
            border-radius: 25px;
            font-size: 1rem;
            font-family: inherit;
        }

        .chat-send-btn {
            background: var(--primary);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-send-btn:hover {
            background: var(--secondary);
            transform: scale(1.05);
        }

        /* –õ–∏–¥–µ—Ä–±–æ—Ä–¥ */
        .leaderboard-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .leaderboard-table {
            background: var(--card);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .leaderboard-row {
            display: grid;
            grid-template-columns: 60px 1fr 100px 100px;
            padding: 1rem 1.5rem;
            align-items: center;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s;
        }

        .leaderboard-row:hover {
            background: rgba(139, 92, 246, 0.05);
        }

        .leaderboard-header {
            background: var(--primary);
            color: white;
            font-weight: 600;
        }

        .rank-badge {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .rank-1 { background: gold; color: #000; }
        .rank-2 { background: silver; color: #000; }
        .rank-3 { background: #CD7F32; color: #000; }
        .rank-other { background: var(--primary); color: white; }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .section { padding: 1rem; }
            .navbar { padding: 1rem; flex-direction: column; gap: 1rem; }
            .nav-tabs { width: 100%; justify-content: flex-start; }
            .games-grid { grid-template-columns: 1fr; }
            .text-areas { grid-template-columns: 1fr; }
            .lang-selectors { grid-template-columns: 1fr; }
            .clocks-grid { grid-template-columns: 1fr; }
            .leaderboard-row { grid-template-columns: 40px 1fr 80px 80px; padding: 0.75rem 1rem; }
            .user-grid { grid-template-columns: repeat(2, 1fr); }
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--card);
            border-radius: 20px;
            padding: 2.5rem;
            max-width: 500px;
            width: 90%;
            border: 2px solid var(--primary);
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* –£—Ç–∏–ª–∏—Ç—ã */
        .text-gradient {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-secondary:hover {
            background: var(--primary);
            color: white;
        }

        .hidden {
            display: none !important;
        }

        /* –ó–∞–≥—Ä—É–∑—á–∏–∫ */
        .loader {
            width: 48px;
            height: 48px;
            border: 3px solid var(--border);
            border-bottom-color: var(--primary);
            border-radius: 50%;
            animation: rotation 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- –í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="user-select-screen">
        <div class="user-select-container">
            <h1 style="text-align: center; margin-bottom: 1rem; font-size: 2.5rem;" class="text-gradient">ULTRA PLATFORM</h1>
            <p style="text-align: center; margin-bottom: 2rem; opacity: 0.8;">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
            
            <div class="user-grid" id="user-grid">
                <!-- –ö–Ω–æ–ø–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
            
            <div class="action-buttons">
                <button class="action-btn enter-btn" onclick="enterPlatform()">
                    <span>–í–æ–π—Ç–∏ –≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É</span>
                </button>
                <button class="action-btn exit-btn" onclick="exitPlatform()">
                    <span>–í—ã–π—Ç–∏ —Å —Å–∞–π—Ç–∞</span>
                </button>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div id="main-interface">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="navbar">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <div class="user-avatar" id="user-avatar">U</div>
                <div>
                    <div style="font-weight: 600;" id="current-username">–ì–æ—Å—Ç—å</div>
                    <div style="font-size: 0.9rem; opacity: 0.8;" id="user-balance">$0</div>
                </div>
            </div>
            
            <div class="nav-tabs">
                <button class="nav-tab active" data-tab="cloud">‚òÅÔ∏è –û–±–ª–∞–∫–æ</button>
                <button class="nav-tab" data-tab="games">üéÆ –ò–≥—Ä—ã</button>
                <button class="nav-tab" data-tab="maps">üó∫Ô∏è –ö–∞—Ä—Ç—ã</button>
                <button class="nav-tab" data-tab="translator">üî§ –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫</button>
                <button class="nav-tab" data-tab="clocks">‚è∞ –í—Ä–µ–º—è</button>
                <button class="nav-tab" data-tab="chatbot">ü§ñ –ß–∞—Ç-–±–æ—Ç</button>
                <button class="nav-tab" data-tab="leaderboard">üèÜ –õ–∏–¥–µ—Ä—ã</button>
            </div>
            
            <button class="settings-btn" onclick="toggleSettings()">‚öôÔ∏è</button>
        </nav>

        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
        <main>
            <!-- –û–±–ª–∞–∫–æ -->
            <section id="cloud" class="section active">
                <div class="cloud-subtabs">
                    <button class="cloud-subtab active" data-subtab="photos">üì∑ –§–æ—Ç–æ</button>
                    <button class="cloud-subtab" data-subtab="videos">üé¨ –í–∏–¥–µ–æ</button>
                    <button class="cloud-subtab" data-subtab="files">üìÅ –§–∞–π–ª—ã</button>
                </div>
                <div class="cloud-content" id="cloud-content">
                    <div class="files-grid" id="cloud-files">
                        <!-- –§–∞–π–ª—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
            </section>

            <!-- –ò–≥—Ä—ã -->
            <section id="games" class="section">
                <div class="games-grid">
                    <!-- Counter-Strike -->
                    <div class="game-card">
                        <div class="game-header">
                            <div style="font-size: 2.5rem;">üî´</div>
                            <h3 style="font-size: 1.5rem; font-weight: 600;">Counter-Strike 2</h3>
                        </div>
                        <div class="game-body">
                            <div class="game-stats">
                                <span>üë• –ò–≥—Ä–æ–∫–∏: 0/24</span>
                                <span>üéØ K/D: 0.00</span>
                            </div>
                            <button class="play-btn" onclick="startCSGame()">
                                <span>–ò–≥—Ä–∞—Ç—å</span>
                            </button>
                        </div>
                    </div>

                    <!-- –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ -->
                    <div class="game-card">
                        <div class="game-header">
                            <div style="font-size: 2.5rem;">‚ùå‚≠ï</div>
                            <h3 style="font-size: 1.5rem; font-weight: 600;">–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h3>
                        </div>
                        <div class="game-body">
                            <div class="game-stats">
                                <span>üéÆ –°–ª–æ–∂–Ω–æ—Å—Ç—å: –°—Ä–µ–¥–Ω—è—è</span>
                                <span>üèÜ –ü–æ–±–µ–¥: 0</span>
                            </div>
                            <button class="play-btn" onclick="startTicTacToe()">
                                <span>–ò–≥—Ä–∞—Ç—å</span>
                            </button>
                        </div>
                    </div>

                    <!-- –ö–ª–∏–∫–µ—Ä -->
                    <div class="game-card">
                        <div class="game-header">
                            <div style="font-size: 2.5rem;">üí∞</div>
                            <h3 style="font-size: 1.5rem; font-weight: 600;">–ö–ª–∏–∫–µ—Ä</h3>
                        </div>
                        <div class="game-body">
                            <div class="game-stats">
                                <span>üîÑ –ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–π: 0</span>
                                <span>üêæ –ü–∏—Ç–æ–º—Ü–µ–≤: 0</span>
                            </div>
                            <button class="play-btn" onclick="startClicker()">
                                <span>–ò–≥—Ä–∞—Ç—å</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –ò–≥—Ä–æ–≤—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
                <div id="cs-game-modal" class="modal">
                    <div class="modal-content">
                        <div style="margin-bottom: 1.5rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <h3 style="font-size: 1.5rem; font-weight: 600;">Counter-Strike 2</h3>
                                <button onclick="closeModal('cs-game-modal')" style="background: none; border: none; color: var(--text); cursor: pointer; font-size: 1.5rem;">√ó</button>
                            </div>
                            
                            <div class="cs-tabs">
                                <button class="cs-tab active" data-cs-tab="play">üéÆ –ò–≥—Ä–∞—Ç—å</button>
                                <button class="cs-tab" data-cs-tab="cases">üéÅ –ö–µ–π—Å—ã</button>
                                <button class="cs-tab" data-cs-tab="inventory">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
                            </div>
                        </div>
                        
                        <div id="cs-play-tab">
                            <div class="cs-game-container">
                                <canvas id="cs-canvas"></canvas>
                                <div class="cs-hud">
                                    <div class="cs-stats">
                                        <span>‚ù§Ô∏è 100/100</span>
                                        <span>üéØ 0 —É–±–∏–π—Å—Ç–≤</span>
                                        <span>üí∞ $800</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tic-tac-toe-modal" class="modal">
                    <div class="modal-content">
                        <div style="margin-bottom: 1.5rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <h3 style="font-size: 1.5rem; font-weight: 600;">–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h3>
                                <button onclick="closeModal('tic-tac-toe-modal')" style="background: none; border: none; color: var(--text); cursor: pointer; font-size: 1.5rem;">√ó</button>
                            </div>
                        </div>
                        
                        <div class="tic-tac-toe-board" id="tic-board">
                            <!-- –ö–ª–µ—Ç–∫–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        </div>
                        
                        <div style="text-align: center; margin-top: 2rem;">
                            <div style="margin-bottom: 1rem; font-size: 1.1rem;" id="tic-status">–í–∞—à —Ö–æ–¥ (X)</div>
                            <button class="btn" onclick="resetTicTacToe()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                        </div>
                    </div>
                </div>

                <div id="clicker-modal" class="modal">
                    <div class="modal-content">
                        <div style="margin-bottom: 1.5rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <h3 style="font-size: 1.5rem; font-weight: 600;">–ö–ª–∏–∫–µ—Ä</h3>
                                <button onclick="closeModal('clicker-modal')" style="background: none; border: none; color: var(--text); cursor: pointer; font-size: 1.5rem;">√ó</button>
                            </div>
                        </div>
                        
                        <div class="clicker-game">
                            <div class="clicker-display" id="clicker-money">$0</div>
                            <button class="clicker-btn" onclick="clickMoney()">–ö–õ–ò–ö!</button>
                            
                            <div class="upgrades-grid">
                                <div class="upgrade-item" onclick="buyUpgrade('click')">
                                    <div style="font-weight: 600; margin-bottom: 0.5rem;">üí™ –°–∏–ª–∞ –∫–ª–∏–∫–∞</div>
                                    <div style="font-size: 0.9rem; opacity: 0.8;">+$1 –∑–∞ –∫–ª–∏–∫</div>
                                    <div style="color: var(--primary); margin-top: 0.5rem;">–¶–µ–Ω–∞: $10</div>
                                </div>
                                <div class="upgrade-item" onclick="buyUpgrade('auto')">
                                    <div style="font-weight: 600; margin-bottom: 0.5rem;">‚ö° –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</div>
                                    <div style="font-size: 0.9rem; opacity: 0.8;">+$0.1/—Å–µ–∫</div>
                                    <div style="color: var(--primary); margin-top: 0.5rem;">–¶–µ–Ω–∞: $100</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- –ö–∞—Ä—Ç—ã -->
            <section id="maps" class="section">
                <div class="card">
                    <h3 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem;">–ö–∞—Ä—Ç—ã –∏ –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä</h3>
                    <div style="text-align: center; padding: 4rem 2rem;">
                        <div style="font-size: 5rem; margin-bottom: 1rem;">üó∫Ô∏è</div>
                        <p style="margin-bottom: 1.5rem; opacity: 0.8;">–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</p>
                        <button class="btn" onclick="showMap()">
                            <span>–û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—ã</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ -->
            <section id="translator" class="section">
                <div class="translator-container">
                    <div class="lang-selectors">
                        <select class="lang-select" id="lang-from">
                            <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                            <option value="en">üá∫üá∏ –ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                            <option value="zh">üá®üá≥ –ö–∏—Ç–∞–π—Å–∫–∏–π</option>
                            <option value="ar">üá∏üá¶ –ê—Ä–∞–±—Å–∫–∏–π</option>
                        </select>
                        
                        <button class="swap-btn" onclick="swapLanguages()">‚áÑ</button>
                        
                        <select class="lang-select" id="lang-to">
                            <option value="en">üá∫üá∏ –ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                            <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                            <option value="zh">üá®üá≥ –ö–∏—Ç–∞–π—Å–∫–∏–π</option>
                            <option value="ar">üá∏üá¶ –ê—Ä–∞–±—Å–∫–∏–π</option>
                        </select>
                    </div>
                    
                    <div class="text-areas">
                        <textarea class="text-area" id="text-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞..."></textarea>
                        <textarea class="text-area" id="text-output" placeholder="–ü–µ—Ä–µ–≤–æ–¥..." readonly></textarea>
                    </div>
                    
                    <div class="voice-controls">
                        <button class="voice-btn" onclick="speakTranslation()">
                            <span>üîä</span>
                            <span>–ü—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏</span>
                        </button>
                        <button class="voice-btn" onclick="startVoiceInput()">
                            <span>üé§</span>
                            <span>–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- –í—Ä–µ–º—è -->
            <section id="clocks" class="section">
                <div class="clocks-grid" id="clocks-grid">
                    <!-- –ß–∞—Å—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </section>

            <!-- –ß–∞—Ç-–±–æ—Ç -->
            <section id="chatbot" class="section">
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="message bot">
                            –ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" class="chat-input" id="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                        <button class="chat-send-btn" onclick="sendChatMessage()">
                            ‚Üí
                        </button>
                    </div>
                </div>
            </section>

            <!-- –õ–∏–¥–µ—Ä—ã -->
            <section id="leaderboard" class="section">
                <div class="leaderboard-container">
                    <div style="margin-bottom: 2rem;">
                        <h3 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem;">–õ–∏–¥–µ—Ä—ã –∏–≥—Ä</h3>
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                            <select class="lang-select" id="leaderboard-game" style="flex: 1;">
                                <option value="all">–í—Å–µ –∏–≥—Ä—ã</option>
                                <option value="cs">Counter-Strike</option>
                                <option value="tic">–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</option>
                                <option value="clicker">–ö–ª–∏–∫–µ—Ä</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="leaderboard-table">
                        <div class="leaderboard-row leaderboard-header">
                            <div>–†–∞–Ω–≥</div>
                            <div>–ò–≥—Ä–æ–∫</div>
                            <div>–û—á–∫–∏</div>
                            <div>–ò–≥—Ä–∞</div>
                        </div>
                        <div id="leaderboard-content">
                            <!-- –õ–∏–¥–µ—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div style="margin-bottom: 2rem;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h3 style="font-size: 1.5rem; font-weight: 600;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                    <button onclick="closeModal('settings-modal')" style="background: none; border: none; color: var(--text); cursor: pointer; font-size: 1.5rem;">√ó</button>
                </div>
                
                <div class="settings-grid">
                    <div class="setting-card">
                        <h4 style="font-weight: 600; margin-bottom: 1rem;">üé® –¢–µ–º–∞</h4>
                        <div class="theme-selector">
                            <button class="theme-btn theme-dark active" onclick="setTheme('dark')">
                                –¢—ë–º–Ω–∞—è
                            </button>
                            <button class="theme-btn theme-light" onclick="setTheme('light')">
                                –°–≤–µ—Ç–ª–∞—è
                            </button>
                            <button class="theme-btn theme-purple" onclick="setTheme('purple')">
                                –§–∏–æ–ª–µ—Ç–æ–≤–∞—è
                            </button>
                        </div>
                    </div>
                    
                    <div class="setting-card">
                        <h4 style="font-weight: 600; margin-bottom: 1rem;">‚ùÑÔ∏è –°–Ω–µ–∂–∏–Ω–∫–∏</h4>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <span>–í–∫–ª—é—á–∏—Ç—å —Å–Ω–µ–≥</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="snow-toggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="setting-card">
                        <h4 style="font-weight: 600; margin-bottom: 1rem;">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h4>
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                            <span>–ó–≤—É–∫–∏</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="sound-toggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <span>–û–ø–æ–≤–µ—â–µ–Ω–∏—è</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="notifications-toggle">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="setting-card">
                        <h4 style="font-weight: 600; margin-bottom: 1rem;">üíæ –î–∞–Ω–Ω—ã–µ</h4>
                        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                            <button class="btn" onclick="exportData()">
                                <span>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</span>
                            </button>
                            <button class="btn-secondary" onclick="importData()">
                                <span>–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</span>
                            </button>
                            <button class="btn-secondary" style="background: var(--danger); color: white;" onclick="clearData()">
                                <span>–û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
// ====================
// –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
// ====================
const USERS = ["–ù–∏–∫–∏—Ç–∞", "–ê–ª–µ–Ω–∞", "–°–∞—à–∞", "–ê–ª–∏—Å–∞", "–ì–æ—Å—Ç—å"];
let currentUser = null;
let isMobile = false;
let gameData = JSON.parse(localStorage.getItem('ultra_platform')) || {
    users: {},
    online: {},
    settings: {
        theme: 'dark',
        snow: true,
        sounds: true,
        notifications: false
    }
};

// Three.js –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è CS
let csScene, csCamera, csRenderer, csPlayer, csBots = [];

// ====================
// –í–´–ë–û–† –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
// ====================
function initUserSelection() {
    const userGrid = document.getElementById('user-grid');
    userGrid.innerHTML = '';
    
    USERS.forEach(username => {
        const isOccupied = gameData.online && gameData.online[username];
        const userBtn = document.createElement('button');
        userBtn.className = `user-btn ${isOccupied ? 'occupied' : ''}`;
        userBtn.textContent = username;
        userBtn.onclick = () => selectUser(username, isOccupied);
        userGrid.appendChild(userBtn);
    });
}

function selectUser(username, isOccupied) {
    if (isOccupied) {
        alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "${username}" —É–∂–µ –≤ –∏–≥—Ä–µ!`);
        return;
    }
    
    document.querySelectorAll('.user-btn').forEach(btn => {
        btn.classList.remove('selected');
    });
    event.target.classList.add('selected');
    currentUser = username;
}

function enterPlatform() {
    if (!currentUser) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!');
        return;
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –∑–∞–Ω—è—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    if (gameData.online && gameData.online[currentUser]) {
        alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "${currentUser}" —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É!`);
        initUserSelection();
        return;
    }
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
    isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
    // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ –Ω–µ—Ç
    if (!gameData.users[currentUser]) {
        gameData.users[currentUser] = {
            balance: 1000,
            stats: {
                cs: { kills: 0, deaths: 0, wins: 0 },
                tic: { wins: 0, losses: 0, draws: 0 },
                clicker: { money: 0, rebirths: 0, pets: [] }
            },
            inventory: [],
            created: Date.now()
        };
    }
    
    // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –æ–Ω–ª–∞–π–Ω
    gameData.online[currentUser] = Date.now();
    saveData();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
    initPlatform();
}

function initPlatform() {
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    document.getElementById('user-select-screen').style.display = 'none';
    document.getElementById('main-interface').style.display = 'block';
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É
    setTheme(gameData.settings.theme);
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–Ω–µ–∂–∏–Ω–∫–∏
    if (gameData.settings.snow && (gameData.settings.theme === 'dark' || gameData.settings.theme === 'purple')) {
        createSnowflakes();
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    updateUserInfo();
    loadCloudFiles();
    initWorldClocks();
    initLeaderboard();
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    setupEventListeners();
}

function updateUserInfo() {
    const userData = gameData.users[currentUser];
    const firstLetter = currentUser.charAt(0).toUpperCase();
    
    document.getElementById('user-avatar').textContent = firstLetter;
    document.getElementById('current-username').textContent = currentUser;
    document.getElementById('user-balance').textContent = `$${userData.balance}`;
}

function exitPlatform() {
    if (confirm('–í—ã–π—Ç–∏ —Å —Å–∞–π—Ç–∞?')) {
        window.close();
    }
}

// ====================
// –û–ë–õ–ê–ö–û
// ====================
function loadCloudFiles() {
    const files = [
        { name: '–§–æ—Ç–æ 1.jpg', type: 'photo', size: '2.4 MB', icon: 'üì∑' },
        { name: '–í–∏–¥–µ–æ 1.mp4', type: 'video', size: '45.2 MB', icon: 'üé¨' },
        { name: '–î–æ–∫—É–º–µ–Ω—Ç.pdf', type: 'file', size: '1.1 MB', icon: 'üìÑ' },
        { name: '–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è.pptx', type: 'file', size: '8.7 MB', icon: 'üìä' },
        { name: '–ú—É–∑—ã–∫–∞.mp3', type: 'audio', size: '5.3 MB', icon: 'üéµ' },
        { name: '–ê—Ä—Ö–∏–≤.zip', type: 'file', size: '12.4 MB', icon: 'üì¶' }
    ];
    
    const filesGrid = document.getElementById('cloud-files');
    filesGrid.innerHTML = files.map(file => `
        <div class="file-item">
            <div style="font-size: 3rem; margin-bottom: 1rem;">${file.icon}</div>
            <div style="font-weight: 600; margin-bottom: 0.5rem;">${file.name}</div>
            <div style="font-size: 0.9rem; opacity: 0.7;">${file.size}</div>
        </div>
    `).join('');
}

// ====================
// –ò–ì–†–´
// ====================
// Counter-Strike
function startCSGame() {
    showModal('cs-game-modal');
    initCSGame();
}

function initCSGame() {
    const canvas = document.getElementById('cs-canvas');
    if (!canvas) return;
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Three.js
    csScene = new THREE.Scene();
    csCamera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
    csRenderer = new THREE.WebGLRenderer({ canvas, antialias: true });
    csRenderer.setSize(canvas.clientWidth, canvas.clientHeight);
    
    // –°–≤–µ—Ç
    const light = new THREE.AmbientLight(0x404040);
    csScene.add(light);
    
    // –ò–≥—Ä–æ–∫
    const geometry = new THREE.BoxGeometry(1, 2, 1);
    const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
    csPlayer = new THREE.Mesh(geometry, material);
    csScene.add(csPlayer);
    
    // –ü–æ–ª
    const floorGeometry = new THREE.PlaneGeometry(50, 50);
    const floorMaterial = new THREE.MeshBasicMaterial({ color: 0x444444 });
    const floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.rotation.x = -Math.PI / 2;
    csScene.add(floor);
    
    // –ë–æ—Ç—ã
    createCSBots();
    
    // –ê–Ω–∏–º–∞—Ü–∏—è
    animateCS();
}

function createCSBots() {
    for (let i = 0; i < 5; i++) {
        const geometry = new THREE.BoxGeometry(1, 2, 1);
        const material = new THREE.MeshBasicMaterial({ color: 0xff0000 });
        const bot = new THREE.Mesh(geometry, material);
        
        bot.position.set(
            (Math.random() - 0.5) * 40,
            1,
            (Math.random() - 0.5) * 40
        );
        
        csScene.add(bot);
        csBots.push(bot);
    }
}

function animateCS() {
    requestAnimationFrame(animateCS);
    
    // –í—Ä–∞—â–µ–Ω–∏–µ –±–æ—Ç–æ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    csBots.forEach(bot => {
        bot.rotation.y += 0.01;
    });
    
    csRenderer.render(csScene, csCamera);
}

// –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏
let ticBoard = ['', '', '', '', '', '', '', '', ''];
let ticCurrentPlayer = 'X';
let ticGameActive = true;

function startTicTacToe() {
    showModal('tic-tac-toe-modal');
    initTicTacToe();
}

function initTicTacToe() {
    const board = document.getElementById('tic-board');
    board.innerHTML = '';
    
    for (let i = 0; i < 9; i++) {
        const cell = document.createElement('div');
        cell.className = 'tic-cell';
        cell.dataset.index = i;
        cell.onclick = () => makeMove(i);
        board.appendChild(cell);
    }
    
    updateTicStatus();
}

function makeMove(index) {
    if (!ticGameActive || ticBoard[index] !== '') return;
    
    ticBoard[index] = ticCurrentPlayer;
    document.querySelector(`.tic-cell[data-index="${index}"]`).textContent = ticCurrentPlayer;
    
    if (checkWin()) {
        document.getElementById('tic-status').textContent = `–ü–æ–±–µ–¥–∏–ª ${ticCurrentPlayer}!`;
        ticGameActive = false;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        if (ticCurrentPlayer === 'X') {
            gameData.users[currentUser].stats.tic.wins++;
        }
        saveData();
        return;
    }
    
    if (isBoardFull()) {
        document.getElementById('tic-status').textContent = '–ù–∏—á—å—è!';
        ticGameActive = false;
        gameData.users[currentUser].stats.tic.draws++;
        saveData();
        return;
    }
    
    ticCurrentPlayer = ticCurrentPlayer === 'X' ? 'O' : 'X';
    updateTicStatus();
    
    // –•–æ–¥ –±–æ—Ç–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    if (ticCurrentPlayer === 'O') {
        setTimeout(makeBotMove, 500);
    }
}

function makeBotMove() {
    const availableMoves = ticBoard.map((cell, index) => cell === '' ? index : -1).filter(i => i !== -1);
    if (availableMoves.length === 0) return;
    
    const randomMove = availableMoves[Math.floor(Math.random() * availableMoves.length)];
    makeMove(randomMove);
}

function checkWin() {
    const winPatterns = [
        [0,1,2], [3,4,5], [6,7,8], // rows
        [0,3,6], [1,4,7], [2,5,8], // columns
        [0,4,8], [2,4,6] // diagonals
    ];
    
    return winPatterns.some(pattern => {
        const [a,b,c] = pattern;
        return ticBoard[a] && ticBoard[a] === ticBoard[b] && ticBoard[a] === ticBoard[c];
    });
}

function isBoardFull() {
    return ticBoard.every(cell => cell !== '');
}

function updateTicStatus() {
    document.getElementById('tic-status').textContent = `–•–æ–¥ –∏–≥—Ä–æ–∫–∞: ${ticCurrentPlayer}`;
}

function resetTicTacToe() {
    ticBoard = ['', '', '', '', '', '', '', '', ''];
    ticCurrentPlayer = 'X';
    ticGameActive = true;
    initTicTacToe();
}

// –ö–ª–∏–∫–µ—Ä
let clickerMoney = 0;
let clickerClickPower = 1;
let clickerAutoClicker = 0;

function startClicker() {
    showModal('clicker-modal');
    loadClickerData();
}

function loadClickerData() {
    const data = gameData.users[currentUser].stats.clicker;
    clickerMoney = data.money || 0;
    clickerClickPower = data.clickPower || 1;
    clickerAutoClicker = data.autoClicker || 0;
    
    updateClickerDisplay();
    
    // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
    if (clickerAutoClicker > 0 && !window.autoClickerInterval) {
        window.autoClickerInterval = setInterval(() => {
            clickerMoney += clickerAutoClicker * 0.1;
            updateClickerDisplay();
            saveClickerData();
        }, 1000);
    }
}

function clickMoney() {
    clickerMoney += clickerClickPower;
    updateClickerDisplay();
    saveClickerData();
}

function buyUpgrade(type) {
    let cost = 0;
    
    switch(type) {
        case 'click':
            cost = 10 * Math.pow(2, clickerClickPower - 1);
            if (clickerMoney >= cost) {
                clickerMoney -= cost;
                clickerClickPower++;
                updateClickerDisplay();
                saveClickerData();
            } else {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
            }
            break;
            
        case 'auto':
            cost = 100 * Math.pow(2, clickerAutoClicker);
            if (clickerMoney >= cost) {
                clickerMoney -= cost;
                clickerAutoClicker++;
                updateClickerDisplay();
                saveClickerData();
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –µ—Å–ª–∏ –µ—â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω
                if (!window.autoClickerInterval) {
                    window.autoClickerInterval = setInterval(() => {
                        clickerMoney += clickerAutoClicker * 0.1;
                        updateClickerDisplay();
                        saveClickerData();
                    }, 1000);
                }
            } else {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
            }
            break;
    }
}

function updateClickerDisplay() {
    document.getElementById('clicker-money').textContent = `$${clickerMoney.toFixed(2)}`;
}

function saveClickerData() {
    gameData.users[currentUser].stats.clicker = {
        money: clickerMoney,
        clickPower: clickerClickPower,
        autoClicker: clickerAutoClicker
    };
    saveData();
}

// ====================
// –ü–ï–†–ï–í–û–î–ß–ò–ö
// ====================
const translations = {
    'ru': {
        'hello': '–ø—Ä–∏–≤–µ—Ç',
        'goodbye': '–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è',
        'thank you': '—Å–ø–∞—Å–∏–±–æ',
        'yes': '–¥–∞',
        'no': '–Ω–µ—Ç'
    },
    'en': {
        '–ø—Ä–∏–≤–µ—Ç': 'hello',
        '–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è': 'goodbye',
        '—Å–ø–∞—Å–∏–±–æ': 'thank you',
        '–¥–∞': 'yes',
        '–Ω–µ—Ç': 'no'
    }
};

function swapLanguages() {
    const fromSelect = document.getElementById('lang-from');
    const toSelect = document.getElementById('lang-to');
    const temp = fromSelect.value;
    fromSelect.value = toSelect.value;
    toSelect.value = temp;
    translateText();
}

function translateText() {
    const text = document.getElementById('text-input').value.toLowerCase();
    const fromLang = document.getElementById('lang-from').value;
    const toLang = document.getElementById('lang-to').value;
    
    if (!text.trim()) {
        document.getElementById('text-output').value = '';
        return;
    }
    
    // –ü—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–æ–≤–∞—Ä—è
    const fromDict = translations[fromLang];
    const toDict = translations[toLang];
    
    let result = text;
    if (fromDict && toDict) {
        Object.keys(fromDict).forEach(key => {
            if (text.includes(key)) {
                result = result.replace(new RegExp(key, 'gi'), fromDict[key]);
            }
        });
    }
    
    document.getElementById('text-output').value = result.charAt(0).toUpperCase() + result.slice(1);
}

function speakTranslation() {
    const text = document.getElementById('text-output').value;
    if (!text.trim()) return;
    
    if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = document.getElementById('lang-to').value;
        speechSynthesis.speak(utterance);
    } else {
        alert('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏');
    }
}

function startVoiceInput() {
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.lang = document.getElementById('lang-from').value;
        
        recognition.onresult = function(event) {
            const transcript = event.results[0][0].transcript;
            document.getElementById('text-input').value = transcript;
            translateText();
        };
        
        recognition.start();
    } else {
        alert('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏');
    }
}

// ====================
// –ß–ê–°–´
// ====================
const timezones = {
    '–ú–æ—Å–∫–≤–∞': 'Europe/Moscow',
    '–î—É–±–∞–π': 'Asia/Dubai',
    '–ö–∏–µ–≤': 'Europe/Kiev',
    '–ü–∞—Ä–∏–∂': 'Europe/Paris',
    '–ë–µ—Ä–ª–∏–Ω': 'Europe/Berlin',
    '–¢–æ–∫–∏–æ': 'Asia/Tokyo',
    '–ü–µ–∫–∏–Ω': 'Asia/Shanghai',
    '–°–µ—É–ª': 'Asia/Seoul',
    '–ü—É—Å–∞–Ω': 'Asia/Seoul',
    '–¢–∞—à–∫–µ–Ω—Ç': 'Asia/Tashkent'
};

function initWorldClocks() {
    const clocksGrid = document.getElementById('clocks-grid');
    
    Object.keys(timezones).forEach(city => {
        const clockCard = document.createElement('div');
        clockCard.className = 'clock-card';
        clockCard.innerHTML = `
            <div style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem;">${city}</div>
            <div class="clock-time" id="clock-${city}">00:00:00</div>
            <div style="font-size: 0.9rem; opacity: 0.7;" id="date-${city}">1 —è–Ω–≤–∞—Ä—è 2024</div>
        `;
        clocksGrid.appendChild(clockCard);
    });
    
    updateClocks();
    setInterval(updateClocks, 1000);
}

function updateClocks() {
    const now = new Date();
    
    Object.keys(timezones).forEach(city => {
        try {
            const timeString = now.toLocaleTimeString('ru-RU', { timeZone: timezones[city] });
            const dateString = now.toLocaleDateString('ru-RU', { 
                timeZone: timezones[city],
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            document.getElementById(`clock-${city}`).textContent = timeString;
            document.getElementById(`date-${city}`).textContent = dateString;
        } catch (e) {
            // –ï—Å–ª–∏ —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
            document.getElementById(`clock-${city}`).textContent = now.toLocaleTimeString();
            document.getElementById(`date-${city}`).textContent = now.toLocaleDateString();
        }
    });
}

// ====================
// –ß–ê–¢-–ë–û–¢
// ====================
const botResponses = {
    '–ø—Ä–∏–≤–µ—Ç': '–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –≤–∞—à–∏ –¥–µ–ª–∞?',
    '–∫–∞–∫ –¥–µ–ª–∞': '–£ –º–µ–Ω—è –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ! –ê —É –≤–∞—Å?',
    '—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å': '–Ø –º–æ–≥—É –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç –∏ –ø–æ–º–æ–≥–∞—Ç—å —Å –∏–≥—Ä–∞–º–∏!',
    '—Å–ø–∞—Å–∏–±–æ': '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –í—Å–µ–≥–¥–∞ —Ä–∞–¥ –ø–æ–º–æ—á—å!',
    '–ø–æ–∫–∞': '–î–æ —Å–≤–∏–¥–∞–Ω–∏—è! –ó–∞—Ö–æ–¥–∏—Ç–µ –µ—â—ë!'
};

function sendChatMessage() {
    const input = document.getElementById('chat-input');
    const message = input.value.trim();
    
    if (!message) return;
    
    addMessage(message, 'user');
    input.value = '';
    
    // –û—Ç–≤–µ—Ç –±–æ—Ç–∞
    setTimeout(() => {
        let response = '–ò–∑–≤–∏–Ω–∏—Ç–µ, —è –Ω–µ –ø–æ–Ω—è–ª –≤–∞—à –≤–æ–ø—Ä–æ—Å. –ú–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä–æ–≤–∞—Ç—å?';
        
        Object.keys(botResponses).forEach(key => {
            if (message.toLowerCase().includes(key)) {
                response = botResponses[key];
            }
        });
        
        addMessage(response, 'bot');
    }, 1000);
}

function addMessage(text, sender) {
    const messages = document.getElementById('chat-messages');
    const message = document.createElement('div');
    message.className = `message ${sender}`;
    message.textContent = text;
    messages.appendChild(message);
    messages.scrollTop = messages.scrollHeight;
}

// ====================
// –õ–ò–î–ï–†–ë–û–†–î
// ====================
function initLeaderboard() {
    updateLeaderboard();
    document.getElementById('leaderboard-game').addEventListener('change', updateLeaderboard);
}

function updateLeaderboard() {
    const game = document.getElementById('leaderboard-game').value;
    const leaderboardContent = document.getElementById('leaderboard-content');
    
    // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
    const allPlayers = Object.entries(gameData.users).map(([username, data]) => {
        let score = 0;
        let gameName = '';
        
        switch(game) {
            case 'cs':
                score = data.stats.cs.kills;
                gameName = 'CS';
                break;
            case 'tic':
                score = data.stats.tic.wins;
                gameName = '–ö—Ä–µ—Å—Ç–∏–∫–∏';
                break;
            case 'clicker':
                score = data.stats.clicker.money || 0;
                gameName = '–ö–ª–∏–∫–µ—Ä';
                break;
            case 'all':
            default:
                score = data.stats.cs.kills + data.stats.tic.wins * 10 + (data.stats.clicker.money || 0) / 100;
                gameName = '–í—Å–µ –∏–≥—Ä—ã';
                break;
        }
        
        return { username, score, gameName };
    });
    
    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –æ—á–∫–∞–º
    allPlayers.sort((a, b) => b.score - a.score);
    
    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ–ø-10
    leaderboardContent.innerHTML = allPlayers.slice(0, 10).map((player, index) => {
        const rank = index + 1;
        return `
            <div class="leaderboard-row">
                <div>
                    <div class="rank-badge rank-${rank <= 3 ? rank : 'other'}">
                        ${rank}
                    </div>
                </div>
                <div>${player.username}</div>
                <div>${Math.round(player.score)}</div>
                <div>${game === 'all' ? player.gameName : ''}</div>
            </div>
        `;
    }).join('');
}

// ====================
// –ù–ê–°–¢–†–û–ô–ö–ò
// ====================
function toggleSettings() {
    showModal('settings-modal');
}

function setTheme(theme) {
    document.body.setAttribute('data-theme', theme);
    gameData.settings.theme = theme;
    saveData();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É —Ç–µ–º—ã
    document.querySelectorAll('.theme-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    document.querySelector(`.theme-btn[onclick="setTheme('${theme}')"]`).classList.add('active');
    
    // –í–∫–ª—é—á–∞–µ–º/–≤—ã–∫–ª—é—á–∞–µ–º —Å–Ω–µ–∂–∏–Ω–∫–∏
    const snowToggle = document.getElementById('snow-toggle');
    if (theme === 'light') {
        snowToggle.checked = false;
        snowToggle.disabled = true;
        removeSnowflakes();
    } else {
        snowToggle.disabled = false;
        if (snowToggle.checked) {
            createSnowflakes();
        }
    }
}

function createSnowflakes() {
    removeSnowflakes();
    
    if (!gameData.settings.snow) return;
    
    for (let i = 0; i < 50; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        
        const size = Math.random() * 10 + 5;
        snowflake.style.width = `${size}px`;
        snowflake.style.height = `${size}px`;
        snowflake.style.left = `${Math.random() * 100}vw`;
        snowflake.style.opacity = Math.random() * 0.5 + 0.3;
        snowflake.style.animationDuration = `${Math.random() * 10 + 10}s`;
        snowflake.style.animationDelay = `${Math.random() * 5}s`;
        
        document.body.appendChild(snowflake);
        
        // –£–¥–∞–ª—è–µ–º —Å–Ω–µ–∂–∏–Ω–∫—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
        setTimeout(() => {
            if (snowflake.parentNode) {
                snowflake.parentNode.removeChild(snowflake);
            }
        }, 15000);
    }
    
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ —Å–Ω–µ–∂–∏–Ω–∫–∏ –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
    window.snowInterval = setInterval(createSnowflakes, 15000);
}

function removeSnowflakes() {
    document.querySelectorAll('.snowflake').forEach(snowflake => {
        snowflake.remove();
    });
    if (window.snowInterval) {
        clearInterval(window.snowInterval);
    }
}

function exportData() {
    const dataStr = JSON.stringify(gameData);
    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
    
    const exportFileDefaultName = 'ultra-platform-backup.json';
    
    const linkElement = document.createElement('a');
    linkElement.setAttribute('href', dataUri);
    linkElement.setAttribute('download', exportFileDefaultName);
    linkElement.click();
    
    alert('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
}

function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'application/json';
    
    input.onchange = function(e) {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = function(event) {
            try {
                const importedData = JSON.parse(event.target.result);
                Object.assign(gameData, importedData);
                saveData();
                alert('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
                location.reload();
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –¥–∞–Ω–Ω—ã—Ö: ' + error.message);
            }
        };
        
        reader.readAsText(file);
    };
    
    input.click();
}

function clearData() {
    if (confirm('–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
        localStorage.clear();
        alert('–î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞.');
        location.reload();
    }
}

// ====================
// –£–¢–ò–õ–ò–¢–´
// ====================
function showModal(modalId) {
    document.getElementById(modalId).style.display = 'flex';
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
}

function showMap() {
    alert('–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.\n–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Google Maps –∏–ª–∏ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã.');
}

function setupEventListeners() {
    // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º
    document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            const tabId = tab.dataset.tab;
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–µ
            tab.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        });
    });
    
    // –í–∫–ª–∞–¥–∫–∏ –æ–±–ª–∞–∫–∞
    document.querySelectorAll('.cloud-subtab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.cloud-subtab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
        });
    });
    
    // –í–∫–ª–∞–¥–∫–∏ CS
    document.querySelectorAll('.cs-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.cs-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            const tabId = tab.dataset.csTab;
            document.querySelectorAll('[id$="-tab"]').forEach(t => t.style.display = 'none');
            document.getElementById(`cs-${tabId}-tab`).style.display = 'block';
        });
    });
    
    // –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫
    document.getElementById('text-input').addEventListener('input', translateText);
    
    // –ß–∞—Ç-–±–æ—Ç (Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏)
    document.getElementById('chat-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendChatMessage();
    });
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–Ω–µ–∂–∏–Ω–æ–∫
    document.getElementById('snow-toggle').addEventListener('change', (e) => {
        gameData.settings.snow = e.target.checked;
        saveData();
        
        if (e.target.checked && (gameData.settings.theme === 'dark' || gameData.settings.theme === 'purple')) {
            createSnowflakes();
        } else {
            removeSnowflakes();
        }
    });
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–≤—É–∫–æ–≤
    document.getElementById('sound-toggle').addEventListener('change', (e) => {
        gameData.settings.sounds = e.target.checked;
        saveData();
    });
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    document.getElementById('notifications-toggle').addEventListener('change', (e) => {
        gameData.settings.notifications = e.target.checked;
        saveData();
    });
}

function saveData() {
    localStorage.setItem('ultra_platform', JSON.stringify(gameData));
}

// ====================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
// ====================
window.addEventListener('load', () => {
    initUserSelection();
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ (—É–¥–∞–ª—è–µ–º —Ç–µ—Ö, –∫—Ç–æ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç)
    const now = Date.now();
    Object.keys(gameData.online || {}).forEach(user => {
        if (now - gameData.online[user] > 5 * 60 * 1000) {
            delete gameData.online[user];
        }
    });
    saveData();
    
    // –ê–≤—Ç–æ–≤—Ö–æ–¥ –¥–ª—è —Ç–µ—Å—Ç–∞
    if (localStorage.getItem('auto_login') === 'true') {
        currentUser = '–ì–æ—Å—Ç—å';
        enterPlatform();
    }
});

// –†–µ—Å–∞–π–∑ –∫–∞–Ω–≤–∞—Å–∞
window.addEventListener('resize', () => {
    if (csRenderer && csCamera) {
        const canvas = document.getElementById('cs-canvas');
        if (canvas) {
            csCamera.aspect = canvas.clientWidth / canvas.clientHeight;
            csCamera.updateProjectionMatrix();
            csRenderer.setSize(canvas.clientWidth, canvas.clientHeight);
        }
    }
});
</script>
</body>
</html>

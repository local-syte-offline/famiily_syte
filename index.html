<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #4cc9f0;
            --success: #4ade80;
            --warning: #f59e0b;
            --danger: #ef4444;
            --text: #f8fafc;
            --bg: #0f172a;
            --card: #1e293b;
            --border: #334155;
        }

        [data-theme="light"] {
            --primary: #3b82f6;
            --secondary: #1d4ed8;
            --accent: #0ea5e9;
            --text: #1e293b;
            --bg: #f8fafc;
            --card: #ffffff;
            --border: #e2e8f0;
        }

        [data-theme="purple"] {
            --primary: #8b5cf6;
            --secondary: #7c3aed;
            --accent: #a78bfa;
            --text: #f8fafc;
            --bg: #1e1b4b;
            --card: #312e81;
            --border: #4f46e5;
        }

        body {
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }

        /* –°–Ω–µ–∂–∏–Ω–∫–∏ */
        .snowflake {
            position: fixed;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            animation: fall linear infinite;
            filter: blur(0.5px);
        }

        @keyframes fall {
            0% {
                transform: translateY(-10px) rotate(0deg);
                opacity: 0.8;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* –õ–æ–≥–∏–Ω —ç–∫—Ä–∞–Ω */
        .login-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }

        .login-container {
            background: var(--card);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 500px;
            width: 100%;
        }

        .user-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 25px;
            margin: 10px;
            border-radius: 12px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 180px;
        }

        .user-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .user-btn.selected {
            background: var(--accent);
            box-shadow: 0 0 0 3px var(--accent);
        }

        .user-btn.occupied {
            background: var(--danger);
            opacity: 0.7;
        }

        .login-btn {
            background: var(--success);
            color: white;
            border: none;
            padding: 15px 30px;
            margin-top: 30px;
            border-radius: 12px;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(74, 222, 128, 0.3);
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å */
        .main-app {
            display: none;
            min-height: 100vh;
        }

        .header {
            background: var(--card);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
        }

        .balance {
            background: var(--accent);
            padding: 8px 15px;
            border-radius: 25px;
            font-weight: bold;
        }

        .nav {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0;
        }

        .tab {
            background: var(--card);
            border: none;
            color: var(--text);
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .tab:hover {
            background: var(--primary);
        }

        .tab.active {
            background: var(--primary);
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
        }

        .page {
            display: none;
            padding: 20px;
            min-height: calc(100vh - 150px);
        }

        .page.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –û–±–ª–∞–∫–æ */
        .cloud-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .file {
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            transition: all 0.3s ease;
        }

        .file:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .file-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .file-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .file-size {
            opacity: 0.7;
            font-size: 14px;
        }

        .delete-file {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--danger);
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
        }

        /* –ò–≥—Ä—ã */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .game-card {
            background: var(--card);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .game-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .game-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .game-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        /* –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ */
        .translator {
            max-width: 800px;
            margin: 0 auto;
        }

        .lang-selector {
            display: flex;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .lang-box {
            flex: 1;
            min-width: 200px;
        }

        select {
            width: 100%;
            background: var(--card);
            border: 2px solid var(--border);
            color: var(--text);
            padding: 12px;
            border-radius: 10px;
            font-size: 16px;
        }

        .swap-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
        }

        .voice-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            background: var(--card);
            border: 2px solid var(--border);
            color: var(--text);
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            resize: vertical;
        }

        /* –ß–∞—Å—ã */
        .clocks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .clock {
            background: var(--card);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid var(--border);
        }

        .clock-city {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--accent);
        }

        .clock-time {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .clock-date {
            opacity: 0.8;
            font-size: 14px;
        }

        /* –ß–∞—Ç */
        .chat-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
            height: 600px;
        }

        .chat-users {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
            overflow-y: auto;
        }

        .chat-user {
            background: var(--bg);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chat-user:hover {
            background: var(--primary);
        }

        .chat-user.active {
            background: var(--primary);
            border: 2px solid var(--accent);
        }

        .chat-messages {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .messages-list {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            padding-right: 10px;
        }

        .message {
            background: var(--bg);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 15px;
            max-width: 70%;
            word-wrap: break-word;
        }

        .message.sent {
            background: var(--primary);
            margin-left: auto;
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex: 1;
            background: var(--bg);
            border: 2px solid var(--border);
            color: var(--text);
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
        }

        .chat-send {
            background: var(--success);
            color: white;
            border: none;
            width: 50px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--card);
            border-radius: 20px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-btn {
            background: var(--danger);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
        }

        /* Talking Tom */
        .tom-container {
            text-align: center;
            margin: 20px 0;
        }

        .tom-body {
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
            border-radius: 50%;
            margin: 0 auto;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .tom-body:hover {
            transform: scale(1.05);
        }

        .tom-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .tom-stat {
            background: var(--bg);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .play-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(67, 97, 238, 0.3);
        }

        /* –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ */
        .tic-board {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 5px;
            margin: 20px auto;
            width: fit-content;
        }

        .tic-cell {
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tic-cell:hover {
            background: var(--primary);
            border-color: var(--accent);
        }

        /* –ö–ª–∏–∫–µ—Ä */
        .clicker-money {
            font-size: 48px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            color: var(--accent);
        }

        .clicker-btn {
            display: block;
            margin: 30px auto;
            background: var(--warning);
            color: white;
            border: none;
            padding: 25px 50px;
            font-size: 24px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.1s ease;
        }

        .clicker-btn:active {
            transform: scale(0.95);
        }

        .clicker-upgrades {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .upgrade {
            background: var(--bg);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upgrade:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .upgrade-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .upgrade-price {
            color: var(--success);
            font-weight: bold;
            margin-top: 10px;
        }

        /* CS –∏–≥—Ä–∞ */
        .cs-game {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 2000;
        }

        #cs-canvas {
            width: 100%;
            height: 100%;
        }

        .cs-hud {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 20px;
        }

        .cs-controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .weapon-selector {
            display: flex;
            gap: 10px;
        }

        .weapon-btn {
            background: rgba(0,0,0,0.7);
            color: white;
            border: 2px solid #666;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .weapon-btn:hover, .weapon-btn.active {
            border-color: #4cc9f0;
            background: rgba(76, 201, 240, 0.2);
        }

        .cs-exit {
            background: rgba(239, 68, 68, 0.7);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
        }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .theme-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .theme-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            color: white;
            font-weight: bold;
        }

        .theme-dark {
            background: #0f172a;
        }

        .theme-light {
            background: #f8fafc;
            color: #0f172a;
        }

        .theme-purple {
            background: #1e1b4b;
        }

        .theme-btn.active {
            box-shadow: 0 0 0 3px var(--accent);
        }

        .toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #334155;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .chat-container {
                grid-template-columns: 1fr;
            }
            
            .clocks-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .translator {
                padding: 10px;
            }
            
            .lang-selector {
                flex-direction: column;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .tom-stats {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .clocks-grid {
                grid-template-columns: 1fr;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .tic-board {
                grid-template-columns: repeat(3, 80px);
                grid-template-rows: repeat(3, 80px);
            }
        }
    </style>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –ª–æ–≥–∏–Ω–∞ -->
    <div class="login-screen">
        <div class="login-container">
            <h1 style="font-size: 32px; margin-bottom: 30px; color: white;">üë®‚Äçüíª –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
            <p style="margin-bottom: 30px; opacity: 0.9; color: white;">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É</p>
            
            <div id="user-list" style="display: flex; flex-wrap: wrap; justify-content: center; margin: 20px 0;">
                <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
            
            <button class="login-btn" onclick="login()">üöÄ –ù–∞—á–∞—Ç—å</button>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div class="main-app">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <div class="user-info">
                <div class="user-avatar" id="current-avatar">N</div>
                <div>
                    <div style="font-weight: bold; font-size: 18px;" id="current-username">–ù–∏–∫–∏—Ç–∞</div>
                    <div class="balance" id="balance">$1000</div>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px;">
                <button class="play-btn" onclick="openSettings()" style="background: var(--warning);">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                <button class="play-btn" onclick="exitApp()" style="background: var(--danger);">üö™ –í—ã—Ö–æ–¥</button>
            </div>
        </div>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="nav">
            <button class="tab active" data-page="cloud">‚òÅÔ∏è –û–±–ª–∞–∫–æ</button>
            <button class="tab" data-page="games">üéÆ –ò–≥—Ä—ã</button>
            <button class="tab" data-page="translator">üî§ –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫</button>
            <button class="tab" data-page="clocks">üïê –ß–∞—Å—ã –º–∏—Ä–∞</button>
            <button class="tab" data-page="chat">üí¨ –ß–∞—Ç</button>
            <button class="tab" data-page="maps">üó∫Ô∏è –ö–∞—Ä—Ç—ã</button>
        </nav>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
        <main>
            <!-- –û–±–ª–∞–∫–æ -->
            <section id="cloud" class="page active">
                <div class="cloud-header">
                    <h2 style="font-size: 28px;">‚òÅÔ∏è –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ</h2>
                    <button class="play-btn" onclick="addFile()">+ –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª</button>
                </div>
                <div class="files-grid" id="files-grid">
                    <!-- –§–∞–π–ª—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </section>
            
            <!-- –ò–≥—Ä—ã -->
            <section id="games" class="page">
                <h2 style="font-size: 28px; margin-bottom: 20px;">üéÆ –ò–≥—Ä—ã</h2>
                <div class="games-grid">
                    <div class="game-card" onclick="startCS()">
                        <div class="game-icon">üî´</div>
                        <div class="game-title">Counter-Strike 3D</div>
                        <div style="opacity: 0.8; margin-top: 10px;">3D —à—É—Ç–µ—Ä —Å –±–æ—Ç–∞–º–∏</div>
                    </div>
                    
                    <div class="game-card" onclick="startTalkingTom()">
                        <div class="game-icon">üò∫</div>
                        <div class="game-title">My Talking Tom 2</div>
                        <div style="opacity: 0.8; margin-top: 10px;">–ó–∞–±–æ—Ç—å—Å—è –æ –ø–∏—Ç–æ–º—Ü–µ</div>
                    </div>
                    
                    <div class="game-card" onclick="startTicTacToe()">
                        <div class="game-icon">‚ùå‚≠ï</div>
                        <div class="game-title">–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</div>
                        <div style="opacity: 0.8; margin-top: 10px;">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞</div>
                    </div>
                    
                    <div class="game-card" onclick="startClicker()">
                        <div class="game-icon">üí∞</div>
                        <div class="game-title">–ö–ª–∏–∫–µ—Ä –∏–≥—Ä–∞</div>
                        <div style="opacity: 0.8; margin-top: 10px;">–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –∫–ª–∏–∫–∞–º–∏</div>
                    </div>
                </div>
            </section>
            
            <!-- –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ -->
            <section id="translator" class="page">
                <div class="translator">
                    <h2 style="font-size: 28px; margin-bottom: 30px;">üî§ –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫</h2>
                    
                    <div class="lang-selector">
                        <div class="lang-box">
                            <select id="lang-from">
                                <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                                <option value="en">üá∫üá∏ –ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                                <option value="zh">üá®üá≥ –ö–∏—Ç–∞–π—Å–∫–∏–π</option>
                                <option value="ar">üá∏üá¶ –ê—Ä–∞–±—Å–∫–∏–π</option>
                            </select>
                        </div>
                        
                        <button class="swap-btn" onclick="swapLanguages()">‚áÑ</button>
                        
                        <div class="lang-box">
                            <select id="lang-to">
                                <option value="en">üá∫üá∏ –ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                                <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                                <option value="zh">üá®üá≥ –ö–∏—Ç–∞–π—Å–∫–∏–π</option>
                                <option value="ar">üá∏üá¶ –ê—Ä–∞–±—Å–∫–∏–π</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="margin: 20px 0; text-align: center;">
                        <button class="voice-btn" onclick="startVoiceInput()">üé§ –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥</button>
                        <button class="voice-btn" onclick="speakTranslation()">üîä –û–∑–≤—É—á–∏—Ç—å</button>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <textarea id="input-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞..." oninput="translate()"></textarea>
                    </div>
                    
                    <div>
                        <textarea id="output-text" placeholder="–ü–µ—Ä–µ–≤–æ–¥..." readonly></textarea>
                    </div>
                </div>
            </section>
            
            <!-- –ß–∞—Å—ã –º–∏—Ä–∞ -->
            <section id="clocks" class="page">
                <h2 style="font-size: 28px; margin-bottom: 20px;">üïê –ß–∞—Å—ã –º–∏—Ä–∞</h2>
                <div class="clocks-grid" id="clocks-grid">
                    <!-- –ß–∞—Å—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </section>
            
            <!-- –ß–∞—Ç -->
            <section id="chat" class="page">
                <div class="chat-container">
                    <div class="chat-users">
                        <h3 style="margin-bottom: 15px;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                        <div class="chat-list" id="chat-users">
                            <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        </div>
                        <div style="opacity: 0.7; font-size: 14px; text-align: center; margin-top: 20px;">
                            –î–ª—è –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        </div>
                    </div>
                    
                    <div class="chat-messages">
                        <h3 id="chat-title" style="margin-bottom: 20px;">–û–±—â–∏–π —á–∞—Ç</h3>
                        <div class="messages-list" id="messages-list">
                            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        </div>
                        <div class="chat-input">
                            <input type="text" id="chat-message" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                            <button class="chat-send" onclick="sendMessage()">‚û§</button>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- –ö–∞—Ä—Ç—ã -->
            <section id="maps" class="page">
                <div style="height: 100%;" id="map-container">
                    <!-- –ö–∞—Ä—Ç–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ JS -->
                </div>
            </section>
        </main>
    </div>

    <!-- CS 3D –ò–≥—Ä–∞ -->
    <div class="cs-game" id="cs-game">
        <canvas id="cs-canvas"></canvas>
        <div class="cs-hud">
            <div id="cs-health">‚ù§Ô∏è 100</div>
            <div id="cs-money">üí∞ $800</div>
            <div id="cs-kills">üéØ 0 —É–±–∏–π—Å—Ç–≤</div>
            <div id="cs-ammo">üî´ 30/90</div>
        </div>
        <div class="cs-controls">
            <div class="weapon-selector">
                <button class="weapon-btn" onclick="selectWeapon('akm')">üî´ AKM</button>
                <button class="weapon-btn" onclick="selectWeapon('awp')">üéØ AWP</button>
                <button class="weapon-btn" onclick="selectWeapon('glock')">üî´ GLOCK</button>
                <button class="weapon-btn" onclick="selectWeapon('deagle')">üî´ DEAGLE</button>
            </div>
            <button class="cs-exit" onclick="exitCS()">üö™ –í—ã—Ö–æ–¥</button>
        </div>
    </div>

    <!-- My Talking Tom 2 -->
    <div id="talking-tom-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 24px;">My Talking Tom 2</h2>
                <button class="close-btn" onclick="closeModal('talking-tom-modal')">√ó</button>
            </div>
            
            <div class="talking-tom">
                <div class="tom-container">
                    <div class="tom-body" onclick="petTom()">
                        <div class="tom-face">
                            <div class="tom-eye left"></div>
                            <div class="tom-eye right"></div>
                            <div class="tom-mouth"></div>
                        </div>
                    </div>
                </div>
                
                <div class="tom-stats">
                    <div class="tom-stat">
                        <div style="font-weight: 700;">üòä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</div>
                        <div id="tom-happiness">100%</div>
                    </div>
                    <div class="tom-stat">
                        <div style="font-weight: 700;">üçñ –ì–æ–ª–æ–¥</div>
                        <div id="tom-hunger">100%</div>
                    </div>
                    <div class="tom-stat">
                        <div style="font-weight: 700;">üí∞ –î–µ–Ω—å–≥–∏</div>
                        <div id="tom-money">$100</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; text-align: center;">
                    <button class="play-btn" onclick="feedTom()" style="margin-bottom: 10px;">üçñ –ü–æ–∫–æ—Ä–º–∏—Ç—å ($10)</button>
                    <button class="play-btn" onclick="playWithTom()" style="background: var(--secondary);">üéÆ –ü–æ–∏–≥—Ä–∞—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ -->
    <div id="tic-tac-toe-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 24px;">–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h2>
                <button class="close-btn" onclick="closeModal('tic-tac-toe-modal')">√ó</button>
            </div>
            
            <div class="tic-tac-toe">
                <div style="margin-bottom: 20px; text-align: center;">
                    <select id="tic-mode" style="background: var(--card); border: 2px solid var(--primary); color: var(--text); padding: 10px; border-radius: 10px; width: 200px;">
                        <option value="bot">ü§ñ –ü—Ä–æ—Ç–∏–≤ –±–æ—Ç–∞</option>
                        <option value="player">üë• –ü—Ä–æ—Ç–∏–≤ –∏–≥—Ä–æ–∫–∞</option>
                    </select>
                </div>
                
                <div class="tic-board" id="tic-board"></div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <div id="tic-status" style="margin-bottom: 15px; font-size: 18px; font-weight: 700;"></div>
                    <button class="play-btn" onclick="resetTicTacToe()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö–ª–∏–∫–µ—Ä -->
    <div id="clicker-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 24px;">–ö–ª–∏–∫–µ—Ä –∏–≥—Ä–∞</h2>
                <button class="close-btn" onclick="closeModal('clicker-modal')">√ó</button>
            </div>
            
            <div class="clicker-game">
                <div class="clicker-money" id="clicker-money">$0</div>
                <button class="clicker-btn" onclick="clickMoney()">–ö–õ–ò–ö!</button>
                
                <div class="clicker-upgrades">
                    <div class="upgrade" onclick="buyUpgrade('click')">
                        <div class="upgrade-title">
                            <span>üí™</span>
                            <span>–°–∏–ª–∞ –∫–ª–∏–∫–∞</span>
                        </div>
                        <div style="opacity: 0.8; margin: 10px 0;">+$1 –∑–∞ –∫–ª–∏–∫</div>
                        <div class="upgrade-price" id="click-price">–¶–µ–Ω–∞: $10</div>
                    </div>
                    
                    <div class="upgrade" onclick="buyUpgrade('auto')">
                        <div class="upgrade-title">
                            <span>‚ö°</span>
                            <span>–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</span>
                        </div>
                        <div style="opacity: 0.8; margin: 10px 0;">+$0.5/—Å–µ–∫</div>
                        <div class="upgrade-price" id="auto-price">–¶–µ–Ω–∞: $100</div>
                    </div>
                    
                    <div class="upgrade" onclick="buyUpgrade('multiplier')">
                        <div class="upgrade-title">
                            <span>üöÄ</span>
                            <span>–ú–Ω–æ–∂–∏—Ç–µ–ª—å</span>
                        </div>
                        <div style="opacity: 0.8; margin: 10px 0;">√ó1.2 –∫–æ –≤—Å–µ–º—É</div>
                        <div class="upgrade-price" id="multiplier-price">–¶–µ–Ω–∞: $1000</div>
                    </div>
                    
                    <div class="upgrade" onclick="buyRebirth()">
                        <div class="upgrade-title">
                            <span>üîÑ</span>
                            <span>–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ</span>
                        </div>
                        <div style="opacity: 0.8; margin: 10px 0;">+0.5x –º–Ω–æ–∂–∏—Ç–µ–ª—å</div>
                        <div class="upgrade-price" id="rebirth-price">–¶–µ–Ω–∞: $10000</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; text-align: center;">
                    <div id="rebirth-count" style="margin-bottom: 10px;">–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–π: 0</div>
                    <div id="multiplier" style="margin-bottom: 20px;">–ú–Ω–æ–∂–∏—Ç–µ–ª—å: 1x</div>
                    <button class="play-btn" onclick="openShop()" style="background: var(--warning);">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–∞–≥–∞–∑–∏–Ω –∫–ª–∏–∫–µ—Ä–∞ -->
    <div id="shop-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 24px;">üõí –ú–∞–≥–∞–∑–∏–Ω</h2>
                <button class="close-btn" onclick="closeModal('shop-modal')">√ó</button>
            </div>
            
            <div style="margin: 20px 0;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                    <div class="upgrade" onclick="buyEgg('common')">
                        <div style="font-size: 40px; margin-bottom: 10px;">ü•ö</div>
                        <div style="font-weight: 700; margin-bottom: 5px;">–û–±—ã—á–Ω–æ–µ —è–π—Ü–æ</div>
                        <div style="opacity: 0.8; margin-bottom: 10px;">–®–∞–Ω—Å –æ–±—ã—á–Ω–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞</div>
                        <div style="color: var(--success); font-weight: 700;">$100</div>
                    </div>
                    
                    <div class="upgrade" onclick="buyEgg('rare')">
                        <div style="font-size: 40px; margin-bottom: 10px;">üîµ</div>
                        <div style="font-weight: 700; margin-bottom: 5px;">–†–µ–¥–∫–æ–µ —è–π—Ü–æ</div>
                        <div style="opacity: 0.8; margin-bottom: 10px;">–®–∞–Ω—Å —Ä–µ–¥–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞</div>
                        <div style="color: var(--success); font-weight: 700;">$500</div>
                    </div>
                    
                    <div class="upgrade" onclick="buyEgg('epic')">
                        <div style="font-size: 40px; margin-bottom: 10px;">üü£</div>
                        <div style="font-weight: 700; margin-bottom: 5px;">–≠–ø–∏—á–µ—Å–∫–æ–µ —è–π—Ü–æ</div>
                        <div style="opacity: 0.8; margin-bottom: 10px;">–®–∞–Ω—Å —ç–ø–∏—á–µ—Å–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞</div>
                        <div style="color: var(--success); font-weight: 700;">$2000</div>
                    </div>
                    
                    <div class="upgrade" onclick="buyBuff()">
                        <div style="font-size: 40px; margin-bottom: 10px;">‚ö°</div>
                        <div style="font-weight: 700; margin-bottom: 5px;">–ë—É—Ñ—Ñ √ó2</div>
                        <div style="opacity: 0.8; margin-bottom: 10px;">√ó2 –∫ –∫–ª–∏–∫–∞–º –Ω–∞ 30 —Å–µ–∫</div>
                        <div style="color: var(--success); font-weight: 700;">$500</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3 style="margin-bottom: 15px;">–í–∞—à–∏ –ø–∏—Ç–æ–º—Ü—ã</h3>
                    <div id="pets-list" style="display: flex; flex-wrap: wrap; gap: 10px;">
                        <!-- –ü–∏—Ç–æ–º—Ü—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="font-size: 24px;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <button class="close-btn" onclick="closeModal('settings-modal')">√ó</button>
            </div>
            
            <div class="settings-grid">
                <div class="setting">
                    <h3 style="margin-bottom: 15px;">üé® –¢–µ–º–∞</h3>
                    <div class="theme-selector">
                        <button class="theme-btn theme-dark active" onclick="setTheme('dark')">–¢—ë–º–Ω–∞—è</button>
                        <button class="theme-btn theme-light" onclick="setTheme('light')">–°–≤–µ—Ç–ª–∞—è</button>
                        <button class="theme-btn theme-purple" onclick="setTheme('purple')">–§–∏–æ–ª–µ—Ç–æ–≤–∞—è</button>
                    </div>
                </div>
                
                <div class="setting">
                    <h3 style="margin-bottom: 15px;">‚ùÑÔ∏è –°–Ω–µ–∂–∏–Ω–∫–∏</h3>
                    <div class="toggle">
                        <span>–í–∫–ª—é—á–∏—Ç—å —Å–Ω–µ–≥</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="snow-toggle" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div style="opacity: 0.7; font-size: 14px; margin-top: 10px;">
                        –°–Ω–µ–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Ç—ë–º–Ω–æ–π –∏ —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–π —Ç–µ–º–µ
                    </div>
                </div>
                
                <div class="setting">
                    <h3 style="margin-bottom: 15px;">üíæ –î–∞–Ω–Ω—ã–µ</h3>
                    <button class="play-btn" onclick="exportData()" style="margin-bottom: 10px; width: 100%;">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                    <button class="play-btn" onclick="importData()" style="margin-bottom: 10px; width: 100%; background: var(--secondary);">–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                    <button class="play-btn" onclick="clearData()" style="width: 100%; background: var(--danger);">–û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                </div>
            </div>
        </div>
    </div>

<script>
// ====================
// –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
// ====================
const USERS = ["–ù–∏–∫–∏—Ç–∞", "–ê–ª–µ–Ω–∞", "–°–∞—à–∞", "–ê–ª–∏—Å–∞", "–ì–æ—Å—Ç—å"];
let currentUser = null;
let appData = JSON.parse(localStorage.getItem('platform_data')) || {
    users: {},
    online: {},
    settings: { theme: 'dark', snow: true },
    chat: [],
    cloud: []
};

// Three.js –¥–ª—è CS
let csScene, csCamera, csRenderer, csPlayer, csBots = [], csBullets = [], csWalls = [];
let csHealth = 100, csMoney = 800, csKills = 0, csAmmo = 30;
let currentWeapon = 'akm';

// –ö–ª–∏–∫–µ—Ä
let clickerMoney = 0;
let clickerClickPower = 1;
let clickerAutoClicker = 0;
let clickerMultiplier = 1;
let rebirths = 0;
let pets = [];
let activeBuff = false;

// –ß–∞—Ç
let currentChat = 'general';
let chatMessages = {
    general: [],
    '–ù–∏–∫–∏—Ç–∞': [],
    '–ê–ª–µ–Ω–∞': [],
    '–°–∞—à–∞': [],
    '–ê–ª–∏—Å–∞': [],
    '–ì–æ—Å—Ç—å': []
};

// ====================
// –ù–ê–í–ò–ì–ê–¶–ò–Ø
// ====================
function setupNavigation() {
    const tabs = document.querySelectorAll('.tab');
    const pages = document.querySelectorAll('.page');
    
    tabs.forEach(tab => {
        tab.addEventListener('click', function() {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
            tabs.forEach(t => t.classList.remove('active'));
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–µ
            this.classList.add('active');
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            pages.forEach(page => page.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            const pageId = this.getAttribute('data-page');
            document.getElementById(pageId).classList.add('active');
        });
    });
}

// ====================
// –í–´–ë–û–† –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
// ====================
function initUserSelection() {
    const userList = document.getElementById('user-list');
    userList.innerHTML = '';
    
    USERS.forEach(username => {
        const isOccupied = appData.online && appData.online[username];
        const btn = document.createElement('button');
        btn.className = `user-btn ${isOccupied ? 'occupied' : ''}`;
        btn.textContent = username;
        btn.onclick = () => selectUser(username, isOccupied);
        userList.appendChild(btn);
    });
}

function selectUser(username, isOccupied) {
    if (isOccupied) {
        alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "${username}" —É–∂–µ –≤ –∏–≥—Ä–µ!`);
        return;
    }
    
    document.querySelectorAll('.user-btn').forEach(btn => btn.classList.remove('selected'));
    event.target.classList.add('selected');
    currentUser = username;
}

function login() {
    if (!currentUser) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!');
        return;
    }
    
    if (appData.online && appData.online[currentUser]) {
        alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "${currentUser}" —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤–æ—à–µ–ª –≤ –∏–≥—Ä—É!`);
        initUserSelection();
        return;
    }
    
    // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ –Ω–µ—Ç
    if (!appData.users[currentUser]) {
        appData.users[currentUser] = {
            balance: 1000,
            createdAt: Date.now(),
            games: {
                cs: { kills: 0, deaths: 0 },
                tic: { wins: 0, losses: 0 },
                clicker: { money: 0, rebirths: 0 }
            }
        };
    }
    
    // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –æ–Ω–ª–∞–π–Ω
    appData.online[currentUser] = Date.now();
    saveData();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    initApp();
}

function initApp() {
    document.querySelector('.login-screen').style.display = 'none';
    document.querySelector('.main-app').style.display = 'block';
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
    setupNavigation();
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É
    setTheme(appData.settings.theme);
    
    // –°–Ω–µ–∂–∏–Ω–∫–∏
    if (appData.settings.snow) {
        createSnowflakes();
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    updateUserInfo();
    loadCloudFiles();
    initWorldClocks();
    loadChat();
    loadMap();
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    setupEventListeners();
}

function updateUserInfo() {
    const userData = appData.users[currentUser];
    const firstLetter = currentUser.charAt(0).toUpperCase();
    
    document.getElementById('current-avatar').textContent = firstLetter;
    document.getElementById('current-username').textContent = currentUser;
    document.getElementById('balance').textContent = `$${userData.balance || 1000}`;
}

function exitApp() {
    if (confirm('–í—ã–π—Ç–∏ —Å —Å–∞–π—Ç–∞?')) {
        window.close();
    }
}

// ====================
// –°–ù–ï–ñ–ò–ù–ö–ò
// ====================
function createSnowflakes() {
    if (appData.settings.theme === 'light') return;
    
    for (let i = 0; i < 50; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        
        const size = Math.random() * 10 + 5;
        snowflake.style.width = `${size}px`;
        snowflake.style.height = `${size}px`;
        snowflake.style.left = `${Math.random() * 100}vw`;
        snowflake.style.opacity = Math.random() * 0.5 + 0.3;
        snowflake.style.animationDuration = `${Math.random() * 10 + 10}s`;
        snowflake.style.animationDelay = `${Math.random() * 5}s`;
        
        document.body.appendChild(snowflake);
        
        // –£–¥–∞–ª—è–µ–º —Å–Ω–µ–∂–∏–Ω–∫—É –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
        setTimeout(() => {
            if (snowflake.parentNode) {
                snowflake.parentNode.removeChild(snowflake);
            }
        }, 15000);
    }
    
    // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ —Å–Ω–µ–∂–∏–Ω–∫–∏
    setTimeout(createSnowflakes, 15000);
}

// ====================
// –û–ë–õ–ê–ö–û
// ====================
function loadCloudFiles() {
    const grid = document.getElementById('files-grid');
    const files = appData.cloud || [];
    
    if (files.length === 0) {
        grid.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px; opacity: 0.7;">–§–∞–π–ª–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π —Ñ–∞–π–ª!</div>';
        return;
    }
    
    grid.innerHTML = files.map((file, index) => `
        <div class="file">
            <button class="delete-file" onclick="deleteFile(${index})">√ó</button>
            <div class="file-icon">${getFileIcon(file.type)}</div>
            <div class="file-name">${file.name}</div>
            <div class="file-size">${file.size}</div>
        </div>
    `).join('');
}

function getFileIcon(type) {
    const icons = {
        'photo': 'üì∑',
        'video': 'üé¨',
        'audio': 'üéµ',
        'file': 'üìÑ'
    };
    return icons[type] || 'üìÑ';
}

function addFile() {
    const name = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞:');
    if (!name) return;
    
    const type = prompt('–í–≤–µ–¥–∏—Ç–µ —Ç–∏–ø (photo, video, audio, file):') || 'file';
    const size = Math.floor(Math.random() * 1000) + ' KB';
    
    appData.cloud.push({ name, type, size, date: new Date().toLocaleString() });
    saveData();
    loadCloudFiles();
}

function deleteFile(index) {
    if (confirm('–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª?')) {
        appData.cloud.splice(index, 1);
        saveData();
        loadCloudFiles();
    }
}

// ====================
// –ò–ì–†–´
// ====================
// Counter-Strike 3D
function startCS() {
    document.getElementById('cs-game').style.display = 'block';
    initCS();
}

function initCS() {
    const canvas = document.getElementById('cs-canvas');
    
    // –°—Ü–µ–Ω–∞
    csScene = new THREE.Scene();
    csScene.background = new THREE.Color(0x111122);
    
    // –ö–∞–º–µ—Ä–∞
    csCamera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
    csCamera.position.set(0, 10, 20);
    
    // –†–µ–Ω–¥–µ—Ä–µ—Ä
    csRenderer = new THREE.WebGLRenderer({ canvas, antialias: true });
    csRenderer.setSize(canvas.clientWidth, canvas.clientHeight);
    csRenderer.shadowMap.enabled = true;
    
    // –û—Å–≤–µ—â–µ–Ω–∏–µ
    const light = new THREE.AmbientLight(0x404040, 0.6);
    csScene.add(light);
    
    const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
    dirLight.position.set(10, 20, 10);
    csScene.add(dirLight);
    
    // –ü–æ–ª
    const floorGeometry = new THREE.PlaneGeometry(100, 100);
    const floorMaterial = new THREE.MeshPhongMaterial({ color: 0x2a2a2a });
    const floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.rotation.x = -Math.PI / 2;
    csScene.add(floor);
    
    // –ò–≥—Ä–æ–∫
    createCSPlayer();
    
    // –ë–æ—Ç—ã
    createCSBots();
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    setupCSControls();
}

function createCSPlayer() {
    const geometry = new THREE.BoxGeometry(1, 2, 1);
    const material = new THREE.MeshPhongMaterial({ color: 0x00ff00 });
    csPlayer = new THREE.Mesh(geometry, material);
    csPlayer.position.y = 1;
    csScene.add(csPlayer);
}

function createCSBots() {
    for (let i = 0; i < 3; i++) {
        const geometry = new THREE.BoxGeometry(1, 2, 1);
        const material = new THREE.MeshPhongMaterial({ color: 0xff0000 });
        const bot = new THREE.Mesh(geometry, material);
        
        bot.position.set(
            (Math.random() - 0.5) * 80,
            1,
            (Math.random() - 0.5) * 80
        );
        
        csBots.push(bot);
        csScene.add(bot);
    }
}

function setupCSControls() {
    const keys = {};
    
    window.addEventListener('keydown', (e) => {
        keys[e.key.toLowerCase()] = true;
        
        if (e.key === ' ') shoot();
        if (e.key === 'r') reload();
    });
    
    window.addEventListener('keyup', (e) => {
        keys[e.key.toLowerCase()] = false;
    });
    
    function updateMovement() {
        const speed = 0.2;
        
        if (keys['w']) csPlayer.position.z -= speed;
        if (keys['s']) csPlayer.position.z += speed;
        if (keys['a']) csPlayer.position.x -= speed;
        if (keys['d']) csPlayer.position.x += speed;
        
        // –ö–∞–º–µ—Ä–∞
        csCamera.position.x = csPlayer.position.x;
        csCamera.position.y = csPlayer.position.y + 5;
        csCamera.position.z = csPlayer.position.z + 8;
        csCamera.lookAt(csPlayer.position.x, csPlayer.position.y, csPlayer.position.z);
    }
    
    function animateCS() {
        requestAnimationFrame(animateCS);
        
        updateMovement();
        
        // –î–≤–∏–∂–µ–Ω–∏–µ –±–æ—Ç–æ–≤
        csBots.forEach(bot => {
            const dx = csPlayer.position.x - bot.position.x;
            const dz = csPlayer.position.z - bot.position.z;
            const distance = Math.sqrt(dx * dx + dz * dz);
            
            if (distance > 10) {
                bot.position.x += (dx / distance) * 0.03;
                bot.position.z += (dz / distance) * 0.03;
            }
        });
        
        csRenderer.render(csScene, csCamera);
    }
    
    animateCS();
}

function shoot() {
    if (csAmmo <= 0) return;
    
    csAmmo--;
    updateCSHUD();
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ –±–æ—Ç–æ–≤
    csBots.forEach((bot, index) => {
        const distance = csPlayer.position.distanceTo(bot.position);
        if (distance < 5) {
            csKills++;
            csMoney += 300;
            updateCSHUD();
            
            // –£–¥–∞–ª—è–µ–º –±–æ—Ç–∞
            csScene.remove(bot);
            csBots.splice(index, 1);
            
            // –ù–æ–≤—ã–π –±–æ—Ç
            setTimeout(createCSBots, 2000);
        }
    });
}

function selectWeapon(weapon) {
    currentWeapon = weapon;
    document.querySelectorAll('.weapon-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    switch(weapon) {
        case 'akm': csAmmo = 30; break;
        case 'awp': csAmmo = 10; break;
        case 'glock': csAmmo = 20; break;
        case 'deagle': csAmmo = 7; break;
    }
    
    updateCSHUD();
}

function reload() {
    csAmmo = currentWeapon === 'akm' ? 30 : 
              currentWeapon === 'awp' ? 10 :
              currentWeapon === 'glock' ? 20 : 7;
    updateCSHUD();
}

function updateCSHUD() {
    document.getElementById('cs-health').textContent = `‚ù§Ô∏è ${csHealth}`;
    document.getElementById('cs-money').textContent = `üí∞ $${csMoney}`;
    document.getElementById('cs-kills').textContent = `üéØ ${csKills} —É–±–∏–π—Å—Ç–≤`;
    document.getElementById('cs-ammo').textContent = `üî´ ${csAmmo}`;
}

function exitCS() {
    document.getElementById('cs-game').style.display = 'none';
    csScene = null;
    csBots = [];
}

// My Talking Tom 2
let tomHappiness = 100;
let tomHunger = 100;
let tomMoney = 100;

function startTalkingTom() {
    showModal('talking-tom-modal');
    updateTomStats();
}

function petTom() {
    tomHappiness = Math.min(100, tomHappiness + 10);
    tomMoney += 5;
    updateTomStats();
    saveData();
}

function feedTom() {
    if (tomMoney >= 10) {
        tomHunger = Math.min(100, tomHunger + 30);
        tomMoney -= 10;
        updateTomStats();
        saveData();
    } else {
        alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
    }
}

function playWithTom() {
    tomHappiness = Math.min(100, tomHappiness + 20);
    tomHunger = Math.max(0, tomHunger - 10);
    updateTomStats();
    saveData();
}

function updateTomStats() {
    document.getElementById('tom-happiness').textContent = `${tomHappiness}%`;
    document.getElementById('tom-hunger').textContent = `${tomHunger}%`;
    document.getElementById('tom-money').textContent = `$${tomMoney}`;
}

// –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏
let ticBoard = ['', '', '', '', '', '', '', '', ''];
let ticCurrentPlayer = 'X';
let ticGameActive = true;
let ticMode = 'bot';

function startTicTacToe() {
    showModal('tic-tac-toe-modal');
    initTicTacToe();
}

function initTicTacToe() {
    const board = document.getElementById('tic-board');
    board.innerHTML = '';
    
    for (let i = 0; i < 9; i++) {
        const cell = document.createElement('div');
        cell.className = 'tic-cell';
        cell.dataset.index = i;
        cell.onclick = () => makeMove(i);
        board.appendChild(cell);
    }
    
    ticMode = document.getElementById('tic-mode').value;
    document.getElementById('tic-status').textContent = `–•–æ–¥: ${ticCurrentPlayer}`;
}

function makeMove(index) {
    if (!ticGameActive || ticBoard[index] !== '') return;
    
    ticBoard[index] = ticCurrentPlayer;
    document.querySelector(`.tic-cell[data-index="${index}"]`).textContent = ticCurrentPlayer;
    
    if (checkWin()) {
        document.getElementById('tic-status').textContent = `–ü–æ–±–µ–¥–∏–ª ${ticCurrentPlayer}!`;
        ticGameActive = false;
        return;
    }
    
    if (isBoardFull()) {
        document.getElementById('tic-status').textContent = '–ù–∏—á—å—è!';
        ticGameActive = false;
        return;
    }
    
    ticCurrentPlayer = ticCurrentPlayer === 'X' ? 'O' : 'X';
    document.getElementById('tic-status').textContent = `–•–æ–¥: ${ticCurrentPlayer}`;
    
    if (ticMode === 'bot' && ticCurrentPlayer === 'O') {
        setTimeout(makeBotMove, 500);
    }
}

function makeBotMove() {
    const availableMoves = ticBoard.map((cell, index) => cell === '' ? index : -1).filter(i => i !== -1);
    if (availableMoves.length > 0) {
        const randomMove = availableMoves[Math.floor(Math.random() * availableMoves.length)];
        makeMove(randomMove);
    }
}

function checkWin() {
    const patterns = [
        [0,1,2], [3,4,5], [6,7,8],
        [0,3,6], [1,4,7], [2,5,8],
        [0,4,8], [2,4,6]
    ];
    
    return patterns.some(pattern => {
        const [a,b,c] = pattern;
        return ticBoard[a] && ticBoard[a] === ticBoard[b] && ticBoard[a] === ticBoard[c];
    });
}

function isBoardFull() {
    return ticBoard.every(cell => cell !== '');
}

function resetTicTacToe() {
    ticBoard = ['', '', '', '', '', '', '', '', ''];
    ticCurrentPlayer = 'X';
    ticGameActive = true;
    initTicTacToe();
}

// –ö–ª–∏–∫–µ—Ä
function startClicker() {
    showModal('clicker-modal');
    loadClickerData();
}

function loadClickerData() {
    const userData = appData.users[currentUser];
    clickerMoney = userData.games.clicker.money || 0;
    clickerClickPower = userData.games.clicker.clickPower || 1;
    clickerAutoClicker = userData.games.clicker.autoClicker || 0;
    clickerMultiplier = userData.games.clicker.multiplier || 1;
    rebirths = userData.games.clicker.rebirths || 0;
    pets = userData.games.clicker.pets || [];
    
    updateClickerUI();
    
    // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
    if (clickerAutoClicker > 0 && !window.autoClickerInterval) {
        startAutoClicker();
    }
}

function clickMoney() {
    let gain = clickerClickPower * clickerMultiplier;
    if (activeBuff) gain *= 2;
    
    clickerMoney += gain;
    updateClickerUI();
    saveClickerData();
}

function buyUpgrade(type) {
    let cost = 0;
    
    switch(type) {
        case 'click':
            cost = 10 * Math.pow(2, clickerClickPower - 1);
            if (clickerMoney >= cost) {
                clickerMoney -= cost;
                clickerClickPower++;
            }
            break;
        case 'auto':
            cost = 100 * Math.pow(2, clickerAutoClicker);
            if (clickerMoney >= cost) {
                clickerMoney -= cost;
                clickerAutoClicker++;
                if (!window.autoClickerInterval) {
                    startAutoClicker();
                }
            }
            break;
        case 'multiplier':
            cost = 1000 * Math.pow(2, clickerMultiplier - 1);
            if (clickerMoney >= cost) {
                clickerMoney -= cost;
                clickerMultiplier += 0.2;
            }
            break;
    }
    
    if (clickerMoney >= cost) {
        updateClickerUI();
        saveClickerData();
    } else {
        alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
    }
}

function buyRebirth() {
    const cost = 10000 * Math.pow(2, rebirths);
    
    if (clickerMoney >= cost) {
        if (confirm(`–ü–µ—Ä–µ—Ä–æ–¥–∏—Ç—å—Å—è –∑–∞ $${cost}?\n+0.5x –∫ –º–Ω–æ–∂–∏—Ç–µ–ª—é –Ω–∞–≤—Å–µ–≥–¥–∞!`)) {
            clickerMoney = 0;
            rebirths++;
            clickerMultiplier += 0.5;
            clickerClickPower = 1;
            clickerAutoClicker = 0;
            activeBuff = false;
            
            updateClickerUI();
            saveClickerData();
            alert(`–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ #${rebirths} –∑–∞–≤–µ—Ä—à–µ–Ω–æ!`);
        }
    } else {
        alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
    }
}

function startAutoClicker() {
    if (window.autoClickerInterval) {
        clearInterval(window.autoClickerInterval);
    }
    
    window.autoClickerInterval = setInterval(() => {
        let gain = clickerAutoClicker * 0.5 * clickerMultiplier;
        if (activeBuff) gain *= 2;
        
        clickerMoney += gain;
        updateClickerUI();
        saveClickerData();
    }, 1000);
}

function openShop() {
    closeModal('clicker-modal');
    showModal('shop-modal');
    updateShop();
}

function buyEgg(type) {
    const prices = {
        'common': 100,
        'rare': 500,
        'epic': 2000
    };
    
    const price = prices[type];
    if (clickerMoney >= price) {
        clickerMoney -= price;
        
        // –°–ª—É—á–∞–π–Ω—ã–π –ø–∏—Ç–æ–º–µ—Ü
        const petTypes = {
            'common': ['üê± –ö–æ—Ç', 'üê∂ –°–æ–±–∞–∫–∞', 'üê∞ –ö—Ä–æ–ª–∏–∫', 'üê¶ –ü—Ç–∏—Ü–∞'],
            'rare': ['üê≤ –î—Ä–∞–∫–æ–Ω', 'ü¶Ñ –ï–¥–∏–Ω–æ—Ä–æ–≥', 'üê∫ –í–æ–ª–∫', 'ü¶Ö –û—Ä—ë–ª'],
            'epic': ['üëª –ü—Ä–∏–∑—Ä–∞–∫', 'üßö –§–µ—è', 'üßå –û–≥—Ä', 'üßú –†—É—Å–∞–ª–∫–∞']
        };
        
        const pet = petTypes[type][Math.floor(Math.random() * petTypes[type].length)];
        pets.push({ name: pet, type: type });
        
        updateClickerUI();
        updateShop();
        saveClickerData();
        
        alert(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ –ø–∏—Ç–æ–º—Ü–∞: ${pet}`);
    } else {
        alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
    }
}

function buyBuff() {
    if (clickerMoney >= 500) {
        clickerMoney -= 500;
        activeBuff = true;
        
        updateClickerUI();
        saveClickerData();
        
        setTimeout(() => {
            activeBuff = false;
            updateClickerUI();
        }, 30000);
        
        alert('–ë—É—Ñ—Ñ √ó2 –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –Ω–∞ 30 —Å–µ–∫—É–Ω–¥!');
    } else {
        alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!');
    }
}

function updateClickerUI() {
    document.getElementById('clicker-money').textContent = `$${Math.floor(clickerMoney)}`;
    document.getElementById('click-price').textContent = `–¶–µ–Ω–∞: $${10 * Math.pow(2, clickerClickPower - 1)}`;
    document.getElementById('auto-price').textContent = `–¶–µ–Ω–∞: $${100 * Math.pow(2, clickerAutoClicker)}`;
    document.getElementById('multiplier-price').textContent = `–¶–µ–Ω–∞: $${1000 * Math.pow(2, clickerMultiplier - 1)}`;
    document.getElementById('rebirth-price').textContent = `–¶–µ–Ω–∞: $${10000 * Math.pow(2, rebirths)}`;
    document.getElementById('rebirth-count').textContent = `–ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–π: ${rebirths}`;
    document.getElementById('multiplier').textContent = `–ú–Ω–æ–∂–∏—Ç–µ–ª—å: ${clickerMultiplier.toFixed(1)}x ${activeBuff ? '(√ó2 –ë–£–§–§)' : ''}`;
}

function updateShop() {
    const petsList = document.getElementById('pets-list');
    petsList.innerHTML = pets.length === 0 ? 
        '<div style="opacity: 0.7;">–ü–∏—Ç–æ–º—Ü–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</div>' :
        pets.map(pet => `
            <div style="background: var(--card); padding: 10px; border-radius: 10px; border: 2px solid var(--primary);">
                <div style="font-size: 24px;">${pet.name.split(' ')[0]}</div>
                <div style="font-size: 12px; opacity: 0.8;">${pet.type}</div>
            </div>
        `).join('');
}

function saveClickerData() {
    appData.users[currentUser].games.clicker = {
        money: clickerMoney,
        clickPower: clickerClickPower,
        autoClicker: clickerAutoClicker,
        multiplier: clickerMultiplier,
        rebirths: rebirths,
        pets: pets
    };
    saveData();
}

// ====================
// –ü–ï–†–ï–í–û–î–ß–ò–ö
// ====================
const translations = {
    'ru-en': {
        '–ø—Ä–∏–≤–µ—Ç': 'hello',
        '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ': 'hello',
        '–∫–∞–∫ –¥–µ–ª–∞': 'how are you',
        '—Å–ø–∞—Å–∏–±–æ': 'thank you',
        '–ø–æ–∂–∞–ª—É–π—Å—Ç–∞': 'you are welcome',
        '–¥–∞': 'yes',
        '–Ω–µ—Ç': 'no',
        '—Ö–æ—Ä–æ—à–æ': 'good',
        '–ø–ª–æ—Ö–æ': 'bad',
        '—è': 'i',
        '—Ç—ã': 'you',
        '–º—ã': 'we'
    },
    'en-ru': {
        'hello': '–ø—Ä–∏–≤–µ—Ç',
        'hi': '–ø—Ä–∏–≤–µ—Ç',
        'how are you': '–∫–∞–∫ –¥–µ–ª–∞',
        'thank you': '—Å–ø–∞—Å–∏–±–æ',
        'yes': '–¥–∞',
        'no': '–Ω–µ—Ç',
        'good': '—Ö–æ—Ä–æ—à–æ',
        'bad': '–ø–ª–æ—Ö–æ',
        'i': '—è',
        'you': '—Ç—ã',
        'we': '–º—ã'
    },
    'ru-zh': {
        '–ø—Ä–∏–≤–µ—Ç': '‰Ω†Â•Ω',
        '—Å–ø–∞—Å–∏–±–æ': 'Ë∞¢Ë∞¢',
        '–¥–∞': 'ÊòØ',
        '–Ω–µ—Ç': '‰∏ç'
    },
    'zh-ru': {
        '‰Ω†Â•Ω': '–ø—Ä–∏–≤–µ—Ç',
        'Ë∞¢Ë∞¢': '—Å–ø–∞—Å–∏–±–æ',
        'ÊòØ': '–¥–∞',
        '‰∏ç': '–Ω–µ—Ç'
    },
    'ru-ar': {
        '–ø—Ä–∏–≤–µ—Ç': 'ŸÖÿ±ÿ≠ÿ®ÿß',
        '—Å–ø–∞—Å–∏–±–æ': 'ÿ¥ŸÉÿ±ÿß',
        '–¥–∞': 'ŸÜÿπŸÖ',
        '–Ω–µ—Ç': 'ŸÑÿß'
    },
    'ar-ru': {
        'ŸÖÿ±ÿ≠ÿ®ÿß': '–ø—Ä–∏–≤–µ—Ç',
        'ÿ¥ŸÉÿ±ÿß': '—Å–ø–∞—Å–∏–±–æ',
        'ŸÜÿπŸÖ': '–¥–∞',
        'ŸÑÿß': '–Ω–µ—Ç'
    }
};

function swapLanguages() {
    const from = document.getElementById('lang-from');
    const to = document.getElementById('lang-to');
    const temp = from.value;
    from.value = to.value;
    to.value = temp;
    translate();
}

function translate() {
    const text = document.getElementById('input-text').value.toLowerCase();
    const from = document.getElementById('lang-from').value;
    const to = document.getElementById('lang-to').value;
    
    if (!text.trim()) {
        document.getElementById('output-text').value = '';
        return;
    }
    
    const key = `${from}-${to}`;
    const dict = translations[key];
    
    if (dict) {
        let result = text;
        for (const [key, value] of Object.entries(dict)) {
            if (text.includes(key)) {
                result = result.replace(new RegExp(key, 'gi'), value);
            }
        }
        document.getElementById('output-text').value = result.charAt(0).toUpperCase() + result.slice(1);
    } else {
        // –ü—Å–µ–≤–¥–æ–ø–µ—Ä–µ–≤–æ–¥
        const translated = text.split(' ').map(word => {
            if (Math.random() > 0.5) return word + '...';
            return word;
        }).join(' ');
        document.getElementById('output-text').value = `[–ü–ï–†–ï–í–û–î]: ${translated}`;
    }
}

function speakTranslation() {
    const text = document.getElementById('output-text').value;
    if (!text.trim()) return;
    
    if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = document.getElementById('lang-to').value;
        speechSynthesis.speak(utterance);
    }
}

function startVoiceInput() {
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.lang = document.getElementById('lang-from').value;
        
        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            document.getElementById('input-text').value = transcript;
            translate();
        };
        
        recognition.start();
    }
}

// ====================
// –ß–ê–°–´ –ú–ò–†–ê
// ====================
const timezones = {
    '–ú–æ—Å–∫–≤–∞': 'Europe/Moscow',
    '–î—É–±–∞–π': 'Asia/Dubai',
    '–ö–∏–µ–≤': 'Europe/Kiev',
    '–ü–∞—Ä–∏–∂': 'Europe/Paris',
    '–ë–µ—Ä–ª–∏–Ω': 'Europe/Berlin',
    '–¢–æ–∫–∏–æ': 'Asia/Tokyo',
    '–ü–µ–∫–∏–Ω': 'Asia/Shanghai',
    '–°–µ—É–ª': 'Asia/Seoul',
    '–¢–∞—à–∫–µ–Ω—Ç': 'Asia/Tashkent'
};

function initWorldClocks() {
    const grid = document.getElementById('clocks-grid');
    grid.innerHTML = '';
    
    Object.keys(timezones).forEach(city => {
        const clock = document.createElement('div');
        clock.className = 'clock';
        clock.innerHTML = `
            <div class="clock-city">${city}</div>
            <div class="clock-time" id="clock-${city}">00:00:00</div>
            <div class="clock-date" id="date-${city}">1 —è–Ω–≤–∞—Ä—è 2024</div>
        `;
        grid.appendChild(clock);
    });
    
    updateClocks();
    setInterval(updateClocks, 1000);
}

function updateClocks() {
    const now = new Date();
    
    Object.keys(timezones).forEach(city => {
        try {
            const timeString = now.toLocaleTimeString('ru-RU', { timeZone: timezones[city] });
            const dateString = now.toLocaleDateString('ru-RU', { 
                timeZone: timezones[city],
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            document.getElementById(`clock-${city}`).textContent = timeString;
            document.getElementById(`date-${city}`).textContent = dateString;
        } catch (e) {
            document.getElementById(`clock-${city}`).textContent = now.toLocaleTimeString();
            document.getElementById(`date-${city}`).textContent = now.toLocaleDateString();
        }
    });
}

// ====================
// –ß–ê–¢
// ====================
function loadChat() {
    const usersList = document.getElementById('chat-users');
    usersList.innerHTML = `
        <div class="chat-user active" onclick="switchChat('general')">
            <div style="font-weight: 700;">üí¨ –û–±—â–∏–π —á–∞—Ç</div>
            <div style="font-size: 12px; opacity: 0.7;">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
        </div>
    `;
    
    USERS.forEach(user => {
        if (user !== currentUser) {
            const userDiv = document.createElement('div');
            userDiv.className = 'chat-user';
            userDiv.onclick = () => switchChat(user);
            userDiv.innerHTML = `
                <div style="font-weight: 700;">üë§ ${user}</div>
                <div style="font-size: 12px; opacity: 0.7;">${appData.online[user] ? 'üü¢ –û–Ω–ª–∞–π–Ω' : '‚ö´ –û—Ñ–ª–∞–π–Ω'}</div>
            `;
            usersList.appendChild(userDiv);
        }
    });
    
    switchChat('general');
}

function switchChat(user) {
    currentChat = user;
    
    document.querySelectorAll('.chat-user').forEach(el => el.classList.remove('active'));
    event.target.closest('.chat-user').classList.add('active');
    
    document.getElementById('chat-title').textContent = user === 'general' ? 'üí¨ –û–±—â–∏–π —á–∞—Ç' : `üë§ –õ–∏—á–Ω—ã–π —á–∞—Ç —Å ${user}`;
    
    showMessages();
}

function showMessages() {
    const list = document.getElementById('messages-list');
    const messages = chatMessages[currentChat] || [];
    
    list.innerHTML = messages.map(msg => `
        <div class="message ${msg.sender === currentUser ? 'sent' : 'received'}">
            <div style="font-weight: 700; margin-bottom: 5px;">${msg.sender}</div>
            <div>${msg.text}</div>
            <div style="font-size: 12px; opacity: 0.7; margin-top: 5px;">${msg.time}</div>
        </div>
    `).join('');
    
    list.scrollTop = list.scrollHeight;
}

function sendMessage() {
    const input = document.getElementById('chat-message');
    const text = input.value.trim();
    
    if (!text) return;
    
    const message = {
        sender: currentUser,
        text: text,
        time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
    };
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    chatMessages[currentChat].push(message);
    
    // –ï—Å–ª–∏ –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏ —É –ø–æ–ª—É—á–∞—Ç–µ–ª—è
    if (currentChat !== 'general' && appData.online[currentChat]) {
        chatMessages[currentUser].push({
            sender: currentUser,
            text: text,
            time: message.time
        });
    }
    
    // –û–±—â–∏–π —á–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –≤—Å–µ—Ö
    if (currentChat === 'general') {
        appData.chat.push(message);
        saveData();
    }
    
    input.value = '';
    showMessages();
}

// ====================
// –ö–ê–†–¢–´
// ====================
function loadMap() {
    const container = document.getElementById('map-container');
    container.innerHTML = `
        <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; flex-direction: column;">
            <div style="font-size: 48px; margin-bottom: 20px;">üó∫Ô∏è</div>
            <h3 style="font-size: 24px; margin-bottom: 10px;">–ö–∞—Ä—Ç—ã</h3>
            <p style="opacity: 0.8; margin-bottom: 30px; text-align: center;">
                –î–ª—è —Ä–∞–±–æ—Ç—ã –∫–∞—Ä—Ç —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.<br>
                –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Google Maps.
            </p>
            <div class="map-controls">
                <button class="voice-btn" onclick="showLocation('–ú–æ—Å–∫–≤–∞')">üìç –ú–æ—Å–∫–≤–∞</button>
                <button class="voice-btn" onclick="showLocation('–î—É–±–∞–π')">üìç –î—É–±–∞–π</button>
                <button class="voice-btn" onclick="showLocation('–ü–∞—Ä–∏–∂')">üìç –ü–∞—Ä–∏–∂</button>
            </div>
        </div>
    `;
}

function showLocation(city) {
    alert(`üìç ${city}\n\n–®–∏—Ä–æ—Ç–∞: 55.7558\n–î–æ–ª–≥–æ—Ç–∞: 37.6173\n\n–î–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Google Maps —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏.`);
}

// ====================
// –ù–ê–°–¢–†–û–ô–ö–ò
// ====================
function openSettings() {
    showModal('settings-modal');
}

function setTheme(theme) {
    document.body.setAttribute('data-theme', theme);
    appData.settings.theme = theme;
    saveData();
    
    document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // –í–∫–ª—é—á–∞–µ–º/–≤—ã–∫–ª—é—á–∞–µ–º —Å–Ω–µ–∂–∏–Ω–∫–∏
    const snowToggle = document.getElementById('snow-toggle');
    if (theme === 'light') {
        snowToggle.checked = false;
        snowToggle.disabled = true;
    } else {
        snowToggle.disabled = false;
        if (snowToggle.checked) {
            createSnowflakes();
        }
    }
}

function exportData() {
    const data = JSON.stringify(appData);
    const blob = new Blob([data], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    
    const a = document.createElement('a');
    a.href = url;
    a.download = 'platform_backup.json';
    a.click();
    
    alert('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
}

function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'application/json';
    
    input.onchange = (e) => {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = (e) => {
            try {
                const data = JSON.parse(e.target.result);
                Object.assign(appData, data);
                saveData();
                alert('–î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
                location.reload();
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ: ' + error.message);
            }
        };
        
        reader.readAsText(file);
    };
    
    input.click();
}

function clearData() {
    if (confirm('–£–î–ê–õ–ò–¢–¨ –í–°–ï –î–ê–ù–ù–´–ï?')) {
        localStorage.clear();
        alert('–î–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã!');
        location.reload();
    }
}

// ====================
// –£–¢–ò–õ–ò–¢–´
// ====================
function showModal(id) {
    document.getElementById(id).style.display = 'flex';
}

function closeModal(id) {
    document.getElementById(id).style.display = 'none';
}

function saveData() {
    localStorage.setItem('platform_data', JSON.stringify(appData));
}

function setupEventListeners() {
    // –°–Ω–µ–∂–∏–Ω–∫–∏
    document.getElementById('snow-toggle').addEventListener('change', (e) => {
        appData.settings.snow = e.target.checked;
        saveData();
        
        if (e.target.checked) {
            createSnowflakes();
        }
    });
    
    // –ß–∞—Ç
    document.getElementById('chat-message').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
    });
    
    // –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫
    document.getElementById('input-text').addEventListener('input', translate);
}

// ====================
// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
// ====================
window.addEventListener('load', () => {
    initUserSelection();
    
    // –û—á–∏—â–∞–µ–º –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏
    const now = Date.now();
    Object.keys(appData.online || {}).forEach(user => {
        if (now - appData.online[user] > 5 * 60 * 1000) {
            delete appData.online[user];
        }
    });
    saveData();
});
</script>
</body>
</html>
